<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAID Level Visualizer - House of Forge</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #7c2d12 0%, #9a3412 100%);
            min-height: 100vh;
            padding: 20px;
            color: #fdba74;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(124, 45, 18, 0.9);
            border: 2px solid #ea580c;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
        }

        header {
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 30px;
            text-align: center;
            position: relative;
        }

        h1 {
            color: #fff;
            font-size: 2.2em;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
        }

        .back-link {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 5px;
            transition: all 0.3s;
            font-weight: bold;
        }

        .back-link:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-50%) scale(1.05);
        }

        .subtitle {
            color: #fff;
            font-size: 1.1em;
            opacity: 0.95;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .tab {
            flex: 1;
            min-width: 150px;
            padding: 15px;
            background: rgba(234, 88, 12, 0.3);
            border: 2px solid #ea580c;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-weight: bold;
            color: #fdba74;
        }

        .tab:hover {
            background: rgba(234, 88, 12, 0.5);
            transform: translateY(-2px);
        }

        .tab.active {
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            color: #fff;
            box-shadow: 0 4px 15px rgba(234, 88, 12, 0.4);
        }

        .content-section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .raid-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .raid-btn {
            padding: 12px 24px;
            background: rgba(234, 88, 12, 0.3);
            border: 2px solid #ea580c;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            color: #fdba74;
            font-weight: bold;
            font-size: 1em;
        }

        .raid-btn:hover {
            background: rgba(234, 88, 12, 0.5);
        }

        .raid-btn.active {
            background: #ea580c;
            color: #fff;
        }

        .raid-display {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #f97316;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 25px;
        }

        .raid-title {
            font-size: 1.8em;
            color: #f97316;
            margin-bottom: 15px;
            text-align: center;
        }

        .raid-description {
            text-align: center;
            margin-bottom: 20px;
            line-height: 1.6;
            font-size: 1.05em;
        }

        .drives-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .drive {
            width: 140px;
            background: rgba(234, 88, 12, 0.2);
            border: 3px solid #ea580c;
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }

        .drive:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(234, 88, 12, 0.4);
        }

        .drive.failed {
            background: rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
            opacity: 0.6;
        }

        .drive.failed::after {
            content: 'FAILED';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-15deg);
            background: #dc2626;
            color: #fff;
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
            font-size: 1.2em;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .drive-label {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
            color: #f97316;
        }

        .data-blocks {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .data-block {
            padding: 8px;
            border-radius: 4px;
            text-align: center;
            font-size: 0.85em;
            font-weight: bold;
            transition: all 0.3s;
        }

        .block-data {
            background: #3b82f6;
            color: #fff;
        }

        .block-parity {
            background: #f59e0b;
            color: #000;
        }

        .block-mirror {
            background: #10b981;
            color: #fff;
        }

        .raid-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .stat-box {
            background: rgba(234, 88, 12, 0.2);
            border: 2px solid #ea580c;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
        }

        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #f97316;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            overflow: hidden;
        }

        .comparison-table th {
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            color: #fff;
            padding: 15px;
            text-align: left;
            font-weight: bold;
        }

        .comparison-table td {
            padding: 12px 15px;
            border-bottom: 1px solid rgba(234, 88, 12, 0.3);
        }

        .comparison-table tr:hover {
            background: rgba(234, 88, 12, 0.2);
        }

        .calculator {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #f97316;
            border-radius: 10px;
            padding: 25px;
        }

        .calc-inputs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-group label {
            font-weight: bold;
            color: #f97316;
        }

        .input-group input,
        .input-group select {
            padding: 12px;
            background: rgba(234, 88, 12, 0.2);
            border: 2px solid #ea580c;
            border-radius: 6px;
            color: #fdba74;
            font-size: 1em;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #f97316;
            box-shadow: 0 0 10px rgba(249, 115, 22, 0.3);
        }

        .calc-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            border: none;
            border-radius: 8px;
            color: #fff;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
        }

        .calc-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(234, 88, 12, 0.4);
        }

        .calc-results {
            display: none;
            margin-top: 25px;
            animation: fadeIn 0.5s;
        }

        .calc-results.show {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: rgba(234, 88, 12, 0.2);
            border: 2px solid #ea580c;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .result-raid {
            font-weight: bold;
            color: #f97316;
            font-size: 1.3em;
            margin-bottom: 10px;
        }

        .result-capacity {
            font-size: 1.5em;
            font-weight: bold;
            color: #fdba74;
            margin-bottom: 10px;
        }

        .result-details {
            font-size: 0.9em;
            opacity: 0.9;
            line-height: 1.4;
        }

        .quiz-container {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #f97316;
            border-radius: 10px;
            padding: 25px;
        }

        .quiz-question {
            font-size: 1.3em;
            color: #f97316;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-bottom: 20px;
        }

        .quiz-option {
            padding: 15px;
            background: rgba(234, 88, 12, 0.2);
            border: 2px solid #ea580c;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-option:hover {
            background: rgba(234, 88, 12, 0.4);
            transform: translateX(5px);
        }

        .quiz-option.correct {
            background: rgba(16, 185, 129, 0.3);
            border-color: #10b981;
        }

        .quiz-option.incorrect {
            background: rgba(220, 38, 38, 0.3);
            border-color: #dc2626;
        }

        .quiz-feedback {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-weight: bold;
            display: none;
        }

        .quiz-feedback.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        .quiz-feedback.correct {
            background: rgba(16, 185, 129, 0.3);
            border: 2px solid #10b981;
            color: #10b981;
        }

        .quiz-feedback.incorrect {
            background: rgba(220, 38, 38, 0.3);
            border: 2px solid #dc2626;
            color: #fca5a5;
        }

        .quiz-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .quiz-btn {
            flex: 1;
            padding: 12px;
            background: linear-gradient(135deg, #ea580c 0%, #f97316 100%);
            border: none;
            border-radius: 6px;
            color: #fff;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quiz-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(234, 88, 12, 0.4);
        }

        .quiz-score {
            text-align: center;
            font-size: 1.2em;
            margin-top: 15px;
            padding: 15px;
            background: rgba(234, 88, 12, 0.2);
            border-radius: 8px;
            border: 2px solid #ea580c;
        }

        .help-text {
            background: rgba(234, 88, 12, 0.2);
            border-left: 4px solid #f97316;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            line-height: 1.6;
        }

        @media (max-width: 768px) {
            .back-link {
                position: static;
                transform: none;
                display: inline-block;
                margin-bottom: 15px;
            }

            h1 {
                font-size: 1.6em;
            }

            .drives-container {
                gap: 10px;
            }

            .drive {
                width: 100px;
            }

            .comparison-table {
                font-size: 0.85em;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="../../catalog.html" class="back-link">Back to Catalog</a>
            <h1>RAID Level Visualizer</h1>
            <p class="subtitle">House of Forge - Understanding Redundant Array of Independent Disks</p>
        </header>

        <div class="tabs">
            <div class="tab active" data-tab="visualizer">Visual Diagrams</div>
            <div class="tab" data-tab="comparison">Comparison Table</div>
            <div class="tab" data-tab="calculator">Capacity Calculator</div>
            <div class="tab" data-tab="simulation">Failure Simulation</div>
            <div class="tab" data-tab="quiz">Quiz Mode</div>
        </div>

        <!-- Visual Diagrams Section -->
        <div class="content-section active" id="visualizer">
            <div class="raid-selector">
                <button class="raid-btn active" data-raid="0">RAID 0</button>
                <button class="raid-btn" data-raid="1">RAID 1</button>
                <button class="raid-btn" data-raid="5">RAID 5</button>
                <button class="raid-btn" data-raid="6">RAID 6</button>
                <button class="raid-btn" data-raid="10">RAID 10</button>
            </div>

            <div class="raid-display" id="raid-display">
                <!-- Content will be dynamically generated -->
            </div>
        </div>

        <!-- Comparison Table Section -->
        <div class="content-section" id="comparison">
            <div class="raid-display">
                <h2 class="raid-title">RAID Level Comparison</h2>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>RAID Level</th>
                            <th>Min Drives</th>
                            <th>Usable Capacity</th>
                            <th>Fault Tolerance</th>
                            <th>Read Performance</th>
                            <th>Write Performance</th>
                            <th>Best Use Cases</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>RAID 0</strong></td>
                            <td>2</td>
                            <td>100% (n × size)</td>
                            <td>None</td>
                            <td>Excellent</td>
                            <td>Excellent</td>
                            <td>Video editing, temp files, non-critical high-speed storage</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 1</strong></td>
                            <td>2</td>
                            <td>50% (size of 1 drive)</td>
                            <td>n-1 drives</td>
                            <td>Good</td>
                            <td>Fair</td>
                            <td>OS drives, critical small databases, boot drives</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 5</strong></td>
                            <td>3</td>
                            <td>(n-1) × size</td>
                            <td>1 drive</td>
                            <td>Very Good</td>
                            <td>Good</td>
                            <td>File servers, general storage, application servers</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 6</strong></td>
                            <td>4</td>
                            <td>(n-2) × size</td>
                            <td>2 drives</td>
                            <td>Very Good</td>
                            <td>Fair</td>
                            <td>Large capacity arrays, archival storage, mission-critical data</td>
                        </tr>
                        <tr>
                            <td><strong>RAID 10</strong></td>
                            <td>4</td>
                            <td>50% (n/2 × size)</td>
                            <td>1 per mirror</td>
                            <td>Excellent</td>
                            <td>Very Good</td>
                            <td>Databases, high-traffic servers, transactional systems</td>
                        </tr>
                    </tbody>
                </table>

                <div class="help-text" style="margin-top: 25px;">
                    <strong>Key Insights:</strong><br>
                    • RAID 0 offers maximum performance but zero redundancy - any drive failure means total data loss<br>
                    • RAID 1 provides simple mirroring with excellent reliability but 50% capacity overhead<br>
                    • RAID 5 balances capacity, performance, and redundancy - most popular for general use<br>
                    • RAID 6 adds extra parity for higher reliability in large arrays with slow rebuild times<br>
                    • RAID 10 combines mirroring and striping for best performance with redundancy
                </div>
            </div>
        </div>

        <!-- Capacity Calculator Section -->
        <div class="content-section" id="calculator">
            <div class="calculator">
                <h2 class="raid-title">RAID Capacity Calculator</h2>
                <p class="raid-description">Calculate usable storage capacity for different RAID configurations</p>

                <div class="calc-inputs">
                    <div class="input-group">
                        <label for="num-drives">Number of Drives:</label>
                        <input type="number" id="num-drives" min="2" max="24" value="4">
                    </div>
                    <div class="input-group">
                        <label for="drive-size">Drive Size (GB):</label>
                        <input type="number" id="drive-size" min="100" max="20000" step="100" value="1000">
                    </div>
                </div>

                <button class="calc-btn" onclick="calculateCapacity()">Calculate Capacities</button>

                <div class="calc-results" id="calc-results">
                    <!-- Results will be dynamically generated -->
                </div>
            </div>
        </div>

        <!-- Failure Simulation Section -->
        <div class="content-section" id="simulation">
            <div class="raid-display">
                <h2 class="raid-title">Drive Failure Simulation</h2>
                <p class="raid-description">Click on drives to simulate failures and see how different RAID levels handle them</p>

                <div class="raid-selector" style="margin-bottom: 20px;">
                    <button class="raid-btn active" data-sim-raid="0">RAID 0</button>
                    <button class="raid-btn" data-sim-raid="1">RAID 1</button>
                    <button class="raid-btn" data-sim-raid="5">RAID 5</button>
                    <button class="raid-btn" data-sim-raid="6">RAID 6</button>
                    <button class="raid-btn" data-sim-raid="10">RAID 10</button>
                </div>

                <div id="sim-display">
                    <!-- Simulation content will be dynamically generated -->
                </div>

                <button class="calc-btn" onclick="resetSimulation()" style="margin-top: 20px;">Reset Simulation</button>
            </div>
        </div>

        <!-- Quiz Mode Section -->
        <div class="content-section" id="quiz">
            <div class="quiz-container">
                <h2 class="raid-title">RAID Knowledge Quiz</h2>
                <div id="quiz-content">
                    <!-- Quiz content will be dynamically generated -->
                </div>
                <div class="quiz-score" id="quiz-score">Score: 0 / 0</div>
            </div>
        </div>
    </div>

    <script>
        // RAID configuration data
        const raidConfigs = {
            '0': {
                name: 'RAID 0 - Striping',
                description: 'Data is split evenly across all drives with no redundancy. Maximum performance and capacity, but zero fault tolerance.',
                drives: 4,
                blocks: [
                    ['A1', 'A2', 'A3', 'A4'],
                    ['B1', 'B2', 'B3', 'B4'],
                    ['C1', 'C2', 'C3', 'C4']
                ],
                minDrives: 2,
                capacity: '100%',
                faultTolerance: 'None',
                readPerf: 'Excellent',
                writePerf: 'Excellent'
            },
            '1': {
                name: 'RAID 1 - Mirroring',
                description: 'Data is duplicated across all drives. High redundancy but 50% capacity efficiency. Can survive n-1 drive failures.',
                drives: 2,
                blocks: [
                    ['A1', 'A1'],
                    ['B1', 'B1'],
                    ['C1', 'C1'],
                    ['D1', 'D1']
                ],
                minDrives: 2,
                capacity: '50%',
                faultTolerance: 'n-1 drives',
                readPerf: 'Good',
                writePerf: 'Fair'
            },
            '5': {
                name: 'RAID 5 - Striping with Distributed Parity',
                description: 'Data and parity information are distributed across all drives. Can tolerate one drive failure. Good balance of performance, capacity, and redundancy.',
                drives: 4,
                blocks: [
                    ['A1', 'A2', 'A3', 'Ap'],
                    ['B1', 'B2', 'Bp', 'B3'],
                    ['C1', 'Cp', 'C2', 'C3'],
                    ['Dp', 'D1', 'D2', 'D3']
                ],
                minDrives: 3,
                capacity: '(n-1) × size',
                faultTolerance: '1 drive',
                readPerf: 'Very Good',
                writePerf: 'Good'
            },
            '6': {
                name: 'RAID 6 - Double Parity',
                description: 'Similar to RAID 5 but with two parity blocks. Can survive two simultaneous drive failures. Better for large arrays.',
                drives: 5,
                blocks: [
                    ['A1', 'A2', 'A3', 'Ap', 'Aq'],
                    ['B1', 'B2', 'Bp', 'Bq', 'B3'],
                    ['C1', 'Cp', 'Cq', 'C2', 'C3'],
                    ['Dp', 'Dq', 'D1', 'D2', 'D3']
                ],
                minDrives: 4,
                capacity: '(n-2) × size',
                faultTolerance: '2 drives',
                readPerf: 'Very Good',
                writePerf: 'Fair'
            },
            '10': {
                name: 'RAID 10 - Mirrored Stripes (1+0)',
                description: 'Combines RAID 1 mirroring with RAID 0 striping. Excellent performance and redundancy, but 50% capacity efficiency.',
                drives: 4,
                blocks: [
                    ['A1', 'A1', 'A2', 'A2'],
                    ['B1', 'B1', 'B2', 'B2'],
                    ['C1', 'C1', 'C2', 'C2']
                ],
                minDrives: 4,
                capacity: '50%',
                faultTolerance: '1 per mirror',
                readPerf: 'Excellent',
                writePerf: 'Very Good'
            }
        };

        // Current state
        let currentRaid = '0';
        let currentSimRaid = '0';
        let failedDrives = new Set();
        let quizQuestions = [];
        let currentQuestion = 0;
        let quizScore = 0;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setupTabs();
            setupRaidSelector();
            setupSimRaidSelector();
            renderRaidDiagram('0');
            renderSimulation('0');
            loadQuiz();
        });

        // Tab switching
        function setupTabs() {
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const targetTab = this.getAttribute('data-tab');

                    // Update active tab
                    tabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');

                    // Update active section
                    document.querySelectorAll('.content-section').forEach(section => {
                        section.classList.remove('active');
                    });
                    document.getElementById(targetTab).classList.add('active');
                });
            });
        }

        // RAID selector for visualizer
        function setupRaidSelector() {
            const buttons = document.querySelectorAll('.raid-btn[data-raid]');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const raid = this.getAttribute('data-raid');
                    buttons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    renderRaidDiagram(raid);
                });
            });
        }

        // RAID selector for simulation
        function setupSimRaidSelector() {
            const buttons = document.querySelectorAll('.raid-btn[data-sim-raid]');
            buttons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const raid = this.getAttribute('data-sim-raid');
                    buttons.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentSimRaid = raid;
                    failedDrives.clear();
                    renderSimulation(raid);
                });
            });
        }

        // Render RAID diagram
        function renderRaidDiagram(raidLevel) {
            currentRaid = raidLevel;
            const config = raidConfigs[raidLevel];
            const display = document.getElementById('raid-display');

            let html = `
                <h2 class="raid-title">${config.name}</h2>
                <p class="raid-description">${config.description}</p>

                <div class="drives-container">
            `;

            // Create drives
            for (let i = 0; i < config.drives; i++) {
                html += `
                    <div class="drive">
                        <div class="drive-label">Drive ${i + 1}</div>
                        <div class="data-blocks">
                `;

                // Add data blocks
                config.blocks.forEach(row => {
                    const block = row[i];
                    let blockClass = 'block-data';

                    if (block.includes('p') || block.includes('q')) {
                        blockClass = 'block-parity';
                    } else if (raidLevel === '1' || raidLevel === '10') {
                        // For mirroring, alternate colors
                        blockClass = i % 2 === 0 ? 'block-data' : 'block-mirror';
                    }

                    html += `<div class="data-block ${blockClass}">${block}</div>`;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            html += `
                </div>

                <div class="raid-stats">
                    <div class="stat-box">
                        <div class="stat-label">Minimum Drives</div>
                        <div class="stat-value">${config.minDrives}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Usable Capacity</div>
                        <div class="stat-value">${config.capacity}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Fault Tolerance</div>
                        <div class="stat-value">${config.faultTolerance}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Read Performance</div>
                        <div class="stat-value">${config.readPerf}</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Write Performance</div>
                        <div class="stat-value">${config.writePerf}</div>
                    </div>
                </div>
            `;

            display.innerHTML = html;
        }

        // Calculate capacity
        function calculateCapacity() {
            const numDrives = parseInt(document.getElementById('num-drives').value);
            const driveSize = parseInt(document.getElementById('drive-size').value);
            const results = document.getElementById('calc-results');

            if (numDrives < 2 || driveSize < 1) {
                alert('Please enter valid values');
                return;
            }

            const calculations = {
                'RAID 0': {
                    capacity: numDrives * driveSize,
                    efficiency: 100,
                    available: numDrives >= 2
                },
                'RAID 1': {
                    capacity: driveSize,
                    efficiency: (1 / numDrives) * 100,
                    available: numDrives >= 2
                },
                'RAID 5': {
                    capacity: (numDrives - 1) * driveSize,
                    efficiency: ((numDrives - 1) / numDrives) * 100,
                    available: numDrives >= 3
                },
                'RAID 6': {
                    capacity: (numDrives - 2) * driveSize,
                    efficiency: ((numDrives - 2) / numDrives) * 100,
                    available: numDrives >= 4
                },
                'RAID 10': {
                    capacity: (numDrives / 2) * driveSize,
                    efficiency: 50,
                    available: numDrives >= 4 && numDrives % 2 === 0
                }
            };

            let html = '';

            for (const [raid, calc] of Object.entries(calculations)) {
                if (calc.available) {
                    html += `
                        <div class="result-card">
                            <div class="result-raid">${raid}</div>
                            <div class="result-capacity">${calc.capacity} GB</div>
                            <div class="result-details">
                                Efficiency: ${calc.efficiency.toFixed(1)}%<br>
                                Raw: ${numDrives * driveSize} GB
                            </div>
                        </div>
                    `;
                } else {
                    html += `
                        <div class="result-card" style="opacity: 0.5;">
                            <div class="result-raid">${raid}</div>
                            <div class="result-capacity">N/A</div>
                            <div class="result-details">
                                Requires ${raid === 'RAID 10' ? 'even number of drives (min 4)' : 'more drives'}
                            </div>
                        </div>
                    `;
                }
            }

            results.innerHTML = html;
            results.classList.add('show');
        }

        // Render failure simulation
        function renderSimulation(raidLevel) {
            const config = raidConfigs[raidLevel];
            const display = document.getElementById('sim-display');

            let status = 'Array is healthy';
            let statusClass = '';
            let canSurvive = true;

            // Check array status
            if (failedDrives.size > 0) {
                if (raidLevel === '0') {
                    status = 'DATA LOST! RAID 0 cannot survive any drive failure.';
                    statusClass = 'incorrect';
                    canSurvive = false;
                } else if (raidLevel === '1') {
                    if (failedDrives.size >= config.drives) {
                        status = 'DATA LOST! All mirrors have failed.';
                        statusClass = 'incorrect';
                        canSurvive = false;
                    } else {
                        status = `Array degraded but operational. ${config.drives - failedDrives.size} mirror(s) remaining.`;
                        statusClass = 'correct';
                    }
                } else if (raidLevel === '5') {
                    if (failedDrives.size > 1) {
                        status = 'DATA LOST! RAID 5 can only survive 1 drive failure.';
                        statusClass = 'incorrect';
                        canSurvive = false;
                    } else {
                        status = 'Array degraded. Data can be rebuilt from parity.';
                        statusClass = 'correct';
                    }
                } else if (raidLevel === '6') {
                    if (failedDrives.size > 2) {
                        status = 'DATA LOST! RAID 6 can only survive 2 drive failures.';
                        statusClass = 'incorrect';
                        canSurvive = false;
                    } else {
                        status = `Array degraded. ${2 - failedDrives.size} more drive(s) can fail safely.`;
                        statusClass = 'correct';
                    }
                } else if (raidLevel === '10') {
                    // RAID 10 can survive one failure per mirror pair
                    let mirrorFailures = [0, 0];
                    failedDrives.forEach(drive => {
                        mirrorFailures[drive < 2 ? 0 : 1]++;
                    });
                    if (mirrorFailures[0] >= 2 || mirrorFailures[1] >= 2) {
                        status = 'DATA LOST! Both drives in a mirror pair have failed.';
                        statusClass = 'incorrect';
                        canSurvive = false;
                    } else {
                        status = 'Array degraded but operational. Data is protected.';
                        statusClass = 'correct';
                    }
                }
            }

            let html = `
                <div class="help-text">
                    <strong>Instructions:</strong> Click on any drive to simulate a failure. Observe how the array responds.
                </div>

                <div class="quiz-feedback show ${statusClass}" style="font-size: 1.1em; margin: 20px 0;">
                    ${status}
                </div>

                <div class="drives-container">
            `;

            // Create drives with click handlers
            for (let i = 0; i < config.drives; i++) {
                const isFailed = failedDrives.has(i);
                html += `
                    <div class="drive ${isFailed ? 'failed' : ''}" onclick="toggleDriveFailure(${i})">
                        <div class="drive-label">Drive ${i + 1}</div>
                        <div class="data-blocks">
                `;

                config.blocks.forEach(row => {
                    const block = row[i];
                    let blockClass = 'block-data';

                    if (block.includes('p') || block.includes('q')) {
                        blockClass = 'block-parity';
                    } else if (raidLevel === '1' || raidLevel === '10') {
                        blockClass = i % 2 === 0 ? 'block-data' : 'block-mirror';
                    }

                    html += `<div class="data-block ${blockClass}">${block}</div>`;
                });

                html += `
                        </div>
                    </div>
                `;
            }

            html += '</div>';

            display.innerHTML = html;
        }

        // Toggle drive failure
        function toggleDriveFailure(driveIndex) {
            if (failedDrives.has(driveIndex)) {
                failedDrives.delete(driveIndex);
            } else {
                failedDrives.add(driveIndex);
            }
            renderSimulation(currentSimRaid);
        }

        // Reset simulation
        function resetSimulation() {
            failedDrives.clear();
            renderSimulation(currentSimRaid);
        }

        // Quiz questions
        function loadQuiz() {
            quizQuestions = [
                {
                    question: 'Which RAID level provides the best performance but no redundancy?',
                    options: ['RAID 0', 'RAID 1', 'RAID 5', 'RAID 6'],
                    correct: 0,
                    explanation: 'RAID 0 stripes data across all drives for maximum performance, but offers no redundancy. Any drive failure results in complete data loss.'
                },
                {
                    question: 'How many drives can fail in a RAID 5 array before data is lost?',
                    options: ['None', 'One', 'Two', 'Three'],
                    correct: 1,
                    explanation: 'RAID 5 can survive exactly one drive failure. The distributed parity allows data reconstruction from the remaining drives.'
                },
                {
                    question: 'What is the usable capacity of a 4-drive RAID 10 array with 1TB drives?',
                    options: ['1TB', '2TB', '3TB', '4TB'],
                    correct: 1,
                    explanation: 'RAID 10 mirrors data, so usable capacity is 50%. With 4 drives of 1TB each, you get 2TB usable (2 mirrored pairs).'
                },
                {
                    question: 'Which RAID level is best for a high-traffic database server?',
                    options: ['RAID 0', 'RAID 1', 'RAID 5', 'RAID 10'],
                    correct: 3,
                    explanation: 'RAID 10 offers the best combination of read/write performance and redundancy, making it ideal for transactional databases.'
                },
                {
                    question: 'What advantage does RAID 6 have over RAID 5?',
                    options: ['Better performance', 'More capacity', 'Can survive 2 drive failures', 'Lower cost'],
                    correct: 2,
                    explanation: 'RAID 6 uses double parity (two parity blocks per stripe) allowing it to survive two simultaneous drive failures, unlike RAID 5 which can only survive one.'
                },
                {
                    question: 'What is the minimum number of drives required for RAID 5?',
                    options: ['2 drives', '3 drives', '4 drives', '5 drives'],
                    correct: 1,
                    explanation: 'RAID 5 requires a minimum of 3 drives - at least 2 for data and 1 for distributed parity information.'
                },
                {
                    question: 'Which RAID level would you choose for maximum storage capacity?',
                    options: ['RAID 0', 'RAID 1', 'RAID 6', 'RAID 10'],
                    correct: 0,
                    explanation: 'RAID 0 uses 100% of all drive capacity (n × size), though it offers no redundancy. RAID 5 would be the best choice if redundancy is needed.'
                },
                {
                    question: 'What does the "parity" block in RAID 5 contain?',
                    options: ['Duplicate data', 'Compressed data', 'XOR calculation for recovery', 'Empty space'],
                    correct: 2,
                    explanation: 'Parity blocks contain XOR calculations of the data blocks in the stripe, allowing reconstruction of lost data if one drive fails.'
                }
            ];

            currentQuestion = 0;
            quizScore = 0;
            renderQuizQuestion();
        }

        // Render quiz question
        function renderQuizQuestion() {
            if (currentQuestion >= quizQuestions.length) {
                showQuizResults();
                return;
            }

            const q = quizQuestions[currentQuestion];
            const content = document.getElementById('quiz-content');

            let html = `
                <div class="quiz-question">Question ${currentQuestion + 1} of ${quizQuestions.length}:<br>${q.question}</div>
                <div class="quiz-options">
            `;

            q.options.forEach((option, index) => {
                html += `<div class="quiz-option" onclick="selectAnswer(${index})">${option}</div>`;
            });

            html += `
                </div>
                <div class="quiz-feedback" id="quiz-feedback"></div>
                <div class="quiz-controls" style="display: none;" id="quiz-next">
                    <button class="quiz-btn" onclick="nextQuestion()">Next Question</button>
                </div>
            `;

            content.innerHTML = html;
            updateQuizScore();
        }

        // Select answer
        function selectAnswer(answerIndex) {
            const q = quizQuestions[currentQuestion];
            const options = document.querySelectorAll('.quiz-option');
            const feedback = document.getElementById('quiz-feedback');
            const nextBtn = document.getElementById('quiz-next');

            // Disable further clicks
            options.forEach(opt => opt.style.pointerEvents = 'none');

            // Mark selected answer
            options[answerIndex].classList.add(answerIndex === q.correct ? 'correct' : 'incorrect');

            // Show correct answer if wrong was selected
            if (answerIndex !== q.correct) {
                options[q.correct].classList.add('correct');
            }

            // Show feedback
            if (answerIndex === q.correct) {
                feedback.className = 'quiz-feedback show correct';
                feedback.textContent = 'Correct! ' + q.explanation;
                quizScore++;
            } else {
                feedback.className = 'quiz-feedback show incorrect';
                feedback.textContent = 'Incorrect. ' + q.explanation;
            }

            // Show next button
            nextBtn.style.display = 'flex';
            updateQuizScore();
        }

        // Next question
        function nextQuestion() {
            currentQuestion++;
            renderQuizQuestion();
        }

        // Update quiz score
        function updateQuizScore() {
            document.getElementById('quiz-score').textContent =
                `Score: ${quizScore} / ${currentQuestion + 1} | Progress: ${currentQuestion + 1} / ${quizQuestions.length}`;
        }

        // Show quiz results
        function showQuizResults() {
            const content = document.getElementById('quiz-content');
            const percentage = (quizScore / quizQuestions.length * 100).toFixed(1);

            let grade = '';
            let gradeClass = '';

            if (percentage >= 90) {
                grade = 'Excellent! You are a RAID expert!';
                gradeClass = 'correct';
            } else if (percentage >= 70) {
                grade = 'Good job! You have a solid understanding of RAID.';
                gradeClass = 'correct';
            } else if (percentage >= 50) {
                grade = 'Not bad, but review the material for better understanding.';
                gradeClass = '';
            } else {
                grade = 'Keep studying! Review the visualizations and comparison table.';
                gradeClass = 'incorrect';
            }

            content.innerHTML = `
                <div class="quiz-question">Quiz Complete!</div>
                <div class="quiz-feedback show ${gradeClass}" style="font-size: 1.3em;">
                    Final Score: ${quizScore} / ${quizQuestions.length} (${percentage}%)
                </div>
                <div class="help-text" style="text-align: center; font-size: 1.1em;">
                    ${grade}
                </div>
                <div class="quiz-controls">
                    <button class="quiz-btn" onclick="loadQuiz()">Retake Quiz</button>
                </div>
            `;

            document.getElementById('quiz-score').textContent =
                `Final Score: ${quizScore} / ${quizQuestions.length} (${percentage}%)`;
        }
    </script>
</body>
</html>