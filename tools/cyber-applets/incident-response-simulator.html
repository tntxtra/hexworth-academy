<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CompTIA A+ Core 2: Incident Response Simulator | House of Shield</title>
    <style>
        /* ===== GLOBAL STYLES & CSS VARIABLES ===== */
        :root {
            --primary-red: #dc2626;
            --primary-red-dark: #b91c1c;
            --primary-red-light: #ef4444;
            --gold-accent: #fbbf24;
            --gold-dark: #f59e0b;
            --dark-bg: #1a1a1a;
            --card-bg: #2d2d2d;
            --text-primary: #f5f5f5;
            --text-secondary: #a3a3a3;
            --success-green: #22c55e;
            --warning-orange: #f97316;
            --error-red: #ef4444;
            --border-color: #404040;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d1a1a 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }

        /* ===== HEADER STYLES ===== */
        header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px 20px;
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--primary-red-dark) 100%);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(220, 38, 38, 0.3);
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 10px,
                rgba(255, 255, 255, 0.03) 10px,
                rgba(255, 255, 255, 0.03) 20px
            );
            animation: shimmer 20s linear infinite;
            pointer-events: none;
        }

        @keyframes shimmer {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 1;
        }

        .subtitle {
            font-size: 1.2em;
            color: var(--gold-accent);
            font-weight: 600;
            position: relative;
            z-index: 1;
        }

        .shield-icon {
            font-size: 3em;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 10px var(--gold-accent));
        }

        /* ===== NAVIGATION TABS ===== */
        .tab-navigation {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 30px;
            padding: 0 20px;
        }

        .tab-btn {
            padding: 12px 24px;
            background: var(--card-bg);
            border: 2px solid var(--primary-red);
            color: var(--text-primary);
            cursor: pointer;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tab-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: var(--primary-red);
            transition: left 0.3s ease;
            z-index: 0;
        }

        .tab-btn span {
            position: relative;
            z-index: 1;
        }

        .tab-btn:hover::before {
            left: 0;
        }

        .tab-btn.active {
            background: var(--primary-red);
            border-color: var(--gold-accent);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
        }

        .tab-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
        }

        /* ===== CONTENT SECTIONS ===== */
        .content-section {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .content-section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* ===== CARD STYLES ===== */
        .card {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 15px rgba(220, 38, 38, 0.2);
        }

        .card-header {
            font-size: 1.5em;
            color: var(--gold-accent);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-red);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* ===== INCIDENT RESPONSE PROCESS ===== */
        .process-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .step-card {
            background: linear-gradient(135deg, var(--card-bg) 0%, #252525 100%);
            border-left: 4px solid var(--primary-red);
            padding: 20px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
        }

        .step-number {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 40px;
            background: var(--primary-red);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            font-weight: bold;
            color: var(--gold-accent);
        }

        .step-title {
            font-size: 1.3em;
            color: var(--gold-accent);
            margin-bottom: 10px;
            font-weight: 600;
        }

        .step-description {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        .step-actions {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--border-color);
        }

        .step-actions ul {
            list-style: none;
            padding-left: 0;
        }

        .step-actions li {
            padding: 5px 0;
            padding-left: 25px;
            position: relative;
        }

        .step-actions li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: var(--primary-red);
            font-weight: bold;
        }

        /* ===== SCENARIO SIMULATOR ===== */
        .scenario-container {
            background: var(--dark-bg);
            border-radius: 12px;
            padding: 30px;
            border: 2px solid var(--primary-red);
        }

        .scenario-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .scenario-type {
            display: inline-block;
            background: var(--primary-red);
            color: var(--text-primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .scenario-title {
            font-size: 1.8em;
            color: var(--gold-accent);
            margin-bottom: 10px;
        }

        .scenario-description {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--gold-accent);
            line-height: 1.8;
        }

        .scenario-choices {
            margin: 25px 0;
        }

        .choice-btn {
            display: block;
            width: 100%;
            padding: 15px 20px;
            margin: 10px 0;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1em;
            text-align: left;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .choice-btn::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            height: 100%;
            width: 4px;
            background: var(--primary-red);
            transition: width 0.3s ease;
        }

        .choice-btn:hover {
            border-color: var(--primary-red);
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(220, 38, 38, 0.3);
        }

        .choice-btn:hover::before {
            width: 100%;
            opacity: 0.1;
        }

        .choice-btn.correct {
            border-color: var(--success-green);
            background: rgba(34, 197, 94, 0.1);
        }

        .choice-btn.incorrect {
            border-color: var(--error-red);
            background: rgba(239, 68, 68, 0.1);
        }

        .choice-btn:disabled {
            cursor: not-allowed;
            opacity: 0.6;
        }

        .feedback {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .feedback.correct {
            background: rgba(34, 197, 94, 0.1);
            border: 2px solid var(--success-green);
        }

        .feedback.incorrect {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--error-red);
        }

        .feedback-title {
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .scenario-controls {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 10px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            background: var(--primary-red);
            border: none;
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: var(--primary-red-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 38, 38, 0.4);
        }

        .btn:disabled {
            background: var(--text-secondary);
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: var(--card-bg);
            border: 2px solid var(--primary-red);
        }

        .btn-secondary:hover {
            background: var(--primary-red);
        }

        /* ===== EVIDENCE COLLECTOR ===== */
        .evidence-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .evidence-item {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .evidence-item:hover {
            border-color: var(--primary-red);
            transform: scale(1.05);
        }

        .evidence-item.collected {
            border-color: var(--success-green);
            background: rgba(34, 197, 94, 0.05);
        }

        .evidence-item.collected::after {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: var(--success-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .evidence-icon {
            font-size: 2.5em;
            text-align: center;
            margin-bottom: 10px;
        }

        .evidence-title {
            font-size: 1.1em;
            color: var(--gold-accent);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .evidence-description {
            font-size: 0.9em;
            color: var(--text-secondary);
        }

        .evidence-score {
            text-align: center;
            margin-top: 25px;
            padding: 20px;
            background: var(--dark-bg);
            border-radius: 8px;
            border: 2px solid var(--gold-accent);
        }

        .evidence-score h3 {
            color: var(--gold-accent);
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .score-display {
            font-size: 2em;
            color: var(--primary-red);
            font-weight: bold;
        }

        /* ===== COMMUNICATION TREE ===== */
        .communication-tree {
            margin: 20px 0;
        }

        .incident-type-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .incident-type-btn {
            padding: 15px;
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-weight: 600;
        }

        .incident-type-btn:hover {
            border-color: var(--primary-red);
            transform: translateY(-3px);
        }

        .incident-type-btn.selected {
            background: var(--primary-red);
            border-color: var(--gold-accent);
        }

        .contact-chain {
            display: none;
            margin-top: 25px;
        }

        .contact-chain.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        .contact-level {
            margin: 20px 0;
            position: relative;
            padding-left: 40px;
        }

        .contact-level::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 40px;
            bottom: -20px;
            width: 2px;
            background: var(--primary-red);
        }

        .contact-level:last-child::before {
            display: none;
        }

        .contact-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid var(--gold-accent);
            position: relative;
        }

        .contact-card::before {
            content: '';
            position: absolute;
            left: -42px;
            top: 25px;
            width: 20px;
            height: 2px;
            background: var(--primary-red);
        }

        .contact-priority {
            display: inline-block;
            padding: 4px 12px;
            background: var(--primary-red);
            color: var(--text-primary);
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .contact-title {
            font-size: 1.2em;
            color: var(--gold-accent);
            margin-bottom: 8px;
            font-weight: 600;
        }

        .contact-info {
            color: var(--text-secondary);
            margin: 5px 0;
        }

        .contact-when {
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
            font-style: italic;
            color: var(--text-secondary);
        }

        /* ===== QUIZ SECTION ===== */
        .quiz-container {
            background: var(--dark-bg);
            border-radius: 12px;
            padding: 30px;
            border: 2px solid var(--primary-red);
        }

        .quiz-progress {
            margin-bottom: 25px;
        }

        .progress-bar {
            width: 100%;
            height: 30px;
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            border: 2px solid var(--border-color);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-red), var(--gold-accent));
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 0.9em;
        }

        .quiz-question {
            background: var(--card-bg);
            padding: 25px;
            border-radius: 8px;
            margin: 20px 0;
            border-left: 4px solid var(--gold-accent);
        }

        .question-number {
            color: var(--gold-accent);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .quiz-options {
            margin: 20px 0;
        }

        .option-btn {
            display: block;
            width: 100%;
            padding: 15px 20px;
            margin: 10px 0;
            background: var(--dark-bg);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1em;
            text-align: left;
            transition: all 0.3s ease;
        }

        .option-btn:hover {
            border-color: var(--primary-red);
            background: var(--card-bg);
        }

        .option-btn.selected {
            border-color: var(--gold-accent);
            background: rgba(251, 191, 36, 0.1);
        }

        .option-btn.correct {
            border-color: var(--success-green);
            background: rgba(34, 197, 94, 0.1);
        }

        .option-btn.incorrect {
            border-color: var(--error-red);
            background: rgba(239, 68, 68, 0.1);
        }

        .option-btn:disabled {
            cursor: not-allowed;
        }

        .quiz-results {
            text-align: center;
            padding: 40px 20px;
        }

        .results-score {
            font-size: 3em;
            color: var(--gold-accent);
            font-weight: bold;
            margin: 20px 0;
        }

        .results-message {
            font-size: 1.3em;
            margin: 20px 0;
        }

        .results-feedback {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: left;
        }

        /* ===== TIMELINE VIEW ===== */
        .timeline {
            position: relative;
            padding: 20px 0;
            margin: 30px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background: var(--primary-red);
        }

        .timeline-item {
            margin: 30px 0;
            position: relative;
        }

        .timeline-item:nth-child(odd) .timeline-content {
            margin-right: 52%;
        }

        .timeline-item:nth-child(even) .timeline-content {
            margin-left: 52%;
        }

        .timeline-marker {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 40px;
            height: 40px;
            background: var(--primary-red);
            border: 4px solid var(--gold-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            z-index: 1;
        }

        .timeline-content {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
        }

        .timeline-time {
            color: var(--gold-accent);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .timeline-title {
            font-size: 1.3em;
            margin-bottom: 10px;
            color: var(--text-primary);
        }

        .timeline-description {
            color: var(--text-secondary);
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .subtitle {
                font-size: 1em;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .process-steps {
                grid-template-columns: 1fr;
            }

            .timeline::before {
                left: 20px;
            }

            .timeline-item:nth-child(odd) .timeline-content,
            .timeline-item:nth-child(even) .timeline-content {
                margin-left: 60px;
                margin-right: 0;
            }

            .timeline-marker {
                left: 20px;
            }

            .evidence-grid {
                grid-template-columns: 1fr;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .hidden {
            display: none;
        }

        .text-center {
            text-align: center;
        }

        .mt-20 {
            margin-top: 20px;
        }

        .mb-20 {
            margin-bottom: 20px;
        }

        /* ===== BADGE STYLES ===== */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
            margin: 0 5px;
        }

        .badge-critical {
            background: var(--error-red);
            color: white;
        }

        .badge-high {
            background: var(--warning-orange);
            color: white;
        }

        .badge-medium {
            background: var(--gold-accent);
            color: var(--dark-bg);
        }

        .badge-low {
            background: var(--success-green);
            color: white;
        }

        /* ===== INFO BOXES ===== */
        .info-box {
            background: rgba(251, 191, 36, 0.1);
            border: 2px solid var(--gold-accent);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .info-box-title {
            color: var(--gold-accent);
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-box {
            background: rgba(239, 68, 68, 0.1);
            border: 2px solid var(--error-red);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .warning-box-title {
            color: var(--error-red);
            font-weight: 600;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header>
        <div class="shield-icon">üõ°Ô∏è</div>
        <h1>Incident Response Simulator</h1>
        <p class="subtitle">CompTIA A+ Core 2 | House of Shield Training</p>
    </header>

    <!-- NAVIGATION TABS -->
    <div class="container">
        <div class="tab-navigation">
            <button class="tab-btn active" onclick="switchTab('process')">
                <span>üìã IR Process</span>
            </button>
            <button class="tab-btn" onclick="switchTab('scenarios')">
                <span>üéØ Scenarios</span>
            </button>
            <button class="tab-btn" onclick="switchTab('evidence')">
                <span>üîç Evidence Collection</span>
            </button>
            <button class="tab-btn" onclick="switchTab('communication')">
                <span>üìû Communication Tree</span>
            </button>
            <button class="tab-btn" onclick="switchTab('quiz')">
                <span>‚úì Quiz</span>
            </button>
        </div>

        <!-- TAB 1: INCIDENT RESPONSE PROCESS -->
        <div id="process" class="content-section active">
            <div class="card">
                <div class="card-header">
                    üìã The Incident Response Process
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    The incident response process is a structured approach to handling security incidents. Following these six phases ensures incidents are managed effectively, minimize damage, and provide opportunities for organizational learning.
                </p>

                <div class="info-box">
                    <div class="info-box-title">üí° CompTIA A+ Exam Focus</div>
                    <p>Know the six phases in order and understand the key actions for each phase. First responder actions (identify, report, preserve evidence, document) are critical for the exam.</p>
                </div>
            </div>

            <div class="process-steps">
                <!-- Step 1: Preparation -->
                <div class="step-card">
                    <div class="step-number">1</div>
                    <div class="step-title">Preparation</div>
                    <div class="step-description">
                        Establish policies, procedures, and tools before an incident occurs. This proactive phase sets the foundation for effective incident response.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Create incident response plan and policies</li>
                            <li>Establish incident response team</li>
                            <li>Deploy monitoring and detection tools</li>
                            <li>Conduct security awareness training</li>
                            <li>Prepare jump bags and forensic tools</li>
                            <li>Document contact information and escalation procedures</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 2: Identification -->
                <div class="step-card">
                    <div class="step-number">2</div>
                    <div class="step-title">Identification</div>
                    <div class="step-description">
                        Detect and determine if a security incident has occurred. Analyze alerts and determine the scope and severity of the incident.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Monitor alerts from security tools (SIEM, IDS/IPS, antivirus)</li>
                            <li>Verify the incident is genuine (not false positive)</li>
                            <li>Determine incident type and severity</li>
                            <li>Document initial findings and timeline</li>
                            <li>Begin evidence preservation immediately</li>
                            <li>Notify appropriate personnel</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 3: Containment -->
                <div class="step-card">
                    <div class="step-number">3</div>
                    <div class="step-title">Containment</div>
                    <div class="step-description">
                        Limit the damage and prevent the incident from spreading. Short-term containment stops the bleeding; long-term containment enables recovery.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Isolate affected systems from network</li>
                            <li>Disable compromised user accounts</li>
                            <li>Block malicious IP addresses or domains</li>
                            <li>Preserve evidence during containment</li>
                            <li>Implement temporary fixes or workarounds</li>
                            <li>Continue monitoring for lateral movement</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 4: Eradication -->
                <div class="step-card">
                    <div class="step-number">4</div>
                    <div class="step-title">Eradication</div>
                    <div class="step-description">
                        Remove the threat from the environment. Eliminate malware, close vulnerabilities, and ensure the attacker no longer has access.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Remove malware and malicious tools</li>
                            <li>Delete unauthorized accounts or backdoors</li>
                            <li>Patch vulnerabilities that were exploited</li>
                            <li>Reset compromised passwords</li>
                            <li>Review and harden security configurations</li>
                            <li>Verify complete removal of threat</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 5: Recovery -->
                <div class="step-card">
                    <div class="step-number">5</div>
                    <div class="step-title">Recovery</div>
                    <div class="step-description">
                        Restore systems to normal operation and verify that systems are functioning properly without signs of compromise.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Restore systems from clean backups</li>
                            <li>Rebuild compromised systems from scratch</li>
                            <li>Gradually return systems to production</li>
                            <li>Enhanced monitoring for signs of persistence</li>
                            <li>Verify business operations are normal</li>
                            <li>Communicate restoration status to stakeholders</li>
                        </ul>
                    </div>
                </div>

                <!-- Step 6: Lessons Learned -->
                <div class="step-card">
                    <div class="step-number">6</div>
                    <div class="step-title">Lessons Learned</div>
                    <div class="step-description">
                        Conduct a post-incident review to improve future response. Document what happened, what worked, and what needs improvement.
                    </div>
                    <div class="step-actions">
                        <strong style="color: var(--gold-accent);">Key Actions:</strong>
                        <ul>
                            <li>Hold post-incident review meeting</li>
                            <li>Document complete incident timeline</li>
                            <li>Identify what was done well and poorly</li>
                            <li>Update policies and procedures</li>
                            <li>Implement preventive measures</li>
                            <li>Provide additional training if needed</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- First Responder Actions -->
            <div class="card">
                <div class="card-header">
                    üö® First Responder Actions
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    As a first responder, your initial actions are critical. You may not be a forensics expert, but you play a vital role in preserving evidence and containing damage.
                </p>

                <div class="warning-box">
                    <div class="warning-box-title">‚ö†Ô∏è Critical: Do Not Contaminate Evidence</div>
                    <p>Never make changes to a compromised system that could destroy evidence. Document everything you do and minimize your interaction with the affected system.</p>
                </div>

                <div style="margin-top: 20px;">
                    <h3 style="color: var(--gold-accent); margin-bottom: 15px;">Essential First Responder Steps:</h3>
                    <div style="background: var(--dark-bg); padding: 20px; border-radius: 8px;">
                        <ol style="color: var(--text-secondary); line-height: 2; padding-left: 20px;">
                            <li><strong style="color: var(--text-primary);">Identify the incident:</strong> Verify something abnormal has occurred</li>
                            <li><strong style="color: var(--text-primary);">Report immediately:</strong> Notify your supervisor and IT security team</li>
                            <li><strong style="color: var(--text-primary);">Preserve evidence:</strong> Don't turn off systems (unless instructed), don't delete files, minimize interaction</li>
                            <li><strong style="color: var(--text-primary);">Document everything:</strong> Take photos, notes, screenshots with timestamps</li>
                            <li><strong style="color: var(--text-primary);">Isolate if possible:</strong> Disconnect network cable (not power) to prevent spread</li>
                            <li><strong style="color: var(--text-primary);">Secure the area:</strong> Prevent unauthorized access to affected systems</li>
                            <li><strong style="color: var(--text-primary);">Wait for experts:</strong> Let forensics team take over when they arrive</li>
                        </ol>
                    </div>
                </div>
            </div>

            <!-- Chain of Custody -->
            <div class="card">
                <div class="card-header">
                    üìú Chain of Custody
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Chain of custody is the documented process of who collected evidence, when it was collected, how it was handled, and who had access to it. This documentation is critical for legal proceedings.
                </p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-top: 20px;">
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-red);">
                        <strong style="color: var(--gold-accent);">What to Document:</strong>
                        <ul style="color: var(--text-secondary); margin-top: 10px; line-height: 1.8;">
                            <li>Date and time of collection</li>
                            <li>Who collected the evidence</li>
                            <li>Description of evidence</li>
                            <li>Location where found</li>
                            <li>Serial numbers/identifiers</li>
                        </ul>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-red);">
                        <strong style="color: var(--gold-accent);">Transfer Documentation:</strong>
                        <ul style="color: var(--text-secondary); margin-top: 10px; line-height: 1.8;">
                            <li>Who received the evidence</li>
                            <li>Date and time of transfer</li>
                            <li>Purpose of transfer</li>
                            <li>Signatures of both parties</li>
                            <li>Condition of evidence</li>
                        </ul>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-red);">
                        <strong style="color: var(--gold-accent);">Storage Requirements:</strong>
                        <ul style="color: var(--text-secondary); margin-top: 10px; line-height: 1.8;">
                            <li>Secure storage location</li>
                            <li>Limited access controls</li>
                            <li>Environmental protection</li>
                            <li>Tamper-evident containers</li>
                            <li>Access logs maintained</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 2: SCENARIO SIMULATOR -->
        <div id="scenarios" class="content-section">
            <div class="scenario-container">
                <div class="scenario-header">
                    <div class="scenario-type" id="scenarioType">Malware Infection</div>
                    <h2 class="scenario-title" id="scenarioTitle">Loading Scenario...</h2>
                </div>

                <div class="scenario-description" id="scenarioDescription">
                    Select a scenario from the buttons below to begin your incident response training.
                </div>

                <div id="scenarioContent">
                    <!-- Scenario content will be dynamically loaded here -->
                </div>

                <div id="scenarioFeedback"></div>

                <div class="scenario-controls">
                    <button class="btn btn-secondary" onclick="previousScenario()">
                        ‚Üê Previous Scenario
                    </button>
                    <button class="btn" onclick="nextScenario()">
                        Next Scenario ‚Üí
                    </button>
                    <button class="btn btn-secondary" onclick="resetScenario()">
                        üîÑ Reset Current
                    </button>
                </div>
            </div>

            <div class="card" style="margin-top: 25px;">
                <div class="card-header">
                    üìö Common Incident Types
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">ü¶† Malware Infection</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Virus, worm, trojan, or other malicious software affecting systems. Requires isolation, analysis, and removal.</p>
                        <span class="badge badge-high" style="margin-top: 10px;">High Priority</span>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">üîì Data Breach</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Unauthorized access to sensitive data. May have legal reporting requirements and notification obligations.</p>
                        <span class="badge badge-critical" style="margin-top: 10px;">Critical</span>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">üé£ Phishing Success</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Employee fell for phishing attack and provided credentials or clicked malicious link. Requires immediate credential reset.</p>
                        <span class="badge badge-high" style="margin-top: 10px;">High Priority</span>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">üîí Ransomware Attack</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Files encrypted with ransom demand. Do not pay ransom. Isolate systems, identify variant, restore from backups.</p>
                        <span class="badge badge-critical" style="margin-top: 10px;">Critical</span>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">üë§ Unauthorized Access</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Someone accessed systems without authorization. Review logs, determine scope, revoke access, investigate how it occurred.</p>
                        <span class="badge badge-high" style="margin-top: 10px;">High Priority</span>
                    </div>
                    <div style="background: var(--dark-bg); padding: 15px; border-radius: 8px;">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">üö™ Physical Security Breach</h4>
                        <p style="color: var(--text-secondary); font-size: 0.95em;">Unauthorized physical access to facility or equipment. Check for tampering, review access logs and camera footage.</p>
                        <span class="badge badge-medium" style="margin-top: 10px;">Medium Priority</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 3: EVIDENCE COLLECTION -->
        <div id="evidence" class="content-section">
            <div class="card">
                <div class="card-header">
                    üîç Evidence Collection Exercise
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    You've discovered a compromised workstation. Click on the evidence items that should be collected and documented during your investigation. Collect all critical evidence to achieve 100%.
                </p>

                <div class="info-box">
                    <div class="info-box-title">üì∏ Order of Volatility</div>
                    <p>Collect evidence from most volatile to least volatile: CPU cache/registers ‚Üí RAM ‚Üí Swap files ‚Üí Hard disk ‚Üí Logs ‚Üí Backups. Volatile data is lost when power is removed.</p>
                </div>
            </div>

            <div class="evidence-grid" id="evidenceGrid">
                <!-- Evidence items will be populated by JavaScript -->
            </div>

            <div class="evidence-score">
                <h3>Evidence Collection Progress</h3>
                <div class="score-display"><span id="evidenceScore">0</span>%</div>
                <p style="color: var(--text-secondary); margin-top: 10px;">
                    <span id="evidenceCollected">0</span> of <span id="evidenceTotal">0</span> items collected
                </p>
                <button class="btn" onclick="resetEvidence()" style="margin-top: 15px;">üîÑ Reset Exercise</button>
            </div>

            <div class="card">
                <div class="card-header">
                    üìù Documentation Best Practices
                </div>
                <div style="background: var(--dark-bg); padding: 20px; border-radius: 8px;">
                    <ul style="color: var(--text-secondary); line-height: 2;">
                        <li><strong style="color: var(--text-primary);">Timestamp everything:</strong> Record exact date and time for all actions</li>
                        <li><strong style="color: var(--text-primary);">Take photographs:</strong> Visual evidence of physical state, screen contents, connections</li>
                        <li><strong style="color: var(--text-primary);">Screenshot displays:</strong> Capture error messages, unusual activity, system states</li>
                        <li><strong style="color: var(--text-primary);">Record network connections:</strong> Use netstat, document active connections and processes</li>
                        <li><strong style="color: var(--text-primary);">Note physical observations:</strong> LED activity, sounds, smells, physical damage</li>
                        <li><strong style="color: var(--text-primary);">Document user statements:</strong> What the user was doing, what they observed</li>
                        <li><strong style="color: var(--text-primary);">Preserve logs:</strong> Export system logs, application logs, security logs before they rotate</li>
                        <li><strong style="color: var(--text-primary);">Create disk images:</strong> Use write blockers, calculate hash values for integrity</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- TAB 4: COMMUNICATION TREE -->
        <div id="communication" class="content-section">
            <div class="card">
                <div class="card-header">
                    üìû Incident Communication Procedures
                </div>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Knowing who to contact and when is critical during an incident. Select an incident type below to see the proper communication chain and notification procedures.
                </p>

                <div class="warning-box">
                    <div class="warning-box-title">‚ö†Ô∏è Never Delay Reporting</div>
                    <p>When in doubt, report up. Over-reporting is better than under-reporting. Many incidents have legal notification timeframes (e.g., GDPR requires breach notification within 72 hours).</p>
                </div>
            </div>

            <div class="card">
                <div class="incident-type-selector">
                    <button class="incident-type-btn" onclick="showCommunicationTree('malware')">
                        ü¶† Malware Infection
                    </button>
                    <button class="incident-type-btn" onclick="showCommunicationTree('breach')">
                        üîì Data Breach
                    </button>
                    <button class="incident-type-btn" onclick="showCommunicationTree('ransomware')">
                        üîí Ransomware
                    </button>
                    <button class="incident-type-btn" onclick="showCommunicationTree('unauthorized')">
                        üë§ Unauthorized Access
                    </button>
                    <button class="incident-type-btn" onclick="showCommunicationTree('physical')">
                        üö™ Physical Breach
                    </button>
                    <button class="incident-type-btn" onclick="showCommunicationTree('phishing')">
                        üé£ Phishing Success
                    </button>
                </div>

                <div id="communicationTreeContainer">
                    <!-- Communication trees will be populated here -->
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    üìã General Communication Guidelines
                </div>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                    <div style="background: var(--dark-bg); padding: 20px; border-radius: 8px; border-left: 4px solid var(--gold-accent);">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">Internal Stakeholders</h4>
                        <ul style="color: var(--text-secondary); line-height: 1.8;">
                            <li>Immediate supervisor</li>
                            <li>IT Security team</li>
                            <li>IT Management</li>
                            <li>Affected department heads</li>
                            <li>Executive leadership (for major incidents)</li>
                            <li>Legal department</li>
                            <li>HR (for insider threats)</li>
                        </ul>
                    </div>
                    <div style="background: var(--dark-bg); padding: 20px; border-radius: 8px; border-left: 4px solid var(--gold-accent);">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">External Parties</h4>
                        <ul style="color: var(--text-secondary); line-height: 1.8;">
                            <li>Law enforcement (for crimes)</li>
                            <li>Regulatory bodies (compliance)</li>
                            <li>Affected customers/partners</li>
                            <li>Cyber insurance provider</li>
                            <li>External forensics consultants</li>
                            <li>Public relations (media)</li>
                            <li>Credit monitoring services</li>
                        </ul>
                    </div>
                    <div style="background: var(--dark-bg); padding: 20px; border-radius: 8px; border-left: 4px solid var(--gold-accent);">
                        <h4 style="color: var(--gold-accent); margin-bottom: 10px;">Communication Tips</h4>
                        <ul style="color: var(--text-secondary); line-height: 1.8;">
                            <li>Use secure channels only</li>
                            <li>Don't use compromised systems</li>
                            <li>Stick to facts, avoid speculation</li>
                            <li>Document all communications</li>
                            <li>Follow template procedures</li>
                            <li>Maintain confidentiality</li>
                            <li>Update stakeholders regularly</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <!-- TAB 5: QUIZ -->
        <div id="quiz" class="content-section">
            <div class="quiz-container">
                <div class="quiz-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="quizProgress" style="width: 0%;">
                            <span id="quizProgressText">0%</span>
                        </div>
                    </div>
                </div>

                <div id="quizContent">
                    <!-- Quiz questions will be populated here -->
                </div>

                <div id="quizResults" class="quiz-results hidden">
                    <h2 style="color: var(--gold-accent);">Quiz Complete!</h2>
                    <div class="results-score" id="finalScore">0%</div>
                    <div class="results-message" id="resultsMessage"></div>
                    <div class="results-feedback" id="resultsFeedback"></div>
                    <button class="btn" onclick="resetQuiz()" style="margin-top: 20px;">üîÑ Retake Quiz</button>
                </div>

                <div id="quizControls" class="scenario-controls">
                    <button class="btn btn-secondary" onclick="previousQuestion()" id="prevBtn" disabled>
                        ‚Üê Previous
                    </button>
                    <button class="btn" onclick="nextQuestion()" id="nextBtn">
                        Next ‚Üí
                    </button>
                    <button class="btn" onclick="submitQuiz()" id="submitBtn" style="display: none;">
                        ‚úì Submit Quiz
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== GLOBAL STATE MANAGEMENT =====
        let currentTab = 'process';
        let currentScenario = 0;
        let currentQuestion = 0;
        let quizAnswers = [];
        let evidenceCollectedItems = new Set();

        // ===== TAB SWITCHING =====
        function switchTab(tabName) {
            // Hide all content sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected content section
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked tab button
            event.target.closest('.tab-btn').classList.add('active');

            currentTab = tabName;

            // Initialize tab-specific content
            if (tabName === 'scenarios' && currentScenario === 0) {
                loadScenario(0);
            } else if (tabName === 'evidence' && evidenceCollectedItems.size === 0) {
                initializeEvidence();
            } else if (tabName === 'quiz' && quizAnswers.length === 0) {
                initializeQuiz();
            }
        }

        // ===== SCENARIO SIMULATOR DATA =====
        const scenarios = [
            {
                type: 'Malware Infection',
                title: 'Workstation Acting Suspicious',
                description: 'An employee reports that their computer is running extremely slow, showing frequent pop-ups, and their antivirus has been disabled. You arrive at their desk and observe the symptoms.',
                steps: [
                    {
                        question: 'What is your FIRST action as a first responder?',
                        options: [
                            'Immediately turn off the computer to stop the malware',
                            'Disconnect the network cable to isolate the system',
                            'Run a full antivirus scan',
                            'Tell the user to continue working while you investigate'
                        ],
                        correct: 1,
                        explanation: 'Disconnecting the network cable isolates the system and prevents malware from spreading while preserving volatile evidence in RAM. Turning off the computer destroys volatile evidence and should only be done as a last resort or if instructed by security team.'
                    },
                    {
                        question: 'What should you document IMMEDIATELY?',
                        options: [
                            'Only the user\'s name and department',
                            'Current time, running processes, open network connections, and visible symptoms',
                            'Wait until the incident is resolved to document',
                            'Just take a photo of the screen'
                        ],
                        correct: 1,
                        explanation: 'Comprehensive documentation should begin immediately: timestamp, running processes (Task Manager), network connections (netstat), physical observations, and user statements. Evidence can change quickly, so document the current state before it\'s altered.'
                    },
                    {
                        question: 'Who should you notify about this incident?',
                        options: [
                            'Only your immediate supervisor',
                            'The IT Security team and your supervisor',
                            'No one until you fix the problem',
                            'The CEO immediately'
                        ],
                        correct: 1,
                        explanation: 'You should notify both your immediate supervisor and the IT Security team. They will determine if additional escalation is needed. Never try to handle security incidents alone without reporting them.'
                    }
                ]
            },
            {
                type: 'Data Breach',
                title: 'Unauthorized Database Access Detected',
                description: 'Your SIEM alerts indicate someone accessed the customer database from an unusual IP address at 2:00 AM. The access used valid credentials but from a foreign country. 15,000 customer records containing names, addresses, and credit card data may have been accessed.',
                steps: [
                    {
                        question: 'What is the FIRST step in the incident response process?',
                        options: [
                            'Immediately delete the user account',
                            'Verify this is a genuine incident and not a false positive',
                            'Call all 15,000 customers',
                            'Post about it on social media'
                        ],
                        correct: 1,
                        explanation: 'During the Identification phase, you must verify the incident is genuine. Check if the user was traveling, using a VPN, or if the alert is a false positive. However, given the sensitive data involved, err on the side of caution.'
                    },
                    {
                        question: 'This incident involves customer credit card data. What is a critical requirement?',
                        options: [
                            'No special requirements apply',
                            'Must notify payment card brands and may need to notify affected customers per PCI-DSS',
                            'Only notify customers if we feel like it',
                            'Delete all evidence immediately'
                        ],
                        correct: 1,
                        explanation: 'Data breaches involving payment card data fall under PCI-DSS compliance requirements. You must notify your payment processor, potentially the card brands, and may need to offer credit monitoring. Legal and compliance teams must be involved immediately.'
                    },
                    {
                        question: 'What containment action should be taken?',
                        options: [
                            'Do nothing and monitor',
                            'Disable the compromised account, force password reset for all admin accounts, review all recent database access',
                            'Just change the database password',
                            'Delete the database'
                        ],
                        correct: 1,
                        explanation: 'Comprehensive containment is needed: disable the specific compromised account, force password resets for all privileged accounts, review audit logs for other suspicious access, and potentially restrict database access to specific IP ranges while investigating.'
                    }
                ]
            },
            {
                type: 'Ransomware Attack',
                title: 'Files Encrypted with Ransom Demand',
                description: 'Multiple users report they cannot open their files. When they try, they see a message demanding 5 Bitcoin to decrypt their files. The ransom note says they have 48 hours. File extensions have been changed to .locked.',
                steps: [
                    {
                        question: 'What is your IMMEDIATE containment action?',
                        options: [
                            'Pay the ransom immediately',
                            'Isolate all affected systems from the network, shut down network shares, alert all users to disconnect',
                            'Restart all computers',
                            'Do nothing and hope it goes away'
                        ],
                        correct: 1,
                        explanation: 'Ransomware spreads rapidly across networks and shared drives. Immediate isolation is critical: disconnect affected systems, shut down file shares, alert all users to disconnect, and segment the network if possible. Speed is essential to limit damage.'
                    },
                    {
                        question: 'Should you pay the ransom?',
                        options: [
                            'Yes, always pay to get files back',
                            'No - never pay. It funds criminals, no guarantee of decryption, and you become a target',
                            'Pay half and negotiate',
                            'Wait until the last minute then pay'
                        ],
                        correct: 1,
                        explanation: 'Security professionals and law enforcement universally recommend NOT paying ransoms. Payment funds criminal operations, there\'s no guarantee you\'ll receive a decryption key, and it marks your organization as willing to pay. Focus on restoration from backups.'
                    },
                    {
                        question: 'What is the recovery strategy?',
                        options: [
                            'Give up and start over with new computers',
                            'Restore from clean, verified backups after ensuring the ransomware is eradicated',
                            'Try to decrypt files yourself with random tools',
                            'Pay the ransom'
                        ],
                        correct: 1,
                        explanation: 'Proper recovery involves: identifying and removing the ransomware (and any backdoors), patching the vulnerability exploited, verifying backups are clean, then restoring from backups. Test restoration on isolated systems first. This is why regular, tested backups are critical.'
                    }
                ]
            },
            {
                type: 'Phishing Attack',
                title: 'Employee Clicked Malicious Link',
                description: 'An employee reports they received an email appearing to be from the CEO requesting they urgently verify their Office 365 credentials. They clicked the link and entered their username and password before realizing it looked suspicious.',
                steps: [
                    {
                        question: 'What is your FIRST action?',
                        options: [
                            'Tell the employee they\'re fired',
                            'Immediately reset the employee\'s password and revoke all active sessions',
                            'Wait to see if anything happens',
                            'Ignore it since it\'s the employee\'s fault'
                        ],
                        correct: 1,
                        explanation: 'Immediately reset the compromised credentials and revoke all active sessions. The attacker may already be accessing the account. Time is critical - assume the account is compromised and act accordingly.'
                    },
                    {
                        question: 'What additional investigation is needed?',
                        options: [
                            'Nothing else to do',
                            'Review login history, check for email forwarding rules, review sent items, check for OAuth grants to suspicious apps',
                            'Just change the password',
                            'Disable the employee\'s email'
                        ],
                        correct: 1,
                        explanation: 'Attackers often set up email forwarding rules, OAuth access, or send phishing emails to contacts. Check: recent login locations/IPs, mailbox rules, sent items, OAuth applications granted access, and multi-factor authentication status. Look for persistence mechanisms.'
                    },
                    {
                        question: 'What preventive measure should follow this incident?',
                        options: [
                            'No prevention needed',
                            'Security awareness training, implement email filtering improvements, enable MFA if not already',
                            'Block all emails',
                            'Disable internet access'
                        ],
                        correct: 1,
                        explanation: 'Use this as a learning opportunity: conduct targeted security awareness training, review email security controls (SPF, DKIM, DMARC), implement or improve email filtering, and ensure multi-factor authentication (MFA) is enabled for all accounts to prevent credential theft.'
                    }
                ]
            },
            {
                type: 'Physical Security Breach',
                title: 'Unauthorized Access to Server Room',
                description: 'Security cameras show an unknown person entered the server room at 11:30 PM on Saturday using a tailgating technique (followed an employee). They were inside for 8 minutes. The employee who let them in didn\'t think anything was wrong.',
                steps: [
                    {
                        question: 'What evidence should you collect FIRST?',
                        options: [
                            'Nothing, it\'s probably fine',
                            'Security camera footage, access logs, interview the employee, inspect servers for tampering',
                            'Just the camera footage',
                            'Wait a few days to see what happens'
                        ],
                        correct: 1,
                        explanation: 'Collect all available evidence immediately: save camera footage (before it\'s overwritten), export access control logs, interview the employee who was followed, and physically inspect all servers for signs of tampering, new devices, or USB drives.'
                    },
                    {
                        question: 'What should you check on the physical servers?',
                        options: [
                            'Nothing to check',
                            'USB ports for unknown devices, network ports for rogue devices, server cases for tampering, BIOS settings',
                            'Just reboot them',
                            'Only check if something breaks'
                        ],
                        correct: 1,
                        explanation: 'Physical access allows many attacks: hardware keyloggers, USB implants, network taps, BIOS malware, or data exfiltration. Check USB ports, inspect network connections, look for tampering with server cases, verify BIOS/UEFI settings, and check for bootkit infections.'
                    },
                    {
                        question: 'What is the appropriate response regarding the employee?',
                        options: [
                            'Immediately fire them',
                            'Document the incident, retrain on security awareness and tailgating prevention, no access if not needed',
                            'Do nothing',
                            'Give them a promotion'
                        ],
                        correct: 1,
                        explanation: 'This is typically a training issue, not malicious. Document the incident, provide security awareness training on tailgating and social engineering, and review whether they need server room access. Use this to improve procedures and training for all staff.'
                    }
                ]
            }
        ];

        // ===== SCENARIO SIMULATOR FUNCTIONS =====
        let currentStep = 0;
        let scenarioAnswers = [];

        function loadScenario(index) {
            currentScenario = index;
            currentStep = 0;
            scenarioAnswers = [];

            const scenario = scenarios[currentScenario];
            document.getElementById('scenarioType').textContent = scenario.type;
            document.getElementById('scenarioTitle').textContent = scenario.title;
            document.getElementById('scenarioDescription').textContent = scenario.description;
            document.getElementById('scenarioFeedback').innerHTML = '';

            loadStep();
        }

        function loadStep() {
            const scenario = scenarios[currentScenario];
            const step = scenario.steps[currentStep];

            let html = `
                <div class="scenario-choices">
                    <h3 style="color: var(--gold-accent); margin-bottom: 15px;">Step ${currentStep + 1} of ${scenario.steps.length}</h3>
                    <p style="font-size: 1.1em; margin-bottom: 20px;">${step.question}</p>
            `;

            step.options.forEach((option, index) => {
                html += `
                    <button class="choice-btn" onclick="selectAnswer(${index})">
                        ${String.fromCharCode(65 + index)}. ${option}
                    </button>
                `;
            });

            html += `</div>`;
            document.getElementById('scenarioContent').innerHTML = html;
        }

        function selectAnswer(selectedIndex) {
            const scenario = scenarios[currentScenario];
            const step = scenario.steps[currentStep];
            const isCorrect = selectedIndex === step.correct;

            // Disable all choice buttons
            const buttons = document.querySelectorAll('.choice-btn');
            buttons.forEach((btn, index) => {
                btn.disabled = true;
                if (index === step.correct) {
                    btn.classList.add('correct');
                } else if (index === selectedIndex && !isCorrect) {
                    btn.classList.add('incorrect');
                }
            });

            // Show feedback
            const feedbackHtml = `
                <div class="feedback ${isCorrect ? 'correct' : 'incorrect'}">
                    <div class="feedback-title">
                        ${isCorrect ? '‚úì Correct!' : '‚úó Incorrect'}
                    </div>
                    <p>${step.explanation}</p>
                    ${currentStep < scenario.steps.length - 1 ?
                        '<button class="btn" onclick="nextStep()" style="margin-top: 15px;">Continue to Next Step ‚Üí</button>' :
                        '<button class="btn" onclick="completeScenario()" style="margin-top: 15px;">Complete Scenario ‚úì</button>'
                    }
                </div>
            `;
            document.getElementById('scenarioFeedback').innerHTML = feedbackHtml;

            // Record answer
            scenarioAnswers.push({
                step: currentStep,
                selected: selectedIndex,
                correct: isCorrect
            });
        }

        function nextStep() {
            currentStep++;
            document.getElementById('scenarioFeedback').innerHTML = '';
            loadStep();
        }

        function completeScenario() {
            const correctAnswers = scenarioAnswers.filter(a => a.correct).length;
            const totalSteps = scenarios[currentScenario].steps.length;
            const percentage = Math.round((correctAnswers / totalSteps) * 100);

            let message = '';
            if (percentage === 100) {
                message = 'Perfect! You handled this incident flawlessly. You understand proper incident response procedures.';
            } else if (percentage >= 70) {
                message = 'Good job! You made mostly correct decisions. Review the areas you missed for improvement.';
            } else {
                message = 'You need more practice. Review the incident response process and try again.';
            }

            const feedbackHtml = `
                <div class="feedback correct">
                    <div class="feedback-title">Scenario Complete!</div>
                    <p style="font-size: 1.2em; margin: 15px 0;">Score: ${correctAnswers}/${totalSteps} (${percentage}%)</p>
                    <p>${message}</p>
                    <div style="margin-top: 20px;">
                        <button class="btn" onclick="nextScenario()" style="margin-right: 10px;">Next Scenario ‚Üí</button>
                        <button class="btn btn-secondary" onclick="resetScenario()">Retry This Scenario</button>
                    </div>
                </div>
            `;
            document.getElementById('scenarioFeedback').innerHTML = feedbackHtml;
            document.getElementById('scenarioContent').innerHTML = '';
        }

        function resetScenario() {
            loadScenario(currentScenario);
        }

        function nextScenario() {
            const nextIndex = (currentScenario + 1) % scenarios.length;
            loadScenario(nextIndex);
        }

        function previousScenario() {
            const prevIndex = currentScenario === 0 ? scenarios.length - 1 : currentScenario - 1;
            loadScenario(prevIndex);
        }

        // ===== EVIDENCE COLLECTION DATA & FUNCTIONS =====
        const evidenceItems = [
            {
                icon: 'üíæ',
                title: 'RAM Dump',
                description: 'Capture volatile memory contents before shutdown',
                critical: true
            },
            {
                icon: 'üì∏',
                title: 'Screen Photo',
                description: 'Photograph the current screen display and error messages',
                critical: true
            },
            {
                icon: 'üåê',
                title: 'Network Connections',
                description: 'Document active network connections using netstat',
                critical: true
            },
            {
                icon: '‚öôÔ∏è',
                title: 'Running Processes',
                description: 'List all running processes and their details',
                critical: true
            },
            {
                icon: 'üìã',
                title: 'Event Logs',
                description: 'Export Windows Security, System, and Application logs',
                critical: true
            },
            {
                icon: 'üïê',
                title: 'System Time',
                description: 'Document current system time and timezone',
                critical: true
            },
            {
                icon: 'üíø',
                title: 'Disk Image',
                description: 'Create forensic image of hard drive using write blocker',
                critical: true
            },
            {
                icon: 'üë§',
                title: 'User Statement',
                description: 'Interview and document what the user observed',
                critical: true
            },
            {
                icon: 'üì°',
                title: 'Network Packets',
                description: 'Capture network traffic for analysis',
                critical: false
            },
            {
                icon: 'üîå',
                title: 'Physical Connections',
                description: 'Photograph all cable connections and hardware',
                critical: false
            },
            {
                icon: 'üìä',
                title: 'Browser History',
                description: 'Export browser history and downloads',
                critical: true
            },
            {
                icon: 'üîê',
                title: 'Login History',
                description: 'Document recent login attempts and sessions',
                critical: true
            },
            {
                icon: 'üìÅ',
                title: 'Recent Files',
                description: 'List recently accessed and modified files',
                critical: false
            },
            {
                icon: 'üñ•Ô∏è',
                title: 'System Config',
                description: 'Export system configuration and settings',
                critical: false
            },
            {
                icon: 'üìù',
                title: 'Registry Hives',
                description: 'Export relevant Windows Registry hives',
                critical: false
            }
        ];

        function initializeEvidence() {
            const grid = document.getElementById('evidenceGrid');
            grid.innerHTML = '';
            evidenceCollectedItems.clear();

            evidenceItems.forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'evidence-item';
                div.onclick = () => toggleEvidence(index);
                div.innerHTML = `
                    <div class="evidence-icon">${item.icon}</div>
                    <div class="evidence-title">${item.title}</div>
                    <div class="evidence-description">${item.description}</div>
                `;
                grid.appendChild(div);
            });

            document.getElementById('evidenceTotal').textContent = evidenceItems.length;
            updateEvidenceScore();
        }

        function toggleEvidence(index) {
            const items = document.querySelectorAll('.evidence-item');
            if (evidenceCollectedItems.has(index)) {
                evidenceCollectedItems.delete(index);
                items[index].classList.remove('collected');
            } else {
                evidenceCollectedItems.add(index);
                items[index].classList.add('collected');
            }
            updateEvidenceScore();
        }

        function updateEvidenceScore() {
            const collected = evidenceCollectedItems.size;
            const total = evidenceItems.length;
            const percentage = Math.round((collected / total) * 100);

            document.getElementById('evidenceScore').textContent = percentage;
            document.getElementById('evidenceCollected').textContent = collected;
        }

        function resetEvidence() {
            initializeEvidence();
        }

        // ===== COMMUNICATION TREE DATA & FUNCTIONS =====
        const communicationTrees = {
            malware: [
                {
                    priority: 'IMMEDIATE',
                    title: 'Immediate Supervisor',
                    info: 'Report the incident within 15 minutes of discovery',
                    when: 'Immediately upon discovering the malware infection'
                },
                {
                    priority: 'IMMEDIATE',
                    title: 'IT Security Team',
                    info: 'Contact the incident response team or security operations center',
                    when: 'Within 15 minutes - they will guide containment and investigation'
                },
                {
                    priority: 'HIGH',
                    title: 'IT Management',
                    info: 'Notify IT Director or CIO if multiple systems are affected',
                    when: 'Within 1 hour if incident is widespread or severe'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Affected Department Managers',
                    info: 'Inform managers of affected users about disruption and timeline',
                    when: 'After containment plan is in place'
                },
                {
                    priority: 'LOW',
                    title: 'All Users (if widespread)',
                    info: 'Send company-wide alert about threat and preventive actions',
                    when: 'Only if malware is spreading or company-wide threat exists'
                }
            ],
            breach: [
                {
                    priority: 'CRITICAL',
                    title: 'IT Security Team & CISO',
                    info: 'Immediate notification to Chief Information Security Officer',
                    when: 'Within 15 minutes of identifying potential data breach'
                },
                {
                    priority: 'CRITICAL',
                    title: 'Legal Department',
                    info: 'Legal counsel must be involved for regulatory compliance and liability',
                    when: 'Within 30 minutes - they determine notification obligations'
                },
                {
                    priority: 'CRITICAL',
                    title: 'Executive Leadership (CEO/Board)',
                    info: 'CEO and potentially Board of Directors must be informed',
                    when: 'Within 1 hour for significant breaches'
                },
                {
                    priority: 'HIGH',
                    title: 'Compliance/Privacy Officer',
                    info: 'Determine if breach triggers GDPR, CCPA, HIPAA, or other regulations',
                    when: 'Within 1 hour to start compliance clock'
                },
                {
                    priority: 'HIGH',
                    title: 'Public Relations',
                    info: 'Prepare communications strategy and media response',
                    when: 'Before any public disclosure'
                },
                {
                    priority: 'HIGH',
                    title: 'Regulatory Bodies',
                    info: 'Report to relevant authorities (e.g., HHS for HIPAA, FTC, State AG)',
                    when: 'As required by law (GDPR: 72 hours, HIPAA: 60 days)'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Affected Individuals',
                    info: 'Notify individuals whose data was compromised',
                    when: 'As required by law and after approval from legal'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Cyber Insurance Provider',
                    info: 'Contact insurance company to initiate claim',
                    when: 'Within timeframe specified in policy (often 24-48 hours)'
                }
            ],
            ransomware: [
                {
                    priority: 'CRITICAL',
                    title: 'IT Security Team',
                    info: 'Immediate escalation to security operations center',
                    when: 'Immediately - every second counts to prevent spread'
                },
                {
                    priority: 'CRITICAL',
                    title: 'IT Management & Executive Leadership',
                    info: 'CEO, CIO, and executive team must be notified',
                    when: 'Within 15 minutes - business-critical decision making needed'
                },
                {
                    priority: 'HIGH',
                    title: 'All Staff',
                    info: 'Company-wide alert to disconnect from network immediately',
                    when: 'Within 30 minutes to prevent further spread'
                },
                {
                    priority: 'HIGH',
                    title: 'Legal Department',
                    info: 'Legal counsel for ransom payment decision and potential reporting',
                    when: 'Within 1 hour'
                },
                {
                    priority: 'HIGH',
                    title: 'Law Enforcement (FBI)',
                    info: 'FBI Internet Crime Complaint Center (IC3) should be notified',
                    when: 'Within 24 hours (FBI asks for reporting, provides decryption assistance)'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Cyber Insurance',
                    info: 'Notify insurance provider immediately',
                    when: 'Within policy timeframe for ransomware coverage'
                },
                {
                    priority: 'MEDIUM',
                    title: 'External Forensics/IR Firm',
                    info: 'Engage specialized ransomware response team if needed',
                    when: 'As soon as determined that internal capabilities are insufficient'
                }
            ],
            unauthorized: [
                {
                    priority: 'IMMEDIATE',
                    title: 'IT Security Team',
                    info: 'Contact security operations center or incident response team',
                    when: 'Within 15 minutes of detecting unauthorized access'
                },
                {
                    priority: 'IMMEDIATE',
                    title: 'Immediate Supervisor',
                    info: 'Report to your direct supervisor',
                    when: 'Immediately'
                },
                {
                    priority: 'HIGH',
                    title: 'IT Management',
                    info: 'Notify IT Director or CIO',
                    when: 'Within 30 minutes'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Human Resources',
                    info: 'If insider threat or employee involvement suspected',
                    when: 'After initial investigation if employee involvement suspected'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Legal Department',
                    info: 'If sensitive data may have been accessed',
                    when: 'Within 1-2 hours if data breach potential exists'
                },
                {
                    priority: 'LOW',
                    title: 'Law Enforcement',
                    info: 'If criminal activity is confirmed',
                    when: 'After consulting with legal department'
                }
            ],
            physical: [
                {
                    priority: 'IMMEDIATE',
                    title: 'Physical Security Team',
                    info: 'Alert security guards and physical security department',
                    when: 'Immediately if breach is in progress'
                },
                {
                    priority: 'IMMEDIATE',
                    title: 'IT Security Team',
                    info: 'Notify IT security to check for technical compromise',
                    when: 'Within 15 minutes'
                },
                {
                    priority: 'HIGH',
                    title: 'Immediate Supervisor',
                    info: 'Report to your supervisor',
                    when: 'Within 30 minutes'
                },
                {
                    priority: 'HIGH',
                    title: 'Facilities Management',
                    info: 'Notify facilities to secure the area',
                    when: 'Within 30 minutes'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Law Enforcement',
                    info: 'Contact local police if theft or trespassing occurred',
                    when: 'After securing the area if criminal activity suspected'
                },
                {
                    priority: 'MEDIUM',
                    title: 'HR Department',
                    info: 'If employee policy violation or insider involvement',
                    when: 'After initial investigation'
                }
            ],
            phishing: [
                {
                    priority: 'IMMEDIATE',
                    title: 'IT Security Team',
                    info: 'Report to security team for credential reset and investigation',
                    when: 'Immediately after user reports clicking the link'
                },
                {
                    priority: 'HIGH',
                    title: 'Immediate Supervisor',
                    info: 'Inform your supervisor of the incident',
                    when: 'Within 30 minutes'
                },
                {
                    priority: 'MEDIUM',
                    title: 'Email Administrator',
                    info: 'Check for email forwarding rules and suspicious activity',
                    when: 'Within 1 hour'
                },
                {
                    priority: 'MEDIUM',
                    title: 'All Users (Warning)',
                    info: 'Send company-wide phishing alert if campaign is ongoing',
                    when: 'If multiple users targeted or widespread campaign detected'
                },
                {
                    priority: 'LOW',
                    title: 'Security Awareness Training Team',
                    info: 'Schedule additional training for affected employee and others',
                    when: 'After incident is resolved'
                }
            ]
        };

        function showCommunicationTree(type) {
            // Update button states
            document.querySelectorAll('.incident-type-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.classList.add('selected');

            // Hide all trees
            document.querySelectorAll('.contact-chain').forEach(tree => {
                tree.classList.remove('active');
            });

            // Show or create the selected tree
            const container = document.getElementById('communicationTreeContainer');
            let tree = document.getElementById(`tree-${type}`);

            if (!tree) {
                tree = document.createElement('div');
                tree.id = `tree-${type}`;
                tree.className = 'contact-chain';

                const contacts = communicationTrees[type];
                contacts.forEach(contact => {
                    const contactHtml = `
                        <div class="contact-level">
                            <div class="contact-card">
                                <span class="contact-priority">${contact.priority}</span>
                                <div class="contact-title">${contact.title}</div>
                                <div class="contact-info">${contact.info}</div>
                                <div class="contact-when"><strong>When:</strong> ${contact.when}</div>
                            </div>
                        </div>
                    `;
                    tree.innerHTML += contactHtml;
                });

                container.appendChild(tree);
            }

            tree.classList.add('active');
        }

        // ===== QUIZ DATA & FUNCTIONS =====
        const quizQuestions = [
            {
                question: 'What is the correct order of the incident response process?',
                options: [
                    'Preparation ‚Üí Identification ‚Üí Eradication ‚Üí Containment ‚Üí Recovery ‚Üí Lessons Learned',
                    'Identification ‚Üí Preparation ‚Üí Containment ‚Üí Eradication ‚Üí Recovery ‚Üí Lessons Learned',
                    'Preparation ‚Üí Identification ‚Üí Containment ‚Üí Eradication ‚Üí Recovery ‚Üí Lessons Learned',
                    'Containment ‚Üí Identification ‚Üí Preparation ‚Üí Eradication ‚Üí Recovery ‚Üí Lessons Learned'
                ],
                correct: 2,
                explanation: 'The correct order is: Preparation ‚Üí Identification ‚Üí Containment ‚Üí Eradication ‚Üí Recovery ‚Üí Lessons Learned. This is a critical exam concept for CompTIA A+ Core 2.'
            },
            {
                question: 'You discover a computer potentially compromised by malware. What is the FIRST action you should take as a first responder?',
                options: [
                    'Turn off the computer immediately',
                    'Run an antivirus scan',
                    'Disconnect the network cable to isolate the system',
                    'Reboot the computer'
                ],
                correct: 2,
                explanation: 'Disconnecting the network cable isolates the system to prevent malware spread while preserving volatile evidence in RAM. Turning off the computer should be a last resort as it destroys volatile evidence.'
            },
            {
                question: 'What does "chain of custody" refer to in incident response?',
                options: [
                    'The order in which executives are notified',
                    'The documented process of evidence handling showing who collected it, when, and how it was transferred',
                    'The hierarchy of the incident response team',
                    'The sequence of security controls'
                ],
                correct: 1,
                explanation: 'Chain of custody is the documented trail showing who collected evidence, when it was collected, how it was handled, and who had access to it. This documentation is critical for legal proceedings and maintains evidence integrity.'
            },
            {
                question: 'A data breach has occurred involving customer credit card information. Which regulation likely applies requiring notification?',
                options: [
                    'OSHA',
                    'PCI-DSS',
                    'ADA',
                    'SOX'
                ],
                correct: 1,
                explanation: 'PCI-DSS (Payment Card Industry Data Security Standard) governs the handling of credit card information. Breaches must be reported to payment card brands and may require customer notification. GDPR, CCPA, or state laws may also apply.'
            },
            {
                question: 'During evidence collection, what is the "order of volatility" principle?',
                options: [
                    'Collect evidence in alphabetical order',
                    'Collect the most expensive equipment first',
                    'Collect evidence from most volatile (lost when power off) to least volatile',
                    'Collect evidence from newest to oldest files'
                ],
                correct: 2,
                explanation: 'Order of volatility means collecting evidence that can be easily lost first: CPU registers/cache ‚Üí RAM ‚Üí swap files ‚Üí hard disk ‚Üí logs ‚Üí backups. Volatile evidence is lost when power is removed.'
            },
            {
                question: 'You receive a ransomware attack demanding payment in Bitcoin. What is the recommended response?',
                options: [
                    'Pay the ransom immediately to get files back quickly',
                    'Negotiate for a lower ransom payment',
                    'Do not pay the ransom; isolate systems and restore from backups',
                    'Wait until the last minute then pay'
                ],
                correct: 2,
                explanation: 'Security professionals and law enforcement recommend NOT paying ransoms. Payment funds criminals, provides no guarantee of decryption, and marks you as a target. Focus on containment, eradication, and restoration from clean backups.'
            },
            {
                question: 'An employee reports clicking on a phishing link and entering their credentials. What is your FIRST action?',
                options: [
                    'Tell them not to worry about it',
                    'Immediately reset their password and revoke active sessions',
                    'Wait to see if anything happens',
                    'File a report and do nothing else'
                ],
                correct: 1,
                explanation: 'Immediately reset the compromised credentials and revoke all active sessions. Assume the account is compromised and the attacker may already be accessing it. Time is critical to prevent further damage.'
            },
            {
                question: 'What should you do if you discover evidence on a compromised system?',
                options: [
                    'Immediately start deleting suspicious files',
                    'Turn off the system to preserve it',
                    'Document and photograph the evidence without altering the system state',
                    'Copy files to a USB drive for analysis'
                ],
                correct: 2,
                explanation: 'As a first responder, document and photograph evidence without altering the system. Take photos, document running processes and network connections, but minimize interaction. Let forensics experts handle detailed evidence collection.'
            },
            {
                question: 'During the Containment phase of incident response, what is the primary goal?',
                options: [
                    'Remove all traces of the attacker',
                    'Return systems to normal operation',
                    'Limit damage and prevent the incident from spreading',
                    'Document lessons learned'
                ],
                correct: 2,
                explanation: 'Containment focuses on limiting damage and preventing the incident from spreading to other systems. This includes isolating affected systems, disabling compromised accounts, and blocking malicious network traffic while preserving evidence.'
            },
            {
                question: 'Why is the "Lessons Learned" phase important in incident response?',
                options: [
                    'It is not important and can be skipped',
                    'It helps identify what went wrong and improve future response and prevention',
                    'It is only for assigning blame to employees',
                    'It is required by law'
                ],
                correct: 1,
                explanation: 'The Lessons Learned phase is critical for continuous improvement. It documents what happened, what worked well, what didn\'t, and identifies changes to policies, procedures, and controls to prevent future incidents and improve response.'
            }
        ];

        function initializeQuiz() {
            currentQuestion = 0;
            quizAnswers = new Array(quizQuestions.length).fill(null);
            displayQuestion();
            updateQuizProgress();
        }

        function displayQuestion() {
            const q = quizQuestions[currentQuestion];
            let html = `
                <div class="quiz-question">
                    <div class="question-number">Question ${currentQuestion + 1} of ${quizQuestions.length}</div>
                    <div class="question-text">${q.question}</div>
                    <div class="quiz-options">
            `;

            q.options.forEach((option, index) => {
                const isSelected = quizAnswers[currentQuestion] !== null && quizAnswers[currentQuestion].selected === index;
                const isAnswered = quizAnswers[currentQuestion] !== null;
                const isCorrect = index === q.correct;
                const isSelectedWrong = isAnswered && isSelected && !isCorrect;

                let btnClass = 'option-btn';
                if (isAnswered) {
                    if (isCorrect) btnClass += ' correct';
                    if (isSelectedWrong) btnClass += ' incorrect';
                } else if (isSelected) {
                    btnClass += ' selected';
                }

                html += `
                    <button class="${btnClass}"
                            onclick="selectQuizAnswer(${index})"
                            ${isAnswered ? 'disabled' : ''}>
                        ${String.fromCharCode(65 + index)}. ${option}
                    </button>
                `;
            });

            html += '</div>';

            if (quizAnswers[currentQuestion] !== null) {
                const answer = quizAnswers[currentQuestion];
                html += `
                    <div class="feedback ${answer.correct ? 'correct' : 'incorrect'}">
                        <div class="feedback-title">${answer.correct ? '‚úì Correct!' : '‚úó Incorrect'}</div>
                        <p>${q.explanation}</p>
                    </div>
                `;
            }

            html += '</div>';

            document.getElementById('quizContent').innerHTML = html;

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').style.display = currentQuestion < quizQuestions.length - 1 ? 'inline-flex' : 'none';
            document.getElementById('submitBtn').style.display = currentQuestion === quizQuestions.length - 1 && quizAnswers.every(a => a !== null) ? 'inline-flex' : 'none';
        }

        function selectQuizAnswer(selectedIndex) {
            if (quizAnswers[currentQuestion] !== null) return; // Already answered

            const q = quizQuestions[currentQuestion];
            const isCorrect = selectedIndex === q.correct;

            quizAnswers[currentQuestion] = {
                selected: selectedIndex,
                correct: isCorrect
            };

            displayQuestion();
            updateQuizProgress();
        }

        function updateQuizProgress() {
            const answered = quizAnswers.filter(a => a !== null).length;
            const total = quizQuestions.length;
            const percentage = Math.round((answered / total) * 100);

            document.getElementById('quizProgress').style.width = percentage + '%';
            document.getElementById('quizProgressText').textContent = percentage + '%';
        }

        function previousQuestion() {
            if (currentQuestion > 0) {
                currentQuestion--;
                displayQuestion();
            }
        }

        function nextQuestion() {
            if (currentQuestion < quizQuestions.length - 1) {
                currentQuestion++;
                displayQuestion();
            }
        }

        function submitQuiz() {
            const correctAnswers = quizAnswers.filter(a => a && a.correct).length;
            const total = quizQuestions.length;
            const percentage = Math.round((correctAnswers / total) * 100);

            let message = '';
            let feedbackHtml = '<h3 style="color: var(--gold-accent); margin-bottom: 15px;">Performance Analysis:</h3>';

            if (percentage === 100) {
                message = 'Perfect Score! Outstanding! You have mastered incident response procedures.';
                feedbackHtml += '<p style="color: var(--success-green); font-size: 1.1em;">You correctly answered all questions. You have a strong understanding of incident response and are well-prepared for the CompTIA A+ Core 2 exam.</p>';
            } else if (percentage >= 80) {
                message = 'Excellent! You have a strong understanding of incident response.';
                feedbackHtml += '<p style="color: var(--success-green); font-size: 1.1em;">You performed very well. Review the questions you missed to achieve 100%.</p>';
            } else if (percentage >= 70) {
                message = 'Good job! You understand most concepts but need to review some areas.';
                feedbackHtml += '<p style="color: var(--gold-accent); font-size: 1.1em;">You have a solid foundation but should review the incident response process phases and first responder procedures.</p>';
            } else if (percentage >= 60) {
                message = 'You passed, but need more study for the A+ exam.';
                feedbackHtml += '<p style="color: var(--warning-orange); font-size: 1.1em;">Review the six phases of incident response, chain of custody, and first responder actions. Practice with more scenarios.</p>';
            } else {
                message = 'More study needed. Review the incident response process carefully.';
                feedbackHtml += '<p style="color: var(--error-red); font-size: 1.1em;">Spend more time studying the incident response process, evidence handling, and communication procedures. Go through all tabs in this simulator again.</p>';
            }

            // Add specific feedback on topics
            feedbackHtml += '<div style="margin-top: 20px; text-align: left;">';
            feedbackHtml += '<h4 style="color: var(--gold-accent);">Focus Areas for Improvement:</h4>';
            feedbackHtml += '<ul style="color: var(--text-secondary); line-height: 2;">';

            quizAnswers.forEach((answer, index) => {
                if (answer && !answer.correct) {
                    feedbackHtml += `<li>Question ${index + 1}: ${quizQuestions[index].question.substring(0, 60)}...</li>`;
                }
            });

            if (correctAnswers === total) {
                feedbackHtml += '<li>None! Perfect performance!</li>';
            }

            feedbackHtml += '</ul></div>';

            document.getElementById('finalScore').textContent = `${correctAnswers}/${total} (${percentage}%)`;
            document.getElementById('resultsMessage').textContent = message;
            document.getElementById('resultsFeedback').innerHTML = feedbackHtml;

            document.getElementById('quizContent').classList.add('hidden');
            document.getElementById('quizControls').classList.add('hidden');
            document.getElementById('quizResults').classList.remove('hidden');
        }

        function resetQuiz() {
            document.getElementById('quizResults').classList.add('hidden');
            document.getElementById('quizContent').classList.remove('hidden');
            document.getElementById('quizControls').classList.remove('hidden');
            initializeQuiz();
        }

        // ===== INITIALIZE ON PAGE LOAD =====
        window.addEventListener('load', () => {
            // Initialize first scenario
            loadScenario(0);
        });
    </script>
</body>
</html>