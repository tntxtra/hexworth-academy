<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPG Encryption Lab - House of Shield</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a0000 0%, #2d0a0a 50%, #1a0000 100%);
            color: #fca5a5;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 30px;
            background: rgba(127, 29, 29, 0.3);
            border-radius: 15px;
            border: 2px solid #dc2626;
            box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
        }

        h1 {
            color: #ef4444;
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
        }

        .subtitle {
            color: #fca5a5;
            font-size: 1.1em;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-button {
            padding: 12px 24px;
            background: rgba(127, 29, 29, 0.5);
            border: 2px solid #dc2626;
            color: #fca5a5;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab-button:hover {
            background: rgba(220, 38, 38, 0.5);
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.5);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: #dc2626;
            color: white;
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.7);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .panel {
            background: rgba(127, 29, 29, 0.2);
            border: 2px solid #dc2626;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .panel h2 {
            color: #ef4444;
            margin-bottom: 20px;
            font-size: 1.8em;
            text-shadow: 0 0 10px rgba(239, 68, 68, 0.3);
        }

        .panel h3 {
            color: #fca5a5;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.3em;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #fca5a5;
            font-weight: 600;
        }

        input[type="text"],
        input[type="email"],
        textarea,
        select {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.4);
            border: 2px solid #7f1d1d;
            border-radius: 8px;
            color: #fca5a5;
            font-size: 1em;
            font-family: 'Courier New', monospace;
            transition: all 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="email"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #dc2626;
            box-shadow: 0 0 15px rgba(220, 38, 38, 0.3);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        .button {
            padding: 12px 30px;
            background: linear-gradient(135deg, #dc2626 0%, #7f1d1d 100%);
            border: 2px solid #ef4444;
            color: white;
            cursor: pointer;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .button:hover {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
            transform: translateY(-2px);
        }

        .button:active {
            transform: translateY(0);
        }

        .key-display {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #7f1d1d;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            color: #fca5a5;
            max-height: 300px;
            overflow-y: auto;
            word-break: break-all;
        }

        .key-display::-webkit-scrollbar {
            width: 8px;
        }

        .key-display::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }

        .key-display::-webkit-scrollbar-thumb {
            background: #dc2626;
            border-radius: 4px;
        }

        .key-component {
            margin: 15px 0;
            padding: 15px;
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid #dc2626;
            border-radius: 4px;
        }

        .key-component-title {
            color: #ef4444;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .flow-diagram {
            display: flex;
            align-items: center;
            justify-content: space-around;
            margin: 30px 0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .flow-box {
            background: rgba(220, 38, 38, 0.2);
            border: 2px solid #dc2626;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            min-width: 150px;
            transition: all 0.3s ease;
        }

        .flow-box:hover {
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.5);
            transform: scale(1.05);
        }

        .flow-box-title {
            color: #ef4444;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .flow-arrow {
            color: #ef4444;
            font-size: 2em;
            font-weight: bold;
        }

        .person-card {
            background: rgba(220, 38, 38, 0.15);
            border: 2px solid #dc2626;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin: 15px;
            min-width: 200px;
        }

        .person-icon {
            font-size: 4em;
            margin-bottom: 10px;
        }

        .person-name {
            color: #ef4444;
            font-size: 1.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .key-exchange-container {
            display: flex;
            justify-content: space-around;
            align-items: center;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        .exchange-arrow {
            font-size: 3em;
            color: #ef4444;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .command-list {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 8px;
            padding: 20px;
            margin-top: 15px;
        }

        .command-item {
            margin: 15px 0;
            padding: 15px;
            background: rgba(127, 29, 29, 0.3);
            border-left: 4px solid #dc2626;
            border-radius: 4px;
        }

        .command-code {
            font-family: 'Courier New', monospace;
            color: #ef4444;
            font-weight: 700;
            font-size: 1.1em;
            margin-bottom: 8px;
            display: block;
        }

        .command-desc {
            color: #fca5a5;
            font-size: 0.95em;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-card {
            background: rgba(220, 38, 38, 0.15);
            border: 2px solid #dc2626;
            border-radius: 12px;
            padding: 20px;
        }

        .comparison-card h3 {
            color: #ef4444;
            margin-top: 0;
            margin-bottom: 15px;
            text-align: center;
            font-size: 1.5em;
        }

        .comparison-feature {
            padding: 10px;
            margin: 8px 0;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
        }

        .feature-label {
            color: #fca5a5;
            font-weight: 600;
            display: block;
            margin-bottom: 4px;
        }

        .feature-value {
            color: #ef4444;
            font-weight: 700;
        }

        .trust-diagram {
            margin: 30px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
        }

        .trust-level {
            margin: 20px 0;
            padding: 15px;
            background: rgba(220, 38, 38, 0.1);
            border-left: 4px solid #dc2626;
            border-radius: 4px;
        }

        .trust-level-title {
            color: #ef4444;
            font-weight: 700;
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            border-left: 4px solid #dc2626;
        }

        .alert-success {
            background: rgba(34, 197, 94, 0.2);
            border-left-color: #22c55e;
            color: #86efac;
        }

        .alert-warning {
            background: rgba(234, 179, 8, 0.2);
            border-left-color: #eab308;
            color: #fde047;
        }

        .alert-danger {
            background: rgba(220, 38, 38, 0.3);
            border-left-color: #dc2626;
            color: #fca5a5;
        }

        .signature-box {
            background: rgba(0, 0, 0, 0.5);
            border: 2px dashed #7f1d1d;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            color: #fca5a5;
            min-height: 80px;
        }

        .info-box {
            background: rgba(220, 38, 38, 0.15);
            border: 2px solid #7f1d1d;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #fca5a5;
        }

        .info-box strong {
            color: #ef4444;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .flow-diagram {
                flex-direction: column;
            }

            .flow-arrow {
                transform: rotate(90deg);
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>GPG Encryption Lab</h1>
            <p class="subtitle">Master Public Key Cryptography - House of Shield Security Training</p>
        </header>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('key-generation')">Key Generation</button>
            <button class="tab-button" onclick="switchTab('encryption')">Encrypt/Decrypt</button>
            <button class="tab-button" onclick="switchTab('signatures')">Digital Signatures</button>
            <button class="tab-button" onclick="switchTab('key-exchange')">Key Exchange</button>
            <button class="tab-button" onclick="switchTab('commands')">GPG Commands</button>
            <button class="tab-button" onclick="switchTab('comparison')">Symmetric vs Asymmetric</button>
            <button class="tab-button" onclick="switchTab('trust')">Web of Trust</button>
        </div>

        <!-- Tab 1: Key Generation -->
        <div id="key-generation" class="tab-content active">
            <div class="panel">
                <h2>RSA Key Pair Generation</h2>
                <p>Generate a cryptographic key pair for secure communication. The public key encrypts data, while the private key decrypts it.</p>

                <div class="input-group">
                    <label for="keyName">Name:</label>
                    <input type="text" id="keyName" placeholder="John Doe" value="Alice Cooper">
                </div>

                <div class="input-group">
                    <label for="keyEmail">Email:</label>
                    <input type="email" id="keyEmail" placeholder="user@example.com" value="alice@houseof.shield">
                </div>

                <div class="input-group">
                    <label for="keySize">Key Size:</label>
                    <select id="keySize">
                        <option value="2048">2048 bits (Standard)</option>
                        <option value="3072">3072 bits (High Security)</option>
                        <option value="4096">4096 bits (Maximum Security)</option>
                    </select>
                </div>

                <button class="button" onclick="generateKeyPair()">Generate Key Pair</button>

                <div id="keyPairDisplay"></div>
            </div>
        </div>

        <!-- Tab 2: Encryption/Decryption -->
        <div id="encryption" class="tab-content">
            <div class="panel">
                <h2>Message Encryption & Decryption</h2>
                <p>Encrypt messages with the public key, decrypt with the private key. Only the holder of the private key can read the encrypted message.</p>

                <div class="flow-diagram">
                    <div class="flow-box">
                        <div class="flow-box-title">Plaintext</div>
                        <div>Original Message</div>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">
                        <div class="flow-box-title">Public Key</div>
                        <div>Encryption</div>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">
                        <div class="flow-box-title">Ciphertext</div>
                        <div>Encrypted Data</div>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">
                        <div class="flow-box-title">Private Key</div>
                        <div>Decryption</div>
                    </div>
                    <div class="flow-arrow">‚Üí</div>
                    <div class="flow-box">
                        <div class="flow-box-title">Plaintext</div>
                        <div>Original Message</div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="plaintext">Enter Your Message:</label>
                    <textarea id="plaintext" placeholder="Type your secret message here...">This is a confidential message from House of Shield.</textarea>
                </div>

                <button class="button" onclick="encryptMessage()">Encrypt Message</button>
                <button class="button" onclick="decryptMessage()">Decrypt Message</button>
                <button class="button" onclick="clearEncryption()">Clear</button>

                <div class="input-group">
                    <label>Encrypted Message (Ciphertext):</label>
                    <div class="key-display" id="ciphertext">Click "Encrypt Message" to see the encrypted output...</div>
                </div>

                <div class="input-group">
                    <label>Decrypted Message (Plaintext):</label>
                    <div class="key-display" id="decrypted">Click "Decrypt Message" to recover the original text...</div>
                </div>

                <div id="encryptionAlert"></div>
            </div>
        </div>

        <!-- Tab 3: Digital Signatures -->
        <div id="signatures" class="tab-content">
            <div class="panel">
                <h2>Digital Signatures</h2>
                <p>Sign messages with your private key to prove authenticity. Others can verify the signature using your public key.</p>

                <div class="input-group">
                    <label for="signMessage">Message to Sign:</label>
                    <textarea id="signMessage" placeholder="Enter message to sign...">I hereby authorize this transaction. - Alice</textarea>
                </div>

                <button class="button" onclick="signMessage()">Sign Message</button>
                <button class="button" onclick="verifySignature()">Verify Signature</button>
                <button class="button" onclick="tamperMessage()">Tamper Message (Demo)</button>

                <div class="input-group">
                    <label>Digital Signature:</label>
                    <div class="signature-box" id="signatureDisplay">Click "Sign Message" to generate signature...</div>
                </div>

                <div id="verificationResult"></div>

                <div class="info-box">
                    <strong>How Digital Signatures Work:</strong><br>
                    1. A hash of the message is created<br>
                    2. The hash is encrypted with the sender's private key (this is the signature)<br>
                    3. Recipient decrypts the signature with sender's public key to get the hash<br>
                    4. Recipient creates a new hash of the received message<br>
                    5. If both hashes match, the signature is valid and the message is authentic
                </div>
            </div>
        </div>

        <!-- Tab 4: Key Exchange -->
        <div id="key-exchange" class="tab-content">
            <div class="panel">
                <h2>Public Key Exchange Visualization</h2>
                <p>Watch how Alice and Bob exchange public keys and communicate securely without ever sharing their private keys.</p>

                <div class="key-exchange-container">
                    <div class="person-card">
                        <div class="person-icon">üë©‚Äçüíº</div>
                        <div class="person-name">Alice</div>
                        <div style="color: #fca5a5; margin-top: 10px;">
                            <strong>Has:</strong><br>
                            Private Key A üîê<br>
                            Public Key A üîì<br>
                            Bob's Public Key B üîì
                        </div>
                    </div>

                    <div class="exchange-arrow">‚áÑ</div>

                    <div class="person-card">
                        <div class="person-icon">üë®‚Äçüíº</div>
                        <div class="person-name">Bob</div>
                        <div style="color: #fca5a5; margin-top: 10px;">
                            <strong>Has:</strong><br>
                            Private Key B üîê<br>
                            Public Key B üîì<br>
                            Alice's Public Key A üîì
                        </div>
                    </div>
                </div>

                <div class="input-group">
                    <label for="aliceMessage">Alice's Message to Bob:</label>
                    <textarea id="aliceMessage" placeholder="Alice's secret message...">Hey Bob, the security audit is scheduled for Friday at 3 PM.</textarea>
                </div>

                <button class="button" onclick="aliceSendsToBob()">Alice Encrypts & Sends</button>

                <div class="key-display" id="aliceCiphertext" style="margin-top: 15px;">Encrypted message will appear here...</div>

                <button class="button" style="margin-top: 15px;" onclick="bobDecrypts()">Bob Decrypts Message</button>

                <div class="key-display" id="bobPlaintext" style="margin-top: 15px;">Decrypted message will appear here...</div>

                <div class="info-box" style="margin-top: 20px;">
                    <strong>Key Exchange Process:</strong><br>
                    1. Alice and Bob each generate their own key pairs<br>
                    2. They exchange public keys (safely shared over insecure channels)<br>
                    3. Alice encrypts messages using Bob's public key ‚Üí Only Bob's private key can decrypt<br>
                    4. Bob encrypts messages using Alice's public key ‚Üí Only Alice's private key can decrypt<br>
                    5. Private keys NEVER leave their owners' systems
                </div>
            </div>
        </div>

        <!-- Tab 5: GPG Commands -->
        <div id="commands" class="tab-content">
            <div class="panel">
                <h2>Essential GPG Commands Reference</h2>
                <p>Master these commands to use GPG effectively in real-world scenarios.</p>

                <div class="command-list">
                    <div class="command-item">
                        <span class="command-code">gpg --gen-key</span>
                        <div class="command-desc">Generate a new GPG key pair. Interactive wizard prompts for name, email, and passphrase. Creates both public and private keys.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --full-generate-key</span>
                        <div class="command-desc">Advanced key generation with more options: key type (RSA, DSA, etc.), key size, and expiration date.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --list-keys</span>
                        <div class="command-desc">List all public keys in your keyring. Shows key IDs, creation dates, and associated user IDs.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --list-secret-keys</span>
                        <div class="command-desc">List all private keys in your keyring. These are the keys you can use to decrypt messages or sign documents.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --export --armor user@example.com > pubkey.asc</span>
                        <div class="command-desc">Export a public key in ASCII-armored format. Share this file with others so they can encrypt messages to you.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --import pubkey.asc</span>
                        <div class="command-desc">Import someone else's public key into your keyring. Required before you can encrypt messages to them.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --encrypt --recipient user@example.com file.txt</span>
                        <div class="command-desc">Encrypt a file using the recipient's public key. Creates file.txt.gpg. Only the recipient's private key can decrypt it.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --decrypt file.txt.gpg > file.txt</span>
                        <div class="command-desc">Decrypt a file that was encrypted with your public key. Requires your private key and passphrase.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --sign file.txt</span>
                        <div class="command-desc">Create a digital signature for a file using your private key. Proves you authored/approved the file.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --clearsign message.txt</span>
                        <div class="command-desc">Sign a text message in a human-readable format. Original text remains visible with signature appended.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --verify file.txt.sig</span>
                        <div class="command-desc">Verify a digital signature using the signer's public key. Confirms authenticity and integrity of the file.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --armor --sign --encrypt --recipient user@example.com file.txt</span>
                        <div class="command-desc">Sign AND encrypt a file. Provides both authentication (signature) and confidentiality (encryption).</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --fingerprint user@example.com</span>
                        <div class="command-desc">Display the fingerprint of a key. Used to verify key authenticity through a secondary channel (phone, in person).</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --edit-key user@example.com</span>
                        <div class="command-desc">Enter interactive key editing mode. Can add/revoke subkeys, change expiration, or sign keys (trust).</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --delete-key user@example.com</span>
                        <div class="command-desc">Delete a public key from your keyring. Use when you no longer need to communicate with that key owner.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --send-keys KEYID --keyserver keyserver.ubuntu.com</span>
                        <div class="command-desc">Upload your public key to a keyserver, making it discoverable by others who want to encrypt messages to you.</div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">gpg --search-keys user@example.com --keyserver keyserver.ubuntu.com</span>
                        <div class="command-desc">Search for public keys on a keyserver. Useful for finding keys of people you want to communicate with.</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 6: Symmetric vs Asymmetric -->
        <div id="comparison" class="tab-content">
            <div class="panel">
                <h2>Symmetric vs Asymmetric Encryption</h2>
                <p>Understanding the differences helps you choose the right encryption method for your use case.</p>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h3>Symmetric Encryption (AES)</h3>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Type:</span>
                            <span class="feature-value">Single shared secret key</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Distribution:</span>
                            <span class="feature-value">Difficult - must share securely</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Speed:</span>
                            <span class="feature-value">Very fast (1000x faster)</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Size:</span>
                            <span class="feature-value">128-256 bits</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Use Cases:</span>
                            <span class="feature-value">Encrypting large files, disk encryption, VPNs, databases</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Examples:</span>
                            <span class="feature-value">AES, DES, 3DES, Blowfish, ChaCha20</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Scalability:</span>
                            <span class="feature-value">Poor - need n(n-1)/2 keys for n users</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Digital Signatures:</span>
                            <span class="feature-value">Not possible</span>
                        </div>
                    </div>

                    <div class="comparison-card">
                        <h3>Asymmetric Encryption (RSA)</h3>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Type:</span>
                            <span class="feature-value">Key pair (public + private)</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Distribution:</span>
                            <span class="feature-value">Easy - public key can be shared openly</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Speed:</span>
                            <span class="feature-value">Slower (1000x slower than AES)</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Key Size:</span>
                            <span class="feature-value">2048-4096 bits</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Use Cases:</span>
                            <span class="feature-value">Key exchange, digital signatures, email encryption, SSL/TLS</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Examples:</span>
                            <span class="feature-value">RSA, ECC, DSA, ElGamal, Diffie-Hellman</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Scalability:</span>
                            <span class="feature-value">Excellent - each user needs only 1 key pair</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Digital Signatures:</span>
                            <span class="feature-value">Fully supported</span>
                        </div>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 30px;">
                    <strong>Hybrid Approach (How GPG Actually Works):</strong><br><br>
                    GPG uses BOTH methods for optimal security and performance:<br><br>
                    1. <strong>Session Key Generation:</strong> GPG generates a random symmetric key (AES) for each message<br>
                    2. <strong>Message Encryption:</strong> The actual message is encrypted with the fast AES session key<br>
                    3. <strong>Key Encryption:</strong> The AES session key is encrypted with the recipient's RSA public key<br>
                    4. <strong>Transmission:</strong> Both the encrypted message and encrypted session key are sent together<br>
                    5. <strong>Decryption:</strong> Recipient uses their RSA private key to decrypt the session key, then uses that to decrypt the message<br><br>
                    This gives you the speed of symmetric encryption with the convenience of asymmetric key distribution!
                </div>

                <h3 style="margin-top: 30px; color: #ef4444;">When to Use Each:</h3>

                <div class="command-list">
                    <div class="command-item">
                        <span class="command-code">Use Symmetric Encryption When:</span>
                        <div class="command-desc">
                            ‚Ä¢ You need to encrypt large amounts of data quickly<br>
                            ‚Ä¢ You're encrypting data for yourself (disk encryption, backups)<br>
                            ‚Ä¢ You have a secure channel to share the key (in person, secure courier)<br>
                            ‚Ä¢ Performance is critical (real-time encryption of video streams, etc.)
                        </div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">Use Asymmetric Encryption When:</span>
                        <div class="command-desc">
                            ‚Ä¢ You need to send encrypted messages to someone you've never met<br>
                            ‚Ä¢ You need digital signatures for authentication<br>
                            ‚Ä¢ You can't securely share a secret key in advance<br>
                            ‚Ä¢ You need non-repudiation (proof that someone sent a message)<br>
                            ‚Ä¢ You're building a scalable communication system (email, messaging)
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tab 7: Web of Trust -->
        <div id="trust" class="tab-content">
            <div class="panel">
                <h2>Web of Trust Model</h2>
                <p>GPG uses a decentralized trust model where users sign each other's keys to build a network of trust, rather than relying on central authorities.</p>

                <div class="info-box">
                    <strong>The Problem:</strong> How do you know that the public key you downloaded really belongs to the person you think it does? An attacker could create a fake key with someone else's name and email.
                </div>

                <h3>Trust Levels in GPG</h3>

                <div class="trust-diagram">
                    <div class="trust-level">
                        <div class="trust-level-title">Unknown (0)</div>
                        Nothing is known about the key owner's reliability in validating keys. This is the default for newly imported keys.
                    </div>

                    <div class="trust-level">
                        <div class="trust-level-title">None (1)</div>
                        The key owner is known to improperly validate keys. You actively distrust their key signatures.
                    </div>

                    <div class="trust-level">
                        <div class="trust-level-title">Marginal (2)</div>
                        The key owner probably validates keys before signing them. Some trust, but not complete confidence.
                    </div>

                    <div class="trust-level">
                        <div class="trust-level-title">Full (3)</div>
                        The key owner definitely validates keys carefully before signing. You fully trust their judgment.
                    </div>

                    <div class="trust-level">
                        <div class="trust-level-title">Ultimate (4)</div>
                        Reserved for your own keys. You have complete control and trust in these keys.
                    </div>
                </div>

                <h3>How the Web of Trust Works</h3>

                <div class="command-list">
                    <div class="command-item">
                        <span class="command-code">Step 1: Key Signing Parties</span>
                        <div class="command-desc">
                            People meet in person and verify each other's identities (using government IDs, passports, etc.). After confirming someone's identity, you sign their public key, creating a cryptographic statement: "I, [Your Name], have verified that this public key genuinely belongs to [Their Name]."
                        </div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">Step 2: Building Trust Chains</span>
                        <div class="command-desc">
                            If you trust Alice fully, and Alice has signed Bob's key after meeting him, then you can have some confidence in Bob's key even though you've never met Bob. This creates chains of trust: You ‚Üí Alice ‚Üí Bob.
                        </div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">Step 3: Trust Calculations</span>
                        <div class="command-desc">
                            GPG uses these rules to determine if a key is valid:<br>
                            ‚Ä¢ 1 signature from a key you "fully trust" = valid<br>
                            ‚Ä¢ 3 signatures from keys you "marginally trust" = valid<br>
                            ‚Ä¢ The chain can't be more than 5 levels deep
                        </div>
                    </div>

                    <div class="command-item">
                        <span class="command-code">Step 4: Key Fingerprint Verification</span>
                        <div class="command-desc">
                            Before signing someone's key, verify their fingerprint through a secondary channel:<br>
                            ‚Ä¢ Read fingerprint over the phone<br>
                            ‚Ä¢ Verify in person<br>
                            ‚Ä¢ Check their business card or website<br>
                            ‚Ä¢ Use multiple independent sources
                        </div>
                    </div>
                </div>

                <h3>Web of Trust vs Certificate Authorities (CA)</h3>

                <div class="comparison-grid">
                    <div class="comparison-card">
                        <h3>Web of Trust (GPG)</h3>
                        <div class="comparison-feature">
                            <span class="feature-label">Model:</span>
                            <span class="feature-value">Decentralized peer-to-peer trust</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Authority:</span>
                            <span class="feature-value">No central authority - users decide who to trust</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Cost:</span>
                            <span class="feature-value">Free - no fees to participate</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Scalability:</span>
                            <span class="feature-value">Difficult - requires personal connections</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Compromise Impact:</span>
                            <span class="feature-value">Limited - only affects local trust network</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Best For:</span>
                            <span class="feature-value">Personal communication, activist networks, small trusted groups</span>
                        </div>
                    </div>

                    <div class="comparison-card">
                        <h3>Certificate Authorities (SSL/TLS)</h3>
                        <div class="comparison-feature">
                            <span class="feature-label">Model:</span>
                            <span class="feature-value">Centralized hierarchical trust</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Authority:</span>
                            <span class="feature-value">Trusted CAs verify identities (Verisign, Let's Encrypt, etc.)</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Cost:</span>
                            <span class="feature-value">Often paid (except Let's Encrypt)</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Scalability:</span>
                            <span class="feature-value">Excellent - works globally for millions of websites</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Compromise Impact:</span>
                            <span class="feature-value">Severe - compromised CA affects all certificates</span>
                        </div>
                        <div class="comparison-feature">
                            <span class="feature-label">Best For:</span>
                            <span class="feature-value">HTTPS websites, enterprise PKI, large-scale systems</span>
                        </div>
                    </div>
                </div>

                <div class="info-box" style="margin-top: 30px;">
                    <strong>Best Practices for Web of Trust:</strong><br><br>
                    1. <strong>Never sign a key without verifying identity:</strong> Meet in person or verify through multiple channels<br>
                    2. <strong>Only give "full trust" sparingly:</strong> Reserve for people you know are careful about verifying identities<br>
                    3. <strong>Attend key signing parties:</strong> Security conferences and local crypto groups often host these<br>
                    4. <strong>Publish your fingerprint widely:</strong> Business cards, email signatures, website, social media<br>
                    5. <strong>Keep your private key secure:</strong> Use a strong passphrase, store in encrypted storage<br>
                    6. <strong>Set expiration dates:</strong> Keys should expire (1-2 years) to limit damage if compromised<br>
                    7. <strong>Generate a revocation certificate:</strong> Create and safely store a revocation cert when you create keys<br>
                    8. <strong>Use keyservers wisely:</strong> Upload your public key, but verify fingerprints when downloading others
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let publicKey = null;
        let privateKey = null;
        let encryptedData = null;
        let currentSignature = null;
        let currentMessage = null;
        let messageHash = null;
        let isTampered = false;

        // Alice and Bob's keys for key exchange demo
        let aliceKeys = { public: null, private: null };
        let bobKeys = { public: null, private: null };

        // Initialize Alice and Bob's keys on page load
        window.addEventListener('DOMContentLoaded', function() {
            aliceKeys.public = 'ALICE-PUB-' + generateRandomHex(32);
            aliceKeys.private = 'ALICE-PRIV-' + generateRandomHex(32);
            bobKeys.public = 'BOB-PUB-' + generateRandomHex(32);
            bobKeys.private = 'BOB-PRIV-' + generateRandomHex(32);
        });

        // Tab switching
        function switchTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');
        }

        // Utility function to generate random hex string
        function generateRandomHex(length) {
            let result = '';
            const characters = '0123456789abcdef';
            for (let i = 0; i < length; i++) {
                result += characters.charAt(Math.floor(Math.random() * characters.length));
            }
            return result;
        }

        // Simulate RSA key generation
        function generateKeyPair() {
            const name = document.getElementById('keyName').value || 'Anonymous User';
            const email = document.getElementById('keyEmail').value || 'user@example.com';
            const keySize = document.getElementById('keySize').value;

            // Simulate key generation delay
            const displayDiv = document.getElementById('keyPairDisplay');
            displayDiv.innerHTML = '<div class="alert alert-warning">Generating key pair... This may take a moment.</div>';

            setTimeout(() => {
                // Generate simulated RSA components
                const p = generateLargePrime(keySize / 2);
                const q = generateLargePrime(keySize / 2);
                const n = multiplyLargePrimes(p, q);
                const e = '65537'; // Common public exponent
                const d = generatePrivateExponent();

                // Generate key fingerprint
                const fingerprint = generateFingerprint();

                // Store keys globally
                publicKey = `RSA-PUB-${keySize}-${generateRandomHex(64)}`;
                privateKey = `RSA-PRIV-${keySize}-${generateRandomHex(64)}`;

                displayDiv.innerHTML = `
                    <div class="alert alert-success">Key pair generated successfully!</div>

                    <h3>Public Key</h3>
                    <div class="key-display">
-----BEGIN PGP PUBLIC KEY BLOCK-----
Version: GnuPG v2.2

${formatKey(publicKey)}
User ID: ${name} &lt;${email}&gt;
Key Size: ${keySize} bits
Created: ${new Date().toISOString().split('T')[0]}
-----END PGP PUBLIC KEY BLOCK-----
                    </div>

                    <div class="key-component">
                        <div class="key-component-title">Modulus (n)</div>
                        ${n}
                        <div style="margin-top: 8px; font-size: 0.9em;">Product of two large primes (p √ó q). This is public and used in both encryption and decryption.</div>
                    </div>

                    <div class="key-component">
                        <div class="key-component-title">Public Exponent (e)</div>
                        ${e}
                        <div style="margin-top: 8px; font-size: 0.9em;">Commonly 65537. Used with the modulus to encrypt messages.</div>
                    </div>

                    <div class="key-component">
                        <div class="key-component-title">Key Fingerprint</div>
                        ${fingerprint}
                        <div style="margin-top: 8px; font-size: 0.9em;">SHA-256 hash of the public key. Share this to verify key authenticity.</div>
                    </div>

                    <h3 style="margin-top: 30px;">Private Key</h3>
                    <div class="key-display">
-----BEGIN PGP PRIVATE KEY BLOCK-----
Version: GnuPG v2.2

${formatKey(privateKey)}
User ID: ${name} &lt;${email}&gt;
Key Size: ${keySize} bits
Created: ${new Date().toISOString().split('T')[0]}

‚ö†Ô∏è NEVER SHARE THIS KEY ‚ö†Ô∏è
-----END PGP PRIVATE KEY BLOCK-----
                    </div>

                    <div class="key-component">
                        <div class="key-component-title">Private Exponent (d)</div>
                        ${d}
                        <div style="margin-top: 8px; font-size: 0.9em;">Secret value derived from p, q, and e. Used to decrypt messages. Must be kept secure!</div>
                    </div>

                    <div class="info-box">
                        <strong>RSA Mathematics:</strong><br>
                        ‚Ä¢ Encryption: C = M<sup>e</sup> mod n<br>
                        ‚Ä¢ Decryption: M = C<sup>d</sup> mod n<br>
                        ‚Ä¢ Security relies on the difficulty of factoring n back into p and q<br>
                        ‚Ä¢ With ${keySize}-bit keys, factoring would take millions of years with current computers
                    </div>
                `;
            }, 1500);
        }

        // Simulate large prime generation
        function generateLargePrime(bits) {
            const hexLength = Math.floor(parseInt(bits) / 4);
            return generateRandomHex(hexLength);
        }

        // Simulate multiplication
        function multiplyLargePrimes(p, q) {
            return generateRandomHex(p.length + q.length);
        }

        // Generate private exponent
        function generatePrivateExponent() {
            return generateRandomHex(128);
        }

        // Generate key fingerprint
        function generateFingerprint() {
            const hex = generateRandomHex(64);
            return hex.match(/.{1,4}/g).join(' ').toUpperCase();
        }

        // Format key for display
        function formatKey(key) {
            // Break key into 64-character lines
            const lines = key.match(/.{1,64}/g);
            return lines ? lines.join('\n') : key;
        }

        // Encryption
        function encryptMessage() {
            if (!publicKey) {
                document.getElementById('encryptionAlert').innerHTML =
                    '<div class="alert alert-warning">Please generate a key pair first in the "Key Generation" tab.</div>';
                return;
            }

            const plaintext = document.getElementById('plaintext').value;
            if (!plaintext.trim()) {
                document.getElementById('encryptionAlert').innerHTML =
                    '<div class="alert alert-warning">Please enter a message to encrypt.</div>';
                return;
            }

            // Simulate encryption
            const encrypted = btoa(plaintext).split('').reverse().join('') + generateRandomHex(32);
            encryptedData = encrypted;

            document.getElementById('ciphertext').innerHTML = `
-----BEGIN PGP MESSAGE-----
Version: GnuPG v2.2

${formatKey(encrypted)}
-----END PGP MESSAGE-----
            `;

            document.getElementById('encryptionAlert').innerHTML =
                '<div class="alert alert-success">Message encrypted successfully! The ciphertext can only be decrypted with the corresponding private key.</div>';
        }

        // Decryption
        function decryptMessage() {
            if (!privateKey || !encryptedData) {
                document.getElementById('encryptionAlert').innerHTML =
                    '<div class="alert alert-warning">Please encrypt a message first.</div>';
                return;
            }

            const plaintext = document.getElementById('plaintext').value;

            document.getElementById('decrypted').innerHTML = `
<strong>Decrypted Message:</strong>

${plaintext}

<div style="margin-top: 15px; padding: 10px; background: rgba(34, 197, 94, 0.2); border-radius: 6px;">
‚úì Signature verified<br>
‚úì Message integrity confirmed<br>
‚úì Decrypted successfully
</div>
            `;

            document.getElementById('encryptionAlert').innerHTML =
                '<div class="alert alert-success">Message decrypted successfully using your private key!</div>';
        }

        // Clear encryption
        function clearEncryption() {
            document.getElementById('plaintext').value = '';
            document.getElementById('ciphertext').innerHTML = 'Click "Encrypt Message" to see the encrypted output...';
            document.getElementById('decrypted').innerHTML = 'Click "Decrypt Message" to recover the original text...';
            document.getElementById('encryptionAlert').innerHTML = '';
            encryptedData = null;
        }

        // Digital signature functions
        function signMessage() {
            if (!privateKey) {
                document.getElementById('verificationResult').innerHTML =
                    '<div class="alert alert-warning">Please generate a key pair first in the "Key Generation" tab.</div>';
                return;
            }

            currentMessage = document.getElementById('signMessage').value;
            if (!currentMessage.trim()) {
                document.getElementById('verificationResult').innerHTML =
                    '<div class="alert alert-warning">Please enter a message to sign.</div>';
                return;
            }

            // Simulate hashing and signing
            messageHash = generateRandomHex(64);
            currentSignature = 'SIG-' + generateRandomHex(128);
            isTampered = false;

            document.getElementById('signatureDisplay').innerHTML = `
-----BEGIN PGP SIGNATURE-----
Version: GnuPG v2.2

${formatKey(currentSignature)}
-----END PGP SIGNATURE-----

Message Hash (SHA-256): ${messageHash}
Signed with: Private Key
            `;

            document.getElementById('verificationResult').innerHTML =
                '<div class="alert alert-success">Message signed successfully! The signature proves you authored this message.</div>';
        }

        function verifySignature() {
            if (!currentSignature) {
                document.getElementById('verificationResult').innerHTML =
                    '<div class="alert alert-warning">Please sign a message first.</div>';
                return;
            }

            if (!publicKey) {
                document.getElementById('verificationResult').innerHTML =
                    '<div class="alert alert-warning">Please generate a key pair first in the "Key Generation" tab.</div>';
                return;
            }

            const currentMessageCheck = document.getElementById('signMessage').value;

            if (isTampered || currentMessageCheck !== currentMessage) {
                document.getElementById('verificationResult').innerHTML = `
                    <div class="alert alert-danger">
                        <strong>‚ö†Ô∏è SIGNATURE VERIFICATION FAILED!</strong><br><br>
                        The message has been modified after signing.<br>
                        Hash mismatch detected.<br><br>
                        <strong>Security Alert:</strong> This message may have been tampered with or is from an imposter.<br>
                        DO NOT TRUST THIS MESSAGE!
                    </div>
                `;
            } else {
                document.getElementById('verificationResult').innerHTML = `
                    <div class="alert alert-success">
                        <strong>‚úì SIGNATURE VALID</strong><br><br>
                        Message integrity: VERIFIED<br>
                        Sender authenticity: CONFIRMED<br>
                        Signature created: ${new Date().toLocaleString()}<br><br>
                        This message is authentic and has not been modified.
                    </div>
                `;
            }
        }

        function tamperMessage() {
            const messageField = document.getElementById('signMessage');
            messageField.value = messageField.value + ' [TAMPERED]';
            isTampered = true;

            document.getElementById('verificationResult').innerHTML =
                '<div class="alert alert-warning">Message has been tampered with! Try verifying the signature now to see what happens.</div>';
        }

        // Key exchange functions
        function aliceSendsToBob() {
            const message = document.getElementById('aliceMessage').value;
            if (!message.trim()) {
                document.getElementById('aliceCiphertext').innerHTML =
                    '<span style="color: #fca5a5;">Please enter a message for Alice to send.</span>';
                return;
            }

            // Encrypt with Bob's public key
            const encrypted = btoa(message).split('').reverse().join('') + '-BOBPUB-' + generateRandomHex(32);

            document.getElementById('aliceCiphertext').innerHTML = `
<strong>Encrypted with Bob's Public Key:</strong>

-----BEGIN PGP MESSAGE-----
To: Bob
From: Alice
Encrypted-For: ${bobKeys.public.substring(0, 20)}...

${formatKey(encrypted)}
-----END PGP MESSAGE-----

<div style="margin-top: 10px; color: #fca5a5;">
üîí This message can ONLY be decrypted by Bob's private key.
Even Alice cannot decrypt this after encryption!
</div>
            `;

            document.getElementById('bobPlaintext').innerHTML = 'Click "Bob Decrypts Message" to read the message...';
        }

        function bobDecrypts() {
            const message = document.getElementById('aliceMessage').value;
            const ciphertext = document.getElementById('aliceCiphertext').innerHTML;

            if (!message.trim() || ciphertext.includes('Encrypted message will appear here')) {
                document.getElementById('bobPlaintext').innerHTML =
                    '<span style="color: #fca5a5;">Please have Alice send a message first.</span>';
                return;
            }

            document.getElementById('bobPlaintext').innerHTML = `
<strong>Decrypted with Bob's Private Key:</strong>

${message}

<div style="margin-top: 10px; padding: 10px; background: rgba(34, 197, 94, 0.2); border-radius: 6px;">
‚úì Successfully decrypted using Bob's private key<br>
‚úì Message authenticity verified<br>
‚úì Secure communication established<br><br>
<strong>Security Notes:</strong><br>
‚Ä¢ Only Bob could decrypt this message<br>
‚Ä¢ Alice's public key could be used to verify her identity<br>
‚Ä¢ No one intercepting the message can read it<br>
‚Ä¢ Private keys never left their respective owners
</div>
            `;
        }
    </script>
</body>
</html>