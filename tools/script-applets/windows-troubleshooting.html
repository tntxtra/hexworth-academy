<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Windows Troubleshooting Flowcharts - CompTIA A+ Core 2</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-green: #166534;
            --light-green: #22c55e;
            --dark-green: #0f4a24;
            --accent-purple: #7c3aed;
            --light-purple: #a78bfa;
            --bg-dark: #0f172a;
            --bg-medium: #1e293b;
            --bg-light: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --border-color: #475569;
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-dark) 0%, var(--bg-medium) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid var(--light-green);
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-align: center;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .subtitle {
            text-align: center;
            color: var(--light-green);
            font-size: 1.2em;
        }

        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .tab-btn {
            background: var(--bg-medium);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 12px 24px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab-btn:hover {
            background: var(--bg-light);
            border-color: var(--light-green);
            transform: translateY(-2px);
        }

        .tab-btn.active {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            border-color: var(--light-green);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section-card {
            background: var(--bg-medium);
            padding: 25px;
            border-radius: 15px;
            margin-bottom: 20px;
            border: 2px solid var(--border-color);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .section-card h2 {
            color: var(--light-green);
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 2px solid var(--primary-green);
            padding-bottom: 10px;
        }

        .section-card h3 {
            color: var(--light-purple);
            margin-top: 20px;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        /* Flowchart Styles */
        .flowchart-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .flowchart-option {
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-medium) 100%);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .flowchart-option:hover {
            border-color: var(--light-green);
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(34, 197, 94, 0.2);
        }

        .flowchart-option.active {
            border-color: var(--accent-purple);
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--primary-green) 100%);
        }

        .flowchart-option h4 {
            color: var(--light-green);
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .flowchart-option p {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .flowchart-display {
            background: var(--bg-light);
            padding: 30px;
            border-radius: 15px;
            border: 2px solid var(--primary-green);
            min-height: 400px;
        }

        .flowchart-node {
            background: var(--bg-medium);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid var(--border-color);
            margin-bottom: 20px;
            animation: slideIn 0.4s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .node-question {
            color: var(--light-green);
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .node-description {
            color: var(--text-secondary);
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .node-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .node-btn {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            color: white;
            border: 2px solid var(--light-green);
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            flex: 1;
            min-width: 150px;
        }

        .node-btn:hover {
            background: linear-gradient(135deg, var(--light-green) 0%, var(--primary-green) 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
        }

        .node-btn.secondary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, #6d28d9 100%);
            border-color: var(--light-purple);
        }

        .node-btn.secondary:hover {
            background: linear-gradient(135deg, var(--light-purple) 0%, var(--accent-purple) 100%);
        }

        .breadcrumb {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .breadcrumb-item {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .breadcrumb-item.current {
            color: var(--light-green);
            font-weight: 600;
        }

        .breadcrumb-arrow {
            color: var(--border-color);
        }

        .solution-box {
            background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #34d399;
        }

        .solution-box h4 {
            color: white;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .solution-box ul {
            list-style-position: inside;
            color: #f0fdf4;
        }

        .solution-box li {
            margin-bottom: 8px;
        }

        /* Tool Reference Styles */
        .tool-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .tool-card {
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-medium) 100%);
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .tool-card:hover {
            border-color: var(--accent-purple);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(124, 58, 237, 0.2);
        }

        .tool-card h4 {
            color: var(--light-green);
            margin-bottom: 12px;
            font-size: 1.3em;
        }

        .tool-access {
            background: var(--bg-dark);
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            color: var(--light-purple);
            font-size: 0.9em;
        }

        .tool-uses {
            margin-top: 15px;
        }

        .tool-uses strong {
            color: var(--light-green);
        }

        .tool-uses ul {
            margin-top: 8px;
            margin-left: 20px;
            color: var(--text-secondary);
        }

        /* Scenario Simulator Styles */
        .scenario-card {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            border: 2px solid var(--accent-purple);
            margin-bottom: 20px;
        }

        .scenario-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .scenario-title {
            color: var(--light-purple);
            font-size: 1.4em;
        }

        .difficulty-badge {
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }

        .difficulty-easy {
            background: var(--success);
            color: white;
        }

        .difficulty-medium {
            background: var(--warning);
            color: white;
        }

        .difficulty-hard {
            background: var(--error);
            color: white;
        }

        .scenario-description {
            background: var(--bg-medium);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: var(--text-secondary);
            border-left: 4px solid var(--accent-purple);
        }

        .progress-bar {
            background: var(--bg-dark);
            height: 8px;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-fill {
            background: linear-gradient(90deg, var(--primary-green) 0%, var(--light-green) 100%);
            height: 100%;
            transition: width 0.4s ease;
        }

        /* Quiz Styles */
        .quiz-question {
            background: var(--bg-light);
            padding: 25px;
            border-radius: 12px;
            border: 2px solid var(--primary-green);
            margin-bottom: 20px;
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .question-number {
            color: var(--light-green);
            font-size: 1.2em;
            font-weight: 600;
        }

        .question-text {
            color: var(--text-primary);
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.8;
        }

        .answer-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .answer-option {
            background: var(--bg-medium);
            padding: 15px 20px;
            border-radius: 8px;
            border: 2px solid var(--border-color);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .answer-option:hover {
            border-color: var(--light-green);
            background: var(--bg-light);
        }

        .answer-option.selected {
            border-color: var(--accent-purple);
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.2) 0%, rgba(124, 58, 237, 0.1) 100%);
        }

        .answer-option.correct {
            border-color: var(--success);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.2) 0%, rgba(16, 185, 129, 0.1) 100%);
        }

        .answer-option.incorrect {
            border-color: var(--error);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.2) 0%, rgba(239, 68, 68, 0.1) 100%);
        }

        .explanation {
            background: var(--bg-dark);
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 4px solid var(--light-green);
            display: none;
        }

        .explanation.show {
            display: block;
            animation: fadeIn 0.4s ease;
        }

        .explanation strong {
            color: var(--light-green);
        }

        .quiz-score {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-top: 20px;
            border: 2px solid var(--light-green);
        }

        .score-value {
            font-size: 3em;
            font-weight: bold;
            color: white;
            margin: 10px 0;
        }

        /* Event Viewer Styles */
        .event-viewer {
            background: var(--bg-dark);
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid var(--border-color);
        }

        .event-toolbar {
            background: var(--bg-medium);
            padding: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            border-bottom: 2px solid var(--border-color);
        }

        .filter-btn {
            background: var(--bg-light);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9em;
        }

        .filter-btn:hover {
            border-color: var(--light-green);
        }

        .filter-btn.active {
            background: var(--primary-green);
            border-color: var(--light-green);
        }

        .event-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .event-entry {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            transition: background 0.2s ease;
        }

        .event-entry:hover {
            background: var(--bg-medium);
        }

        .event-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            flex-wrap: wrap;
            gap: 10px;
        }

        .event-level {
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .level-error {
            background: var(--error);
            color: white;
        }

        .level-warning {
            background: var(--warning);
            color: white;
        }

        .level-info {
            background: #3b82f6;
            color: white;
        }

        .event-time {
            color: var(--text-secondary);
            font-size: 0.9em;
        }

        .event-source {
            color: var(--light-purple);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .event-message {
            color: var(--text-secondary);
            font-size: 0.95em;
        }

        /* Methodology Steps */
        .methodology-steps {
            display: grid;
            gap: 15px;
        }

        .step-card {
            background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-medium) 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--light-green);
            transition: all 0.3s ease;
        }

        .step-card:hover {
            transform: translateX(10px);
            border-left-color: var(--accent-purple);
        }

        .step-number {
            background: var(--primary-green);
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 15px;
            color: white;
        }

        .step-title {
            color: var(--light-green);
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .step-description {
            color: var(--text-secondary);
            line-height: 1.8;
        }

        /* Utility Classes */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            color: white;
            border: 2px solid var(--light-green);
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--light-green) 0%, var(--primary-green) 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(34, 197, 94, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, #6d28d9 100%);
            color: white;
            border: 2px solid var(--light-purple);
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--light-purple) 0%, var(--accent-purple) 100%);
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(124, 58, 237, 0.4);
        }

        .reset-btn {
            background: var(--bg-medium);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 15px;
        }

        .reset-btn:hover {
            border-color: var(--error);
            background: var(--error);
            color: white;
        }

        /* Scrollbar Styles */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-dark);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-green);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--light-green);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }

            .subtitle {
                font-size: 1em;
            }

            .flowchart-selector {
                grid-template-columns: 1fr;
            }

            .tool-grid {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-direction: column;
            }

            .tab-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Windows Troubleshooting Flowcharts</h1>
            <p class="subtitle">CompTIA A+ Core 2 - Interactive Learning Tool</p>
        </header>

        <div class="nav-tabs">
            <button class="tab-btn active" data-tab="methodology">Troubleshooting Methodology</button>
            <button class="tab-btn" data-tab="flowcharts">Interactive Flowcharts</button>
            <button class="tab-btn" data-tab="tools">Recovery Tools</button>
            <button class="tab-btn" data-tab="scenarios">Scenario Simulator</button>
            <button class="tab-btn" data-tab="eventviewer">Event Viewer Demo</button>
            <button class="tab-btn" data-tab="quiz">Quiz</button>
        </div>

        <!-- Methodology Tab -->
        <div id="methodology" class="tab-content active">
            <div class="section-card">
                <h2>CompTIA Troubleshooting Methodology</h2>
                <p style="color: var(--text-secondary); margin-bottom: 30px;">
                    The CompTIA A+ troubleshooting methodology is a systematic 6-step process used to diagnose and resolve IT issues efficiently.
                </p>

                <div class="methodology-steps">
                    <div class="step-card">
                        <span class="step-number">1</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Identify the Problem</div>
                            <div class="step-description">
                                Gather information from users and system. Ask open-ended questions. Document symptoms.
                                Determine if changes occurred recently. Use inquiry process: what, when, where, who, how.
                                Replicate the problem if possible.
                            </div>
                        </div>
                    </div>

                    <div class="step-card">
                        <span class="step-number">2</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Establish a Theory of Probable Cause</div>
                            <div class="step-description">
                                Question the obvious. Consider multiple approaches. Start with simple solutions first.
                                Research knowledge bases, vendor documentation, and online resources. Develop hypotheses based on symptoms.
                            </div>
                        </div>
                    </div>

                    <div class="step-card">
                        <span class="step-number">3</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Test the Theory to Determine Cause</div>
                            <div class="step-description">
                                Test your theory. If confirmed, determine next steps to resolve. If theory is not confirmed,
                                re-establish new theory or escalate. Use safe mode, diagnostic tools, and isolate variables.
                            </div>
                        </div>
                    </div>

                    <div class="step-card">
                        <span class="step-number">4</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Establish a Plan of Action</div>
                            <div class="step-description">
                                Create action plan with steps to resolve. Consider corporate policies and impact to users.
                                Get approval if needed. Backup data before making changes. Have rollback plan ready.
                            </div>
                        </div>
                    </div>

                    <div class="step-card">
                        <span class="step-number">5</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Verify Full System Functionality</div>
                            <div class="step-description">
                                Test the fix thoroughly. Verify the original problem is resolved and no new issues appeared.
                                Test related functionality. Have user verify fix if possible. Implement preventive measures.
                            </div>
                        </div>
                    </div>

                    <div class="step-card">
                        <span class="step-number">6</span>
                        <div style="display: inline-block; vertical-align: top; width: calc(100% - 60px);">
                            <div class="step-title">Document Findings, Actions, and Outcomes</div>
                            <div class="step-description">
                                Create detailed documentation. Record symptoms, solutions, and lessons learned.
                                Update knowledge base. Document configuration changes. Include date, time, and technician name.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Flowcharts Tab -->
        <div id="flowcharts" class="tab-content">
            <div class="section-card">
                <h2>Interactive Troubleshooting Flowcharts</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Select a problem type to begin the interactive troubleshooting flowchart:
                </p>

                <div class="flowchart-selector">
                    <div class="flowchart-option" data-flowchart="boot-failure">
                        <h4>Boot Failures</h4>
                        <p>BSOD, boot loops, black screen</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="slow-performance">
                        <h4>Slow Performance</h4>
                        <p>System lag, high resource usage</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="app-crash">
                        <h4>Application Crashes</h4>
                        <p>Programs freezing or closing</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="network">
                        <h4>Network Issues</h4>
                        <p>No connectivity, slow internet</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="printing">
                        <h4>Printing Problems</h4>
                        <p>Printer offline, print queue issues</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="display">
                        <h4>Display Issues</h4>
                        <p>No display, distorted graphics</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="audio">
                        <h4>Audio Problems</h4>
                        <p>No sound, distorted audio</p>
                    </div>
                    <div class="flowchart-option" data-flowchart="updates">
                        <h4>Windows Update Failures</h4>
                        <p>Update errors, rollback issues</p>
                    </div>
                </div>

                <div id="flowchart-display" class="flowchart-display" style="display: none;">
                    <div class="breadcrumb" id="breadcrumb"></div>
                    <div id="flowchart-content"></div>
                </div>
            </div>
        </div>

        <!-- Recovery Tools Tab -->
        <div id="tools" class="tab-content">
            <div class="section-card">
                <h2>Windows Recovery Tools Reference</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Comprehensive guide to Windows recovery and diagnostic tools:
                </p>

                <div class="tool-grid">
                    <div class="tool-card">
                        <h4>Safe Mode</h4>
                        <div class="tool-access">Access: Advanced Startup > Troubleshoot > Startup Settings</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Removing problematic drivers or software</li>
                                <li>Troubleshooting startup issues</li>
                                <li>Malware removal</li>
                                <li>System file corruption diagnosis</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Windows Recovery Environment (WinRE)</h4>
                        <div class="tool-access">Access: Settings > Update & Security > Recovery > Restart now</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>System won't boot normally</li>
                                <li>Access to advanced troubleshooting tools</li>
                                <li>Command prompt access when GUI fails</li>
                                <li>Startup repair and system restore</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>System Restore</h4>
                        <div class="tool-access">Access: Control Panel > Recovery > Open System Restore</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Recent software installation caused issues</li>
                                <li>Windows updates failed</li>
                                <li>System instability after changes</li>
                                <li>Driver conflicts</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Startup Repair</h4>
                        <div class="tool-access">Access: WinRE > Troubleshoot > Advanced options > Startup Repair</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Boot configuration data (BCD) corruption</li>
                                <li>Missing or damaged system files</li>
                                <li>Master boot record (MBR) issues</li>
                                <li>Boot sector problems</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Reset This PC</h4>
                        <div class="tool-access">Access: Settings > Update & Security > Recovery > Reset this PC</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Persistent malware infections</li>
                                <li>Severe system corruption</li>
                                <li>Performance issues after other fixes fail</li>
                                <li>Preparing PC for new user</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>System File Checker (SFC)</h4>
                        <div class="tool-access">Command: sfc /scannow</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Suspected system file corruption</li>
                                <li>Random crashes or errors</li>
                                <li>Before running DISM</li>
                                <li>After malware removal</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>DISM (Deployment Image Servicing)</h4>
                        <div class="tool-access">Command: DISM /Online /Cleanup-Image /RestoreHealth</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>SFC unable to repair files</li>
                                <li>Windows image corruption</li>
                                <li>Component store issues</li>
                                <li>Before running SFC</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Recovery Drive</h4>
                        <div class="tool-access">Access: Control Panel > Create a recovery drive</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Hard drive failure prevention</li>
                                <li>Boot from external media needed</li>
                                <li>Reinstalling Windows</li>
                                <li>Emergency recovery scenarios</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Event Viewer</h4>
                        <div class="tool-access">Access: eventvwr.msc or Windows Logs</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Investigating application crashes</li>
                                <li>Diagnosing system errors</li>
                                <li>Security audit review</li>
                                <li>Hardware failure detection</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Command Prompt (Recovery)</h4>
                        <div class="tool-access">Access: WinRE > Troubleshoot > Command Prompt</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Bootrec commands for boot issues</li>
                                <li>Diskpart for disk management</li>
                                <li>File operations when GUI unavailable</li>
                                <li>Registry edits (regedit)</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Last Known Good Configuration</h4>
                        <div class="tool-access">Access: F8 during boot (older Windows versions)</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Recent driver installation caused boot issues</li>
                                <li>Configuration changes prevent booting</li>
                                <li>Note: Deprecated in Windows 10/11</li>
                                <li>Use System Restore instead</li>
                            </ul>
                        </div>
                    </div>

                    <div class="tool-card">
                        <h4>Performance Monitor</h4>
                        <div class="tool-access">Access: perfmon.msc</div>
                        <div class="tool-uses">
                            <strong>When to Use:</strong>
                            <ul>
                                <li>Diagnosing performance bottlenecks</li>
                                <li>Monitoring resource usage over time</li>
                                <li>Identifying memory leaks</li>
                                <li>Disk I/O analysis</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Scenario Simulator Tab -->
        <div id="scenarios" class="tab-content">
            <div class="section-card">
                <h2>Troubleshooting Scenario Simulator</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Practice real-world troubleshooting scenarios. Follow the flowchart to solve each problem:
                </p>

                <div id="scenario-container"></div>
            </div>
        </div>

        <!-- Event Viewer Tab -->
        <div id="eventviewer" class="tab-content">
            <div class="section-card">
                <h2>Event Viewer Demo</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Learn to interpret Windows Event Viewer logs. Filter by severity level to focus on specific issues:
                </p>

                <div class="event-viewer">
                    <div class="event-toolbar">
                        <span style="color: var(--text-secondary); margin-right: 10px;">Filter by Level:</span>
                        <button class="filter-btn active" data-level="all">All Events</button>
                        <button class="filter-btn" data-level="error">Errors</button>
                        <button class="filter-btn" data-level="warning">Warnings</button>
                        <button class="filter-btn" data-level="info">Information</button>
                    </div>
                    <div class="event-list" id="event-list"></div>
                </div>

                <div style="margin-top: 30px; background: var(--bg-light); padding: 20px; border-radius: 10px; border: 2px solid var(--accent-purple);">
                    <h3 style="color: var(--light-purple); margin-bottom: 15px;">Event Viewer Tips</h3>
                    <ul style="color: var(--text-secondary); line-height: 2; margin-left: 20px;">
                        <li><strong style="color: var(--light-green);">Error (Red):</strong> Critical issues requiring immediate attention - application crashes, service failures, hardware errors</li>
                        <li><strong style="color: var(--light-green);">Warning (Yellow):</strong> Potential problems - disk space low, driver issues, performance degradation</li>
                        <li><strong style="color: var(--light-green);">Information (Blue):</strong> Normal operations - successful operations, service starts, routine events</li>
                        <li><strong style="color: var(--light-green);">Event ID:</strong> Unique identifier for troubleshooting - search Microsoft knowledge base</li>
                        <li><strong style="color: var(--light-green);">Source:</strong> Application or service that logged the event</li>
                        <li><strong style="color: var(--light-green);">Common Logs:</strong> Application (app errors), System (Windows/driver), Security (audit events)</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Quiz Tab -->
        <div id="quiz" class="tab-content">
            <div class="section-card">
                <h2>Troubleshooting Knowledge Quiz</h2>
                <p style="color: var(--text-secondary); margin-bottom: 20px;">
                    Test your Windows troubleshooting knowledge with 10 CompTIA A+ style questions:
                </p>

                <div id="quiz-container"></div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn-primary" id="submit-quiz" style="display: none;">Submit Quiz</button>
                    <button class="btn-secondary" id="restart-quiz" style="display: none;">Restart Quiz</button>
                </div>

                <div id="quiz-results" style="display: none;"></div>
            </div>
        </div>
    </div>

    <script>
        // Tab Navigation
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');

        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.dataset.tab;

                tabBtns.forEach(b => b.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));

                btn.classList.add('active');
                document.getElementById(tabId).classList.add('active');
            });
        });

        // Flowchart Data Structure
        const flowcharts = {
            'boot-failure': {
                title: 'Boot Failure Troubleshooting',
                nodes: {
                    start: {
                        question: 'What type of boot failure are you experiencing?',
                        description: 'Identify the specific symptom to begin troubleshooting.',
                        actions: [
                            { text: 'BSOD (Blue Screen of Death)', next: 'bsod' },
                            { text: 'Black Screen (No Display)', next: 'black-screen' },
                            { text: 'Boot Loop (Restarting)', next: 'boot-loop' },
                            { text: 'Error Message on Boot', next: 'error-message' }
                        ]
                    },
                    bsod: {
                        question: 'BSOD Troubleshooting',
                        description: 'Note the STOP code (e.g., IRQL_NOT_LESS_OR_EQUAL). This helps identify the cause.',
                        actions: [
                            { text: 'Recent Hardware Changes', next: 'bsod-hardware' },
                            { text: 'Recent Software/Driver Updates', next: 'bsod-software' },
                            { text: 'Random/Intermittent', next: 'bsod-random' }
                        ]
                    },
                    'bsod-hardware': {
                        question: 'Hardware-Related BSOD',
                        description: 'New hardware or hardware changes often cause BSODs.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Remove recently installed hardware',
                                'Check RAM with MemTest86+ for memory errors',
                                'Verify all components are properly seated',
                                'Update motherboard BIOS/UEFI firmware',
                                'Check Event Viewer for hardware error logs',
                                'If problem persists, boot in Safe Mode and uninstall device drivers'
                            ]
                        }
                    },
                    'bsod-software': {
                        question: 'Software/Driver-Related BSOD',
                        description: 'Driver conflicts or faulty updates are common BSOD causes.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Boot into Safe Mode (F8 or Shift+Restart)',
                                'Use System Restore to restore to before the update',
                                'Roll back recently updated drivers in Device Manager',
                                'Uninstall recently installed software',
                                'Run sfc /scannow to check system files',
                                'Check manufacturer website for driver updates',
                                'Use Event Viewer to identify problematic driver file'
                            ]
                        }
                    },
                    'bsod-random': {
                        question: 'Random/Intermittent BSOD',
                        description: 'Random BSODs often indicate hardware failure or driver issues.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run Windows Memory Diagnostic or MemTest86+',
                                'Check hard drive health with CHKDSK or manufacturer tool',
                                'Monitor temperatures - overheating can cause BSODs',
                                'Update all drivers, especially graphics and chipset',
                                'Run SFC and DISM to repair system files',
                                'Check Event Viewer for patterns or specific error codes',
                                'Consider malware scan in Safe Mode'
                            ]
                        }
                    },
                    'black-screen': {
                        question: 'Black Screen Troubleshooting',
                        description: 'No display can be caused by hardware, drivers, or boot configuration.',
                        actions: [
                            { text: 'System Powers On (Fans/LEDs)', next: 'black-power-on' },
                            { text: 'No Power/No POST', next: 'no-power' }
                        ]
                    },
                    'black-power-on': {
                        question: 'System Powers On But No Display',
                        description: 'Hardware is getting power, issue is likely display-related or boot configuration.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check monitor connection and power',
                                'Try different video cable and port',
                                'Connect to external monitor if laptop',
                                'Remove and reseat graphics card',
                                'Boot into Safe Mode (F8 repeatedly during boot)',
                                'Access WinRE: Hold Shift while clicking Restart',
                                'Run Startup Repair from WinRE',
                                'Use bootrec /fixmbr and bootrec /fixboot in Command Prompt',
                                'Check for graphics driver issues in Safe Mode'
                            ]
                        }
                    },
                    'no-power': {
                        question: 'No Power or POST',
                        description: 'Hardware issue preventing boot process from starting.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check power cable and outlet',
                                'Verify power supply switch is on',
                                'Listen for POST beep codes',
                                'Reseat RAM modules',
                                'Remove all non-essential peripherals',
                                'Try different power cable',
                                'Check for motherboard standoff shorts',
                                'Test with known-good power supply',
                                'May require hardware replacement or professional service'
                            ]
                        }
                    },
                    'boot-loop': {
                        question: 'Boot Loop (Continuous Restart)',
                        description: 'System restarts before or during Windows loading.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Disable automatic restart: F8 > Disable automatic restart on system failure',
                                'Check for overheating - clean fans and heatsinks',
                                'Boot into Safe Mode and run System Restore',
                                'Run Startup Repair from WinRE',
                                'Check for recent Windows updates in Safe Mode, uninstall if needed',
                                'Run CHKDSK /F /R to check disk errors',
                                'Rebuild BCD: bootrec /rebuildbcd in Command Prompt',
                                'Consider Reset This PC if other options fail'
                            ]
                        }
                    },
                    'error-message': {
                        question: 'Boot Error Message',
                        description: 'Specific error messages provide clues to the problem.',
                        solution: {
                            title: 'Common Boot Errors & Solutions',
                            steps: [
                                '"BOOTMGR is missing": Run bootrec /fixmbr and bootrec /fixboot',
                                '"No bootable device": Check BIOS boot order, verify hard drive detected',
                                '"Operating System Not Found": Rebuild BCD with bootrec /rebuildbcd',
                                '"NTLDR is missing": Legacy Windows, use bootrec or recovery console',
                                '"Inaccessible Boot Device": Driver or hardware issue, use Last Known Good or Safe Mode',
                                '"SMART failure": Hard drive failing, backup data immediately and replace drive'
                            ]
                        }
                    }
                }
            },
            'slow-performance': {
                title: 'Slow Performance Troubleshooting',
                nodes: {
                    start: {
                        question: 'When does the slowness occur?',
                        description: 'Identifying when the issue happens helps narrow down the cause.',
                        actions: [
                            { text: 'During Startup/Boot', next: 'slow-startup' },
                            { text: 'All the Time', next: 'constant-slow' },
                            { text: 'With Specific Applications', next: 'app-specific' },
                            { text: 'Gradually Over Time', next: 'gradual' }
                        ]
                    },
                    'slow-startup': {
                        question: 'Slow Startup Performance',
                        description: 'Long boot times are often caused by startup programs or services.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Open Task Manager (Ctrl+Shift+Esc) > Startup tab',
                                'Disable unnecessary startup programs',
                                'Run msconfig > Services tab > Hide Microsoft services',
                                'Disable non-essential third-party services',
                                'Check for malware with Windows Defender or Malwarebytes',
                                'Run Disk Cleanup to remove temporary files',
                                'Defragment hard drive (HDD only, not SSD)',
                                'Consider enabling Fast Startup in Power Options',
                                'Update Windows and all drivers'
                            ]
                        }
                    },
                    'constant-slow': {
                        question: 'Constant Slow Performance',
                        description: 'Check resource usage to identify bottlenecks.',
                        actions: [
                            { text: 'High CPU Usage', next: 'high-cpu' },
                            { text: 'High Memory Usage', next: 'high-memory' },
                            { text: 'High Disk Usage', next: 'high-disk' }
                        ]
                    },
                    'high-cpu': {
                        question: 'High CPU Usage',
                        description: 'Identify which processes are consuming CPU resources.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Open Task Manager > Processes tab, sort by CPU',
                                'Identify high CPU processes',
                                'For "Windows Modules Installer Worker": Wait for updates to finish',
                                'For "Runtime Broker": Disable tips and suggestions in Settings',
                                'For "WMI Provider Host": Use Event Viewer to find WMI issues',
                                'Update or reinstall problematic applications',
                                'Check for malware and cryptominers',
                                'Ensure adequate cooling - check temperatures',
                                'Update BIOS and chipset drivers'
                            ]
                        }
                    },
                    'high-memory': {
                        question: 'High Memory Usage',
                        description: 'Memory leaks or insufficient RAM can cause slowdowns.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Open Task Manager > Performance tab, check memory usage',
                                'Identify memory-hungry processes in Processes tab',
                                'Close unnecessary programs and browser tabs',
                                'Disable Superfetch/SysMain service if on SSD',
                                'Increase virtual memory (pagefile) size',
                                'Run Windows Memory Diagnostic to check for bad RAM',
                                'Uninstall unnecessary programs',
                                'Check for memory leaks in specific applications',
                                'Consider upgrading RAM if consistently over 80% usage'
                            ]
                        }
                    },
                    'high-disk': {
                        question: 'High Disk Usage (100%)',
                        description: 'Disk bottleneck severely impacts overall performance.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Open Task Manager > Performance > Disk, check usage',
                                'Disable Windows Search temporarily: net stop "Windows Search"',
                                'Disable Superfetch: net stop sysmain',
                                'Run CHKDSK /F /R to check for disk errors',
                                'Update storage controller drivers',
                                'Disable Windows tips: Settings > System > Notifications',
                                'Check for malware performing disk operations',
                                'Consider upgrading to SSD if using HDD',
                                'Run Disk Cleanup and remove temp files'
                            ]
                        }
                    },
                    'app-specific': {
                        question: 'Application-Specific Slowness',
                        description: 'Issue is isolated to certain programs.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update the application to latest version',
                                'Check application requirements vs system specs',
                                'Clear application cache and temporary files',
                                'Reinstall the application',
                                'Check Event Viewer > Application logs for errors',
                                'Run application as administrator',
                                'Disable antivirus exclusions if false positive',
                                'Check for compatibility issues (run in compatibility mode)',
                                'Verify adequate free disk space'
                            ]
                        }
                    },
                    'gradual': {
                        question: 'Gradual Performance Degradation',
                        description: 'System has become slower over time.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run Disk Cleanup to remove temporary files',
                                'Uninstall unused programs via Programs and Features',
                                'Run full antivirus and anti-malware scan',
                                'Defragment HDD (not needed for SSD)',
                                'Disable visual effects: System > Advanced > Performance Settings',
                                'Check for Windows updates and install',
                                'Run SFC /scannow and DISM for system file integrity',
                                'Review startup programs and disable unnecessary ones',
                                'Consider clean Windows installation if severely degraded'
                            ]
                        }
                    }
                }
            },
            'app-crash': {
                title: 'Application Crash Troubleshooting',
                nodes: {
                    start: {
                        question: 'How does the application crash?',
                        description: 'Understanding the crash behavior helps identify the root cause.',
                        actions: [
                            { text: 'Immediate Crash on Launch', next: 'crash-launch' },
                            { text: 'Freezes Then Closes', next: 'freeze-close' },
                            { text: 'Random Crashes During Use', next: 'random-crash' },
                            { text: 'Error Message Appears', next: 'error-crash' }
                        ]
                    },
                    'crash-launch': {
                        question: 'Crashes Immediately on Launch',
                        description: 'Application cannot initialize properly.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run application as administrator (right-click > Run as admin)',
                                'Check Event Viewer > Application logs for crash details',
                                'Verify all prerequisites installed (.NET, Visual C++, DirectX)',
                                'Update application to latest version',
                                'Reinstall application (uninstall first)',
                                'Check compatibility mode (right-click > Properties > Compatibility)',
                                'Disable antivirus temporarily to test for false positive',
                                'Ensure user account has proper permissions',
                                'Check for corrupted user profile - try different user account'
                            ]
                        }
                    },
                    'freeze-close': {
                        question: 'Application Freezes Then Closes',
                        description: 'Application hangs and becomes unresponsive before crashing.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check Task Manager during freeze for resource usage',
                                'Update graphics drivers (for GUI applications)',
                                'Increase virtual memory if memory usage is high',
                                'Disable hardware acceleration in application settings',
                                'Clear application cache and temporary files',
                                'Check Event Viewer for application hang events (Event ID 1002)',
                                'Run application in clean boot environment',
                                'Test with different user profile',
                                'Monitor temperatures - overheating can cause freezes'
                            ]
                        }
                    },
                    'random-crash': {
                        question: 'Random Crashes During Use',
                        description: 'Unpredictable crashes without clear pattern.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update application and Windows to latest versions',
                                'Check Windows Reliability Monitor for crash patterns',
                                'Review Event Viewer for application fault events',
                                'Test with all plugins/extensions disabled',
                                'Run memory test - RAM issues cause random crashes',
                                'Update all system drivers, especially graphics',
                                'Disable background programs that may conflict',
                                'Check for application-specific crash logs',
                                'Reinstall with latest version from official source'
                            ]
                        }
                    },
                    'error-crash': {
                        question: 'Specific Error Message Displayed',
                        description: 'Error messages provide valuable troubleshooting information.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Document exact error message and error code',
                                'Search error code on vendor knowledge base',
                                'For DLL errors: Reinstall affected DLL or application',
                                'For "Access Denied": Check file/folder permissions',
                                'For "Missing component": Install required dependencies',
                                'For ".NET errors": Repair or reinstall .NET Framework',
                                'For "Out of memory": Close other apps or increase RAM',
                                'Check Event Viewer for additional context',
                                'Contact vendor support with error details if unresolved'
                            ]
                        }
                    }
                }
            },
            'network': {
                title: 'Network Connectivity Troubleshooting',
                nodes: {
                    start: {
                        question: 'What is the network issue?',
                        description: 'Identify the specific network problem you are experiencing.',
                        actions: [
                            { text: 'No Internet Connection', next: 'no-internet' },
                            { text: 'Limited/No Connectivity', next: 'limited' },
                            { text: 'Slow Network Speed', next: 'slow-network' },
                            { text: 'Cannot Connect to Specific Sites', next: 'specific-sites' }
                        ]
                    },
                    'no-internet': {
                        question: 'No Internet Connection',
                        description: 'Computer shows network connected but no internet access.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run Network Troubleshooter: Settings > Network > Status > Troubleshoot',
                                'Check physical connections (cable, WiFi signal)',
                                'Restart modem and router (30-second power cycle)',
                                'Flush DNS: ipconfig /flushdns',
                                'Renew IP: ipconfig /release then ipconfig /renew',
                                'Reset Winsock: netsh winsock reset',
                                'Reset TCP/IP: netsh int ip reset',
                                'Check DNS settings (try 8.8.8.8 Google DNS)',
                                'Update network adapter drivers',
                                'Disable VPN/proxy if enabled',
                                'Check firewall settings'
                            ]
                        }
                    },
                    'limited': {
                        question: 'Limited or No Connectivity',
                        description: 'Yellow triangle on network icon, cannot obtain IP address.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check DHCP server is running on router',
                                'Release and renew IP: ipconfig /release, ipconfig /renew',
                                'Verify network adapter shows "DHCP Enabled: Yes" (ipconfig /all)',
                                'Restart DHCP Client service: services.msc',
                                'Forget and reconnect to WiFi network',
                                'Manually assign static IP if DHCP unavailable',
                                'Check router for IP address pool exhaustion',
                                'Update network adapter driver',
                                'Reset network adapter in Device Manager',
                                'Reset network settings: Settings > Network > Network reset'
                            ]
                        }
                    },
                    'slow-network': {
                        question: 'Slow Network Performance',
                        description: 'Network connection is slow or intermittent.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run speed test (speedtest.net) to verify actual speed',
                                'Check Task Manager > Performance > Network for bandwidth usage',
                                'Identify bandwidth-hogging applications',
                                'Check for malware performing network activity',
                                'Update network adapter drivers',
                                'Change WiFi channel if interference detected',
                                'Move closer to WiFi router or use 5GHz band',
                                'Disable Large Send Offload in adapter advanced properties',
                                'Check Quality of Service (QoS) settings on router',
                                'Scan for viruses and malware',
                                'Contact ISP if speed is below subscribed rate'
                            ]
                        }
                    },
                    'specific-sites': {
                        question: 'Cannot Access Specific Websites',
                        description: 'Some websites work, others do not.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Clear browser cache and cookies',
                                'Try different browser to isolate issue',
                                'Flush DNS cache: ipconfig /flushdns',
                                'Change DNS servers (8.8.8.8, 8.8.4.4)',
                                'Check hosts file for blocks: C:\\Windows\\System32\\drivers\\etc\\hosts',
                                'Disable browser extensions temporarily',
                                'Check firewall for site blocking rules',
                                'Verify parental controls/content filtering not active',
                                'Try accessing via VPN to test if ISP blocking',
                                'Check if website is down (downforeveryoneorjustme.com)'
                            ]
                        }
                    }
                }
            },
            'printing': {
                title: 'Printing Problems Troubleshooting',
                nodes: {
                    start: {
                        question: 'What printing issue are you experiencing?',
                        description: 'Select the problem that best matches your situation.',
                        actions: [
                            { text: 'Printer Offline/Not Responding', next: 'offline' },
                            { text: 'Print Job Stuck in Queue', next: 'stuck-queue' },
                            { text: 'Poor Print Quality', next: 'quality' },
                            { text: 'Cannot Find/Install Printer', next: 'cant-find' }
                        ]
                    },
                    'offline': {
                        question: 'Printer Shows Offline',
                        description: 'Printer status shows offline even though it is powered on.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Verify printer is powered on and connected',
                                'Check USB cable or network connection',
                                'Right-click printer > See what\'s printing > Printer menu',
                                'Uncheck "Use Printer Offline" if enabled',
                                'Restart Print Spooler service: services.msc',
                                'Remove and re-add printer in Settings',
                                'Update printer driver from manufacturer website',
                                'For network printers: ping printer IP to verify connectivity',
                                'Disable SNMP status in printer properties > Ports',
                                'Check firewall not blocking printer communication'
                            ]
                        }
                    },
                    'stuck-queue': {
                        question: 'Print Jobs Stuck in Queue',
                        description: 'Documents remain in print queue and won\'t print or cancel.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Open print queue: right-click printer > See what\'s printing',
                                'Try to cancel all documents: Printer menu > Cancel All Documents',
                                'Restart Print Spooler service:',
                                '  - Open services.msc',
                                '  - Find "Print Spooler", right-click > Restart',
                                'Clear spooler manually if service restart fails:',
                                '  - Stop Print Spooler service',
                                '  - Navigate to C:\\Windows\\System32\\spool\\PRINTERS',
                                '  - Delete all files in folder',
                                '  - Start Print Spooler service',
                                'Check printer for paper jams or error lights',
                                'Reinstall printer driver if problem persists'
                            ]
                        }
                    },
                    'quality': {
                        question: 'Poor Print Quality',
                        description: 'Prints are faded, streaked, smeared, or have other quality issues.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check ink/toner levels in printer software',
                                'Run printer cleaning utility (varies by manufacturer)',
                                'Run print head alignment utility',
                                'For laser: Inspect and clean drum and fuser',
                                'For inkjet: Clean print head manually if automatic fails',
                                'Replace low or empty ink/toner cartridges',
                                'Use correct paper type setting for media being used',
                                'Check for driver issues - update to latest version',
                                'Verify print quality settings not set to "draft" or "economy"',
                                'For persistent issues: Replace drum/print head (hardware issue)'
                            ]
                        }
                    },
                    'cant-find': {
                        question: 'Cannot Find or Install Printer',
                        description: 'Windows cannot detect printer during installation.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'For USB printer: Try different USB port and cable',
                                'For network printer: Verify printer and computer on same network',
                                'Manually add printer: Settings > Devices > Printers > Add printer',
                                'Use "Add a printer using TCP/IP address" for network printer',
                                'Download driver from manufacturer website (not Windows Update)',
                                'Temporarily disable firewall to test',
                                'For older printers: Check compatibility mode for driver',
                                'Verify printer sharing enabled if connecting to shared printer',
                                'Check router can see printer on network (DHCP client list)',
                                'Factory reset printer and reconfigure network settings'
                            ]
                        }
                    }
                }
            },
            'display': {
                title: 'Display Issues Troubleshooting',
                nodes: {
                    start: {
                        question: 'What display problem are you experiencing?',
                        description: 'Identify your specific display issue.',
                        actions: [
                            { text: 'No Display/Black Screen', next: 'no-display' },
                            { text: 'Distorted/Corrupted Graphics', next: 'distorted' },
                            { text: 'Wrong Resolution/Scaling', next: 'resolution' },
                            { text: 'Flickering Display', next: 'flickering' }
                        ]
                    },
                    'no-display': {
                        question: 'No Display Output',
                        description: 'Monitor shows no signal or remains black.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Verify monitor is powered on and connected to power',
                                'Check video cable connections at both ends',
                                'Try different video cable and port (HDMI, DisplayPort, VGA)',
                                'Test with different monitor if available',
                                'For laptops: Try Fn+F4/F5 to toggle display output',
                                'Check for POST beep codes indicating hardware issue',
                                'Reseat graphics card if desktop with dedicated GPU',
                                'Try onboard graphics (if available) to isolate GPU issue',
                                'Boot into Safe Mode to test if driver issue',
                                'Reset BIOS/UEFI to defaults'
                            ]
                        }
                    },
                    'distorted': {
                        question: 'Distorted or Corrupted Graphics',
                        description: 'Screen shows artifacts, lines, or distorted images.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update graphics drivers from manufacturer website (NVIDIA, AMD, Intel)',
                                'Boot into Safe Mode to test if driver-related',
                                'If Safe Mode normal: Uninstall GPU driver with DDU, reinstall fresh',
                                'Check monitor cable - replace if damaged',
                                'Test with different monitor to isolate hardware',
                                'Check GPU temperatures - overheating causes artifacts',
                                'For desktops: Reseat graphics card',
                                'Reduce GPU overclock if applied',
                                'Test with different PCIe slot if available',
                                'GPU hardware failure if artifacts persist - may need replacement'
                            ]
                        }
                    },
                    'resolution': {
                        question: 'Incorrect Resolution or Scaling',
                        description: 'Display resolution wrong or text/icons improperly sized.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update graphics drivers to latest version',
                                'Right-click desktop > Display settings',
                                'Set resolution to recommended (native) setting',
                                'Adjust scaling: Settings > Display > Scale and layout',
                                'For multiple monitors: Identify monitors and set individual resolutions',
                                'Check monitor is using correct connection (digital vs analog)',
                                'Verify monitor detected correctly in Device Manager',
                                'For older monitors: Install monitor driver from manufacturer',
                                'Check graphics card supports desired resolution',
                                'Use GPU control panel (NVIDIA/AMD) for advanced settings'
                            ]
                        }
                    },
                    'flickering': {
                        question: 'Display Flickering',
                        description: 'Screen flickers, flashes, or brightness varies.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update graphics drivers',
                                'Check refresh rate: Settings > Display > Advanced display',
                                'Set refresh rate to 60Hz or monitor maximum',
                                'Try different video cable',
                                'Uninstall problematic apps (known causes: Norton, iCloud)',
                                'Disable hardware acceleration in applications showing flicker',
                                'Check for Windows updates',
                                'Boot into Safe Mode - if no flicker, likely driver or software',
                                'Adjust monitor brightness/contrast settings',
                                'Check for electrical interference (speakers, phones near monitor)',
                                'For persistent flicker: May be monitor backlight failure (hardware)'
                            ]
                        }
                    }
                }
            },
            'audio': {
                title: 'Audio Problems Troubleshooting',
                nodes: {
                    start: {
                        question: 'What audio issue are you experiencing?',
                        description: 'Select the audio problem you are facing.',
                        actions: [
                            { text: 'No Sound At All', next: 'no-sound' },
                            { text: 'Distorted/Crackling Audio', next: 'distorted-audio' },
                            { text: 'Low Volume/Quiet Sound', next: 'low-volume' },
                            { text: 'Audio Device Not Detected', next: 'not-detected' }
                        ]
                    },
                    'no-sound': {
                        question: 'No Sound Output',
                        description: 'No audio is playing from speakers or headphones.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check volume level - unmute and increase volume',
                                'Verify correct playback device: Right-click speaker icon > Sounds',
                                'Set correct device as default in Sound settings',
                                'Run Audio Troubleshooter: Settings > Update & Security > Troubleshoot',
                                'Check physical connections - reseat cables',
                                'Update audio drivers: Device Manager > Sound controllers',
                                'Restart Windows Audio service: services.msc',
                                'Check audio device not disabled in Device Manager',
                                'Test with different speakers/headphones',
                                'Uninstall and reinstall audio driver',
                                'Check BIOS audio settings enabled'
                            ]
                        }
                    },
                    'distorted-audio': {
                        question: 'Distorted, Crackling, or Popping Audio',
                        description: 'Audio plays but sounds distorted or has static.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Update audio drivers from manufacturer website',
                                'Right-click speaker icon > Sounds > Playback tab',
                                'Select device > Properties > Advanced tab',
                                'Try different sample rate (44100 Hz or 48000 Hz)',
                                'Disable audio enhancements: Properties > Enhancements > Disable all',
                                'Check for DPC latency issues (use LatencyMon tool)',
                                'Update chipset and USB drivers',
                                'Disable power management: Device Manager > Audio device > Properties',
                                'Uncheck "Allow computer to turn off device"',
                                'Test with different audio port or USB port',
                                'Check CPU usage - high CPU can cause audio issues'
                            ]
                        }
                    },
                    'low-volume': {
                        question: 'Low Volume or Quiet Sound',
                        description: 'Audio is very quiet even at maximum volume.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check system volume at 100%',
                                'Check application-specific volume (browser, media player)',
                                'Right-click speaker icon > Open Volume Mixer',
                                'Increase all individual application volumes',
                                'Right-click speaker icon > Sounds > Playback',
                                'Select device > Properties > Levels tab > Increase to 100',
                                'Enable Loudness Equalization: Properties > Enhancements',
                                'Update audio drivers',
                                'Check for physical volume control on speakers/headphones',
                                'Test with different audio device',
                                'Verify audio not limited by parental controls or policies'
                            ]
                        }
                    },
                    'not-detected': {
                        question: 'Audio Device Not Detected',
                        description: 'Windows does not recognize speakers, headphones, or audio device.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Check physical connection - try different port',
                                'For USB audio: Try different USB port',
                                'For Bluetooth: Pair device in Settings > Devices > Bluetooth',
                                'Check Device Manager for audio devices with yellow exclamation',
                                'Uninstall and scan for hardware changes in Device Manager',
                                'Update audio drivers from manufacturer website',
                                'Enable disabled audio devices: Device Manager > View > Show hidden devices',
                                'Check BIOS audio settings not disabled',
                                'Run Hardware and Devices troubleshooter',
                                'For front panel audio: Check motherboard front panel connector',
                                'Test device on different computer to verify hardware functional'
                            ]
                        }
                    }
                }
            },
            'updates': {
                title: 'Windows Update Failures Troubleshooting',
                nodes: {
                    start: {
                        question: 'What Windows Update issue are you experiencing?',
                        description: 'Identify the specific update problem.',
                        actions: [
                            { text: 'Update Download/Install Fails', next: 'install-fail' },
                            { text: 'Update Stuck/Frozen', next: 'stuck' },
                            { text: 'Update Causes Boot Issues', next: 'boot-issue' },
                            { text: 'Specific Error Code', next: 'error-code' }
                        ]
                    },
                    'install-fail': {
                        question: 'Update Installation Fails',
                        description: 'Windows updates fail to download or install.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Run Windows Update Troubleshooter: Settings > Update & Security',
                                'Restart Windows Update service: services.msc',
                                'Clear update cache: Stop wuauserv service',
                                'Delete contents of C:\\Windows\\SoftwareDistribution\\Download',
                                'Restart wuauserv service and retry update',
                                'Run DISM: DISM /Online /Cleanup-Image /RestoreHealth',
                                'Run SFC: sfc /scannow',
                                'Ensure adequate free disk space (20GB+ recommended)',
                                'Temporarily disable antivirus during update',
                                'Use Windows Update Assistant for feature updates',
                                'Check Event Viewer for specific error details'
                            ]
                        }
                    },
                    'stuck': {
                        question: 'Update Stuck or Frozen',
                        description: 'Windows update process appears frozen at percentage.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Wait at least 2-3 hours - some updates are very large',
                                'Check disk activity LED - if active, update is processing',
                                'If truly frozen: Force restart (hold power button)',
                                'Windows should automatically recover and rollback',
                                'After restart: Run update troubleshooter',
                                'Try installing updates individually if multiple pending',
                                'Use Windows Update Assistant for manual update',
                                'Check Windows Update log: C:\\Windows\\Logs\\WindowsUpdate',
                                'Boot into Safe Mode and retry update',
                                'As last resort: Perform in-place upgrade with installation media'
                            ]
                        }
                    },
                    'boot-issue': {
                        question: 'Update Causes Boot Problems',
                        description: 'System won\'t boot after Windows update.',
                        solution: {
                            title: 'Solution Steps',
                            steps: [
                                'Boot into WinRE (may happen automatically after failed boots)',
                                'Select Troubleshoot > Advanced options > Uninstall Updates',
                                'Choose "Uninstall latest quality update" or "feature update"',
                                'If successful, boot normally and pause updates temporarily',
                                'Run System Restore from WinRE to before update',
                                'Use Startup Repair if boot files corrupted',
                                'From WinRE Command Prompt, run: bootrec /fixboot',
                                'Check manufacturer website for BIOS update (may fix compatibility)',
                                'After resolving: Re-attempt update or wait for newer version',
                                'Report issue via Feedback Hub if persistent'
                            ]
                        }
                    },
                    'error-code': {
                        question: 'Specific Windows Update Error Code',
                        description: 'Update fails with error code (e.g., 0x80070002).',
                        solution: {
                            title: 'Common Error Codes & Solutions',
                            steps: [
                                '0x80070002: Missing files - Run DISM and SFC, clear update cache',
                                '0x80070003: Path not found - Check system drive errors with CHKDSK',
                                '0x8007000E: Out of memory - Free up RAM and disk space',
                                '0x80070422: Service disabled - Enable Windows Update service',
                                '0x80070643: .NET update failed - Repair .NET Framework',
                                '0x80240034: File not signed - Reset update components',
                                '0x80244019: Download failed - Check internet connection and proxy',
                                '0xC1900101: Driver incompatibility - Update or remove problematic driver',
                                'For any error: Search Microsoft support with exact error code',
                                'Use Update Catalog (catalog.update.microsoft.com) for manual install'
                            ]
                        }
                    }
                }
            }
        };

        // Flowchart Engine
        let currentFlowchart = null;
        let currentNode = 'start';
        let breadcrumbPath = [];

        const flowchartOptions = document.querySelectorAll('.flowchart-option');
        const flowchartDisplay = document.getElementById('flowchart-display');
        const flowchartContent = document.getElementById('flowchart-content');
        const breadcrumbDiv = document.getElementById('breadcrumb');

        flowchartOptions.forEach(option => {
            option.addEventListener('click', () => {
                const flowchartType = option.dataset.flowchart;
                loadFlowchart(flowchartType);

                flowchartOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
            });
        });

        function loadFlowchart(type) {
            currentFlowchart = flowcharts[type];
            currentNode = 'start';
            breadcrumbPath = [currentFlowchart.title];

            flowchartDisplay.style.display = 'block';
            renderNode();
        }

        function renderNode() {
            const node = currentFlowchart.nodes[currentNode];

            // Update breadcrumb
            breadcrumbDiv.innerHTML = breadcrumbPath.map((item, index) => {
                const isLast = index === breadcrumbPath.length - 1;
                return `<span class="breadcrumb-item ${isLast ? 'current' : ''}">${item}</span>
                        ${!isLast ? '<span class="breadcrumb-arrow"></span>' : ''}`;
            }).join('');

            // Render node content
            let html = `
                <div class="flowchart-node">
                    <div class="node-question">${node.question}</div>
                    <div class="node-description">${node.description}</div>
            `;

            if (node.actions) {
                html += '<div class="node-actions">';
                node.actions.forEach(action => {
                    html += `<button class="node-btn" data-next="${action.next}">${action.text}</button>`;
                });
                html += '</div>';
            }

            if (node.solution) {
                html += `
                    <div class="solution-box">
                        <h4>${node.solution.title}</h4>
                        <ul>
                            ${node.solution.steps.map(step => `<li>${step}</li>`).join('')}
                        </ul>
                    </div>
                `;
            }

            html += '</div>';

            // Add reset button
            if (breadcrumbPath.length > 1) {
                html += '<button class="reset-btn" onclick="resetFlowchart()"> Start Over</button>';
            }

            flowchartContent.innerHTML = html;

            // Add event listeners to action buttons
            document.querySelectorAll('.node-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const nextNode = btn.dataset.next;
                    navigateToNode(nextNode, btn.textContent);
                });
            });
        }

        function navigateToNode(nodeId, breadcrumbText) {
            currentNode = nodeId;
            breadcrumbPath.push(breadcrumbText);
            renderNode();
        }

        function resetFlowchart() {
            currentNode = 'start';
            breadcrumbPath = [currentFlowchart.title];
            renderNode();
        }

        // Scenario Simulator
        const scenarios = [
            {
                id: 1,
                title: 'Case 1: Laptop Won\'t Boot After Windows Update',
                difficulty: 'medium',
                description: 'A user reports their laptop shows a black screen after installing last night\'s Windows update. The laptop powers on and shows the manufacturer logo, but then displays a black screen with a cursor.',
                flowchart: 'boot-failure',
                startNode: 'boot-issue',
                expectedSolution: 'Uninstall latest Windows update from WinRE'
            },
            {
                id: 2,
                title: 'Case 2: Computer Running Extremely Slow',
                difficulty: 'easy',
                description: 'A desktop computer that was working fine yesterday is now extremely slow. Task Manager shows disk usage at 100% constantly. The user hasn\'t installed any new software recently.',
                flowchart: 'slow-performance',
                startNode: 'high-disk',
                expectedSolution: 'Disable Windows Search and Superfetch services'
            },
            {
                id: 3,
                title: 'Case 3: Excel Crashes When Opening Large Files',
                difficulty: 'easy',
                description: 'Microsoft Excel crashes immediately when attempting to open files larger than 10MB. Smaller files open normally. The crash started after a recent Office update.',
                flowchart: 'app-crash',
                startNode: 'freeze-close',
                expectedSolution: 'Uninstall recent Office update or repair Office installation'
            },
            {
                id: 4,
                title: 'Case 4: WiFi Connected But No Internet',
                difficulty: 'medium',
                description: 'User\'s laptop shows connected to WiFi with full signal strength, but cannot access any websites. Other devices on the same network work fine. Yellow exclamation mark appears on network icon.',
                flowchart: 'network',
                startNode: 'no-internet',
                expectedSolution: 'Flush DNS and reset TCP/IP stack'
            },
            {
                id: 5,
                title: 'Case 5: BSOD with DRIVER_IRQL_NOT_LESS_OR_EQUAL',
                difficulty: 'hard',
                description: 'Desktop receives blue screen crashes with error "DRIVER_IRQL_NOT_LESS_OR_EQUAL" randomly throughout the day. User recently upgraded graphics card. Crashes occur during gaming and video editing.',
                flowchart: 'boot-failure',
                startNode: 'bsod-hardware',
                expectedSolution: 'Update graphics drivers or remove GPU to test'
            }
        ];

        function renderScenarios() {
            const container = document.getElementById('scenario-container');
            let html = '';

            scenarios.forEach((scenario, index) => {
                const difficultyClass = scenario.difficulty === 'easy' ? 'difficulty-easy' :
                                       scenario.difficulty === 'medium' ? 'difficulty-medium' :
                                       'difficulty-hard';

                html += `
                    <div class="scenario-card">
                        <div class="scenario-header">
                            <h3 class="scenario-title">${scenario.title}</h3>
                            <span class="difficulty-badge ${difficultyClass}">${scenario.difficulty.toUpperCase()}</span>
                        </div>
                        <div class="scenario-description">${scenario.description}</div>
                        <button class="btn-primary" onclick="startScenario(${index})">Start Troubleshooting </button>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function startScenario(index) {
            const scenario = scenarios[index];

            // Switch to flowchart tab
            document.querySelector('[data-tab="flowcharts"]').click();

            // Load appropriate flowchart
            setTimeout(() => {
                const option = document.querySelector(`[data-flowchart="${scenario.flowchart}"]`);
                option.click();

                // Show hint
                alert(`Scenario loaded! Start by analyzing the symptoms and follow the troubleshooting steps.\n\nHint: ${scenario.expectedSolution}`);
            }, 100);
        }

        // Event Viewer Simulator
        const eventLogs = [
            {
                level: 'error',
                source: 'Application Error',
                time: '2025-12-11 09:23:15',
                eventId: 1000,
                message: 'Faulting application name: chrome.exe, version: 120.0.6099.109, time stamp: 0x656d8f2a. Faulting module name: ntdll.dll, version: 10.0.19041.3636, time stamp: 0x65b8a5e3'
            },
            {
                level: 'warning',
                source: 'Disk',
                time: '2025-12-11 08:45:32',
                eventId: 51,
                message: 'An error was detected on device \\Device\\Harddisk0\\DR0 during a paging operation. This indicates potential disk failure. Run CHKDSK to verify disk integrity.'
            },
            {
                level: 'error',
                source: 'Service Control Manager',
                time: '2025-12-11 08:15:01',
                eventId: 7000,
                message: 'The Windows Update service failed to start due to the following error: The service did not respond to the start or control request in a timely fashion.'
            },
            {
                level: 'info',
                source: 'Microsoft-Windows-Kernel-Power',
                time: '2025-12-11 08:12:44',
                eventId: 1,
                message: 'The system has returned from a low power state. Sleep Time: 2025-12-10T23:45:12.987654321Z, Wake Time: 2025-12-11T08:12:44.123456789Z'
            },
            {
                level: 'warning',
                source: 'Microsoft-Windows-WLAN-AutoConfig',
                time: '2025-12-11 07:55:18',
                eventId: 4001,
                message: 'WLAN Extensibility Module has stopped. Module Path: C:\\Windows\\System32\\IpsmSnap.dll. This may cause wireless connectivity issues.'
            },
            {
                level: 'error',
                source: 'DCOM',
                time: '2025-12-11 07:22:09',
                eventId: 10016,
                message: 'The application-specific permission settings do not grant Local Activation permission for the COM Server application with CLSID {C2F03A33-21F5-47FA-B4BB-156362A2F239} to the user NT AUTHORITY\\LOCAL SERVICE SID (S-1-5-19).'
            },
            {
                level: 'info',
                source: 'Microsoft-Windows-WindowsUpdateClient',
                time: '2025-12-11 06:30:15',
                eventId: 19,
                message: 'Installation Successful: Windows successfully installed the following update: Security Intelligence Update for Microsoft Defender Antivirus - KB2267602 (Version 1.407.221.0)'
            },
            {
                level: 'warning',
                source: 'Application Hang',
                time: '2025-12-10 18:34:22',
                eventId: 1002,
                message: 'The program outlook.exe version 16.0.17328.20068 stopped interacting with Windows and was closed. The application was unresponsive for 10 seconds.'
            },
            {
                level: 'error',
                source: 'Ntfs',
                time: '2025-12-10 15:12:05',
                eventId: 55,
                message: 'The file system structure on the disk is corrupt and unusable. Please run the chkdsk utility on the volume \\Device\\HarddiskVolume3.'
            },
            {
                level: 'info',
                source: 'Microsoft-Windows-Kernel-General',
                time: '2025-12-10 12:08:33',
                eventId: 16,
                message: 'The access history in hive \\?\\C:\\Users\\Default\\NTUSER.DAT was cleared updating 234 keys and creating 0 modified pages.'
            },
            {
                level: 'warning',
                source: 'DistributedCOM',
                time: '2025-12-10 09:45:19',
                eventId: 10010,
                message: 'The server {AB8902B4-09CA-4BB6-B78D-A8F59079A8D5} did not register with DCOM within the required timeout.'
            },
            {
                level: 'error',
                source: 'nvlddmkm',
                time: '2025-12-10 08:22:44',
                eventId: 14,
                message: 'The description for Event ID 14 from source nvlddmkm cannot be found. Graphics driver nvlddmkm stopped responding and has successfully recovered. Consider updating graphics drivers.'
            }
        ];

        function renderEventViewer() {
            const eventList = document.getElementById('event-list');
            renderEvents('all');

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const level = btn.dataset.level;

                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');

                    renderEvents(level);
                });
            });
        }

        function renderEvents(filter) {
            const eventList = document.getElementById('event-list');
            const filtered = filter === 'all' ? eventLogs : eventLogs.filter(e => e.level === filter);

            let html = '';
            filtered.forEach(event => {
                const levelClass = `level-${event.level}`;
                html += `
                    <div class="event-entry">
                        <div class="event-header">
                            <span class="event-level ${levelClass}">${event.level.toUpperCase()}</span>
                            <span class="event-time">${event.time}</span>
                        </div>
                        <div class="event-source">${event.source} (Event ID: ${event.eventId})</div>
                        <div class="event-message">${event.message}</div>
                    </div>
                `;
            });

            eventList.innerHTML = html || '<div style="padding: 30px; text-align: center; color: var(--text-secondary);">No events match this filter</div>';
        }

        // Quiz System
        const quizQuestions = [
            {
                question: 'A user reports their computer displays "BOOTMGR is missing" on startup. What is the FIRST step you should take?',
                options: [
                    'Reinstall Windows',
                    'Run bootrec /fixmbr and bootrec /fixboot from WinRE Command Prompt',
                    'Replace the hard drive',
                    'Update the BIOS'
                ],
                correct: 1,
                explanation: 'The "BOOTMGR is missing" error indicates boot sector corruption. The first step is to repair the Master Boot Record (MBR) and boot sector using bootrec commands from Windows Recovery Environment. This is a non-destructive fix that often resolves the issue without data loss.'
            },
            {
                question: 'Which troubleshooting methodology step involves determining if any changes occurred recently?',
                options: [
                    'Establish a theory of probable cause',
                    'Identify the problem',
                    'Test the theory',
                    'Document findings'
                ],
                correct: 1,
                explanation: 'During the "Identify the problem" step, you gather information from users, ask questions, and determine if any changes occurred recently. This information is crucial for understanding what might have triggered the issue.'
            },
            {
                question: 'A computer shows 100% disk usage constantly in Task Manager. Which service should you try disabling FIRST?',
                options: [
                    'Print Spooler',
                    'Windows Update',
                    'Windows Search (or Superfetch/SysMain)',
                    'DHCP Client'
                ],
                correct: 2,
                explanation: 'Windows Search (and Superfetch/SysMain on newer systems) are common causes of 100% disk usage, especially on systems with HDDs. Disabling these services is a quick first step that often resolves the issue without affecting critical functionality.'
            },
            {
                question: 'What command should you run BEFORE using System File Checker (sfc /scannow)?',
                options: [
                    'chkdsk /f',
                    'DISM /Online /Cleanup-Image /RestoreHealth',
                    'bootrec /rebuildbcd',
                    'ipconfig /flushdns'
                ],
                correct: 1,
                explanation: 'DISM (Deployment Image Servicing and Management) should be run before SFC because it repairs the Windows component store that SFC uses to replace corrupted files. If the component store is corrupted, SFC cannot properly repair system files.'
            },
            {
                question: 'A user cannot access the internet but shows "Connected" to WiFi. What command flushes the DNS cache?',
                options: [
                    'ipconfig /release',
                    'ipconfig /renew',
                    'ipconfig /flushdns',
                    'netsh winsock reset'
                ],
                correct: 2,
                explanation: 'ipconfig /flushdns clears the DNS resolver cache, which can resolve issues where the computer has cached incorrect or outdated DNS entries preventing internet access despite being connected to the network.'
            },
            {
                question: 'In Event Viewer, what does a WARNING level event indicate?',
                options: [
                    'Critical system failure requiring immediate shutdown',
                    'Normal informational event',
                    'Potential problem that may require attention',
                    'Security breach detected'
                ],
                correct: 2,
                explanation: 'Warning events indicate potential problems that may not be immediately critical but could lead to future issues. Examples include low disk space, driver issues, or performance degradation. They require attention but are less urgent than errors.'
            },
            {
                question: 'Which Safe Mode option loads with networking capabilities?',
                options: [
                    'Safe Mode',
                    'Safe Mode with Networking',
                    'Safe Mode with Command Prompt',
                    'Enable Low-Resolution Video'
                ],
                correct: 1,
                explanation: 'Safe Mode with Networking loads minimal drivers including network drivers, allowing you to access the internet to download drivers, updates, or tools while troubleshooting. Standard Safe Mode does not load network drivers.'
            },
            {
                question: 'A print job is stuck in the queue and won\'t cancel. After stopping the Print Spooler service, which folder should you clear?',
                options: [
                    'C:\\Windows\\Temp',
                    'C:\\Windows\\System32\\spool\\PRINTERS',
                    'C:\\Windows\\Prefetch',
                    'C:\\ProgramData\\Microsoft\\Windows\\Printer'
                ],
                correct: 1,
                explanation: 'The C:\\Windows\\System32\\spool\\PRINTERS folder contains print job files. When jobs are stuck, stopping the Print Spooler service and deleting files from this folder, then restarting the service, clears the queue and resolves the issue.'
            },
            {
                question: 'What does the CompTIA troubleshooting methodology recommend doing after verifying full system functionality?',
                options: [
                    'Restart the computer',
                    'Document findings, actions, and outcomes',
                    'Establish a new theory',
                    'Identify new problems'
                ],
                correct: 1,
                explanation: 'The final step in the 6-step CompTIA troubleshooting methodology is to document findings, actions, and outcomes. Documentation helps build a knowledge base, ensures accountability, and assists with future similar issues.'
            },
            {
                question: 'A BSOD displays error code "DRIVER_IRQL_NOT_LESS_OR_EQUAL". This most likely indicates:',
                options: [
                    'Hard drive failure',
                    'Faulty driver or driver conflict',
                    'Power supply issue',
                    'CPU overheating'
                ],
                correct: 1,
                explanation: 'DRIVER_IRQL_NOT_LESS_OR_EQUAL is a common BSOD error that indicates a driver accessed memory at an improper IRQL level. This is typically caused by faulty, incompatible, or outdated drivers. The solution involves updating, rolling back, or removing the problematic driver.'
            }
        ];

        let quizAnswers = new Array(quizQuestions.length).fill(null);

        function renderQuiz() {
            const container = document.getElementById('quiz-container');
            let html = '';

            quizQuestions.forEach((q, index) => {
                html += `
                    <div class="quiz-question">
                        <div class="question-header">
                            <span class="question-number">Question ${index + 1} of ${quizQuestions.length}</span>
                        </div>
                        <div class="question-text">${q.question}</div>
                        <div class="answer-options">
                            ${q.options.map((option, optIndex) => `
                                <div class="answer-option" data-question="${index}" data-answer="${optIndex}">
                                    ${String.fromCharCode(65 + optIndex)}. ${option}
                                </div>
                            `).join('')}
                        </div>
                        <div class="explanation" id="explanation-${index}">
                            <strong>Explanation:</strong> ${q.explanation}
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;

            // Add click handlers to answers
            document.querySelectorAll('.answer-option').forEach(option => {
                option.addEventListener('click', function() {
                    const questionIndex = parseInt(this.dataset.question);
                    const answerIndex = parseInt(this.dataset.answer);

                    // Remove previous selection
                    document.querySelectorAll(`[data-question="${questionIndex}"]`).forEach(opt => {
                        opt.classList.remove('selected');
                    });

                    // Add selection
                    this.classList.add('selected');
                    quizAnswers[questionIndex] = answerIndex;

                    // Check if all answered
                    if (quizAnswers.every(a => a !== null)) {
                        document.getElementById('submit-quiz').style.display = 'inline-block';
                    }
                });
            });
        }

        document.getElementById('submit-quiz').addEventListener('click', gradeQuiz);
        document.getElementById('restart-quiz').addEventListener('click', restartQuiz);

        function gradeQuiz() {
            let correctCount = 0;

            quizQuestions.forEach((q, index) => {
                const userAnswer = quizAnswers[index];
                const isCorrect = userAnswer === q.correct;

                if (isCorrect) correctCount++;

                const options = document.querySelectorAll(`[data-question="${index}"]`);
                options.forEach((opt, optIndex) => {
                    if (optIndex === q.correct) {
                        opt.classList.add('correct');
                    } else if (optIndex === userAnswer && !isCorrect) {
                        opt.classList.add('incorrect');
                    }
                });

                // Show explanation
                document.getElementById(`explanation-${index}`).classList.add('show');
            });

            const percentage = Math.round((correctCount / quizQuestions.length) * 100);
            const passed = percentage >= 70;

            const resultsHtml = `
                <div class="quiz-score">
                    <h3>Quiz Complete!</h3>
                    <div class="score-value">${correctCount} / ${quizQuestions.length}</div>
                    <p style="font-size: 1.2em; margin: 10px 0;">${percentage}% - ${passed ? 'PASSED' : 'NEEDS REVIEW'}</p>
                    <p style="color: var(--text-secondary);">
                        ${passed ?
                            'Excellent work! You have a solid understanding of Windows troubleshooting.' :
                            'Review the explanations above and try again. A passing score is 70% (7 out of 10).'}
                    </p>
                </div>
            `;

            document.getElementById('quiz-results').innerHTML = resultsHtml;
            document.getElementById('quiz-results').style.display = 'block';
            document.getElementById('submit-quiz').style.display = 'none';
            document.getElementById('restart-quiz').style.display = 'inline-block';

            // Scroll to results
            document.getElementById('quiz-results').scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function restartQuiz() {
            quizAnswers = new Array(quizQuestions.length).fill(null);
            document.getElementById('quiz-results').style.display = 'none';
            document.getElementById('restart-quiz').style.display = 'none';
            renderQuiz();
        }

        // Initialize
        renderScenarios();
        renderEventViewer();
        renderQuiz();

        console.log('%c Windows Troubleshooting Flowcharts Loaded', 'color: #166534; font-size: 16px; font-weight: bold;');
        console.log('%cCompTIA A+ Core 2 - Interactive Learning Tool', 'color: #7c3aed; font-size: 12px;');
    </script>
</body>
</html>