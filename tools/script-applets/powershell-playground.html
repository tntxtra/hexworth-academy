<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PowerShell Playground - House of Script</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #052e16 0%, #14532d 100%);
            min-height: 100vh;
            color: #86efac;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: rgba(5, 46, 22, 0.9);
            border-radius: 12px;
            border: 2px solid #166534;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
        }

        header {
            background: linear-gradient(135deg, #166534 0%, #22c55e 100%);
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 3px solid #22c55e;
        }

        header h1 {
            color: #052e16;
            font-size: 28px;
            font-weight: bold;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .back-link {
            color: #052e16;
            text-decoration: none;
            padding: 8px 16px;
            background: rgba(5, 46, 22, 0.2);
            border-radius: 6px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: rgba(5, 46, 22, 0.4);
            transform: translateX(-3px);
        }

        .main-content {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 0;
            height: calc(100vh - 140px);
        }

        .sidebar {
            background: rgba(5, 46, 22, 0.6);
            border-right: 2px solid #166534;
            overflow-y: auto;
            padding: 20px;
        }

        .sidebar h3 {
            color: #22c55e;
            margin-bottom: 15px;
            font-size: 18px;
            border-bottom: 2px solid #166534;
            padding-bottom: 8px;
        }

        .nav-tabs {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 20px;
        }

        .nav-tab {
            padding: 10px 15px;
            background: rgba(22, 101, 52, 0.3);
            border: 1px solid #166534;
            border-radius: 6px;
            cursor: pointer;
            color: #86efac;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .nav-tab:hover {
            background: rgba(22, 101, 52, 0.5);
            border-color: #22c55e;
            transform: translateX(5px);
        }

        .nav-tab.active {
            background: #166534;
            border-color: #22c55e;
            color: #22c55e;
        }

        .cmdlet-category {
            margin-bottom: 20px;
        }

        .cmdlet-category h4 {
            color: #22c55e;
            font-size: 14px;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cmdlet-item {
            padding: 8px 12px;
            background: rgba(22, 101, 52, 0.2);
            border: 1px solid #166534;
            border-radius: 4px;
            margin-bottom: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 13px;
        }

        .cmdlet-item:hover {
            background: rgba(22, 101, 52, 0.4);
            border-color: #22c55e;
            transform: translateX(3px);
        }

        .cmdlet-name {
            color: #22c55e;
            font-weight: 600;
            font-family: 'Courier New', monospace;
        }

        .cmdlet-desc {
            color: #86efac;
            font-size: 11px;
            margin-top: 4px;
            opacity: 0.8;
        }

        .editor-panel {
            display: flex;
            flex-direction: column;
            background: rgba(5, 46, 22, 0.4);
        }

        .editor-toolbar {
            display: flex;
            gap: 10px;
            padding: 15px 20px;
            background: rgba(22, 101, 52, 0.3);
            border-bottom: 2px solid #166534;
            flex-wrap: wrap;
        }

        .toolbar-btn {
            padding: 8px 16px;
            background: #166534;
            border: 1px solid #22c55e;
            border-radius: 6px;
            color: #86efac;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
        }

        .toolbar-btn:hover {
            background: #22c55e;
            color: #052e16;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(34, 197, 94, 0.3);
        }

        .editor-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .editor-wrapper {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        #scriptEditor {
            width: 100%;
            height: 100%;
            padding: 20px;
            background: #0a1810;
            border: none;
            color: #86efac;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            resize: none;
            outline: none;
        }

        #syntaxHighlight {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            padding: 20px;
            background: transparent;
            pointer-events: none;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            color: transparent;
            white-space: pre-wrap;
            word-wrap: break-word;
            overflow: hidden;
        }

        .console-output {
            height: 250px;
            background: #000;
            border-top: 2px solid #166534;
            padding: 15px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.5;
        }

        .console-line {
            margin-bottom: 4px;
        }

        .console-prompt {
            color: #22c55e;
        }

        .console-output-text {
            color: #86efac;
        }

        .console-error {
            color: #ff6b6b;
        }

        .console-success {
            color: #22c55e;
        }

        .right-panel {
            background: rgba(5, 46, 22, 0.6);
            border-left: 2px solid #166534;
            overflow-y: auto;
            padding: 20px;
        }

        .panel-section {
            display: none;
        }

        .panel-section.active {
            display: block;
        }

        .tutorial-item {
            margin-bottom: 25px;
            padding: 15px;
            background: rgba(22, 101, 52, 0.2);
            border-left: 4px solid #22c55e;
            border-radius: 4px;
        }

        .tutorial-item h4 {
            color: #22c55e;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .tutorial-item p {
            color: #86efac;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .tutorial-item code {
            display: block;
            background: #0a1810;
            padding: 10px;
            border-radius: 4px;
            color: #22c55e;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            margin-top: 8px;
            overflow-x: auto;
        }

        .example-script {
            margin-bottom: 20px;
            padding: 15px;
            background: rgba(22, 101, 52, 0.2);
            border: 1px solid #166534;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .example-script:hover {
            background: rgba(22, 101, 52, 0.4);
            border-color: #22c55e;
            transform: translateX(5px);
        }

        .example-script h4 {
            color: #22c55e;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .example-script p {
            color: #86efac;
            font-size: 13px;
            margin-bottom: 10px;
            opacity: 0.9;
        }

        .example-script code {
            display: block;
            background: #0a1810;
            padding: 10px;
            border-radius: 4px;
            color: #86efac;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            white-space: pre;
            overflow-x: auto;
        }

        .quiz-question {
            margin-bottom: 25px;
            padding: 20px;
            background: rgba(22, 101, 52, 0.2);
            border: 1px solid #166534;
            border-radius: 6px;
        }

        .quiz-question h4 {
            color: #22c55e;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .quiz-option {
            padding: 12px;
            background: rgba(22, 101, 52, 0.3);
            border: 1px solid #166534;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: #86efac;
            font-size: 14px;
        }

        .quiz-option:hover {
            background: rgba(22, 101, 52, 0.5);
            border-color: #22c55e;
        }

        .quiz-option.correct {
            background: rgba(34, 197, 94, 0.3);
            border-color: #22c55e;
            color: #22c55e;
        }

        .quiz-option.incorrect {
            background: rgba(255, 107, 107, 0.3);
            border-color: #ff6b6b;
            color: #ff6b6b;
        }

        .quiz-score {
            padding: 15px;
            background: linear-gradient(135deg, #166534 0%, #22c55e 100%);
            border-radius: 6px;
            text-align: center;
            color: #052e16;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 20px;
        }

        /* Syntax highlighting colors */
        .ps-cmdlet { color: #fbbf24; font-weight: bold; }
        .ps-variable { color: #60a5fa; }
        .ps-string { color: #f87171; }
        .ps-comment { color: #6b7280; font-style: italic; }
        .ps-operator { color: #a78bfa; }
        .ps-number { color: #34d399; }
        .ps-keyword { color: #fb923c; font-weight: bold; }
        .ps-pipeline { color: #22c55e; font-weight: bold; }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(5, 46, 22, 0.3);
        }

        ::-webkit-scrollbar-thumb {
            background: #166534;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #22c55e;
        }

        @media (max-width: 1200px) {
            .main-content {
                grid-template-columns: 200px 1fr 250px;
            }
        }

        @media (max-width: 900px) {
            .main-content {
                grid-template-columns: 1fr;
                grid-template-rows: auto 1fr auto;
            }

            .sidebar, .right-panel {
                border: none;
                border-bottom: 2px solid #166534;
                max-height: 300px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>PowerShell Playground - House of Script</h1>
            <a href="../../catalog.html" class="back-link">&larr; Back to Catalog</a>
        </header>

        <div class="main-content">
            <!-- Left Sidebar - Cmdlet Reference -->
            <div class="sidebar">
                <h3>Cmdlet Reference</h3>

                <div class="cmdlet-category">
                    <h4>File System</h4>
                    <div class="cmdlet-item" data-cmdlet="Get-ChildItem">
                        <div class="cmdlet-name">Get-ChildItem</div>
                        <div class="cmdlet-desc">List files and directories</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Set-Location">
                        <div class="cmdlet-name">Set-Location</div>
                        <div class="cmdlet-desc">Change current directory</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="New-Item">
                        <div class="cmdlet-name">New-Item</div>
                        <div class="cmdlet-desc">Create new file/folder</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Remove-Item">
                        <div class="cmdlet-name">Remove-Item</div>
                        <div class="cmdlet-desc">Delete file/folder</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Copy-Item">
                        <div class="cmdlet-name">Copy-Item</div>
                        <div class="cmdlet-desc">Copy files/folders</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Move-Item">
                        <div class="cmdlet-name">Move-Item</div>
                        <div class="cmdlet-desc">Move files/folders</div>
                    </div>
                </div>

                <div class="cmdlet-category">
                    <h4>Process</h4>
                    <div class="cmdlet-item" data-cmdlet="Get-Process">
                        <div class="cmdlet-name">Get-Process</div>
                        <div class="cmdlet-desc">Get running processes</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Stop-Process">
                        <div class="cmdlet-name">Stop-Process</div>
                        <div class="cmdlet-desc">Stop a process</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Start-Process">
                        <div class="cmdlet-name">Start-Process</div>
                        <div class="cmdlet-desc">Start a new process</div>
                    </div>
                </div>

                <div class="cmdlet-category">
                    <h4>Service</h4>
                    <div class="cmdlet-item" data-cmdlet="Get-Service">
                        <div class="cmdlet-name">Get-Service</div>
                        <div class="cmdlet-desc">Get system services</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Start-Service">
                        <div class="cmdlet-name">Start-Service</div>
                        <div class="cmdlet-desc">Start a service</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Stop-Service">
                        <div class="cmdlet-name">Stop-Service</div>
                        <div class="cmdlet-desc">Stop a service</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Restart-Service">
                        <div class="cmdlet-name">Restart-Service</div>
                        <div class="cmdlet-desc">Restart a service</div>
                    </div>
                </div>

                <div class="cmdlet-category">
                    <h4>Network</h4>
                    <div class="cmdlet-item" data-cmdlet="Test-Connection">
                        <div class="cmdlet-name">Test-Connection</div>
                        <div class="cmdlet-desc">Ping network host</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Get-NetAdapter">
                        <div class="cmdlet-name">Get-NetAdapter</div>
                        <div class="cmdlet-desc">Get network adapters</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Test-NetConnection">
                        <div class="cmdlet-name">Test-NetConnection</div>
                        <div class="cmdlet-desc">Test network connectivity</div>
                    </div>
                </div>

                <div class="cmdlet-category">
                    <h4>Data & Objects</h4>
                    <div class="cmdlet-item" data-cmdlet="Select-Object">
                        <div class="cmdlet-name">Select-Object</div>
                        <div class="cmdlet-desc">Select object properties</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Where-Object">
                        <div class="cmdlet-name">Where-Object</div>
                        <div class="cmdlet-desc">Filter objects</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Sort-Object">
                        <div class="cmdlet-name">Sort-Object</div>
                        <div class="cmdlet-desc">Sort objects</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="ForEach-Object">
                        <div class="cmdlet-name">ForEach-Object</div>
                        <div class="cmdlet-desc">Iterate over objects</div>
                    </div>
                    <div class="cmdlet-item" data-cmdlet="Measure-Object">
                        <div class="cmdlet-name">Measure-Object</div>
                        <div class="cmdlet-desc">Calculate object stats</div>
                    </div>
                </div>
            </div>

            <!-- Center Panel - Editor -->
            <div class="editor-panel">
                <div class="editor-toolbar">
                    <button class="toolbar-btn" id="runBtn">Run Script</button>
                    <button class="toolbar-btn" id="clearBtn">Clear Editor</button>
                    <button class="toolbar-btn" id="clearConsoleBtn">Clear Console</button>
                    <button class="toolbar-btn" id="formatBtn">Format Code</button>
                </div>

                <div class="editor-container">
                    <div class="editor-wrapper">
                        <div id="syntaxHighlight"></div>
                        <textarea id="scriptEditor" placeholder="# Write your PowerShell script here...&#10;# Click cmdlets on the left to insert them&#10;# Use the tutorials and examples on the right to learn&#10;&#10;Get-Process | Where-Object {$_.CPU -gt 10} | Select-Object Name, CPU"></textarea>
                    </div>

                    <div class="console-output" id="consoleOutput">
                        <div class="console-line console-success">PowerShell Console Output (Simulated)</div>
                        <div class="console-line console-output-text">Ready to execute scripts...</div>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Content Sections -->
            <div class="right-panel">
                <div class="nav-tabs">
                    <div class="nav-tab active" data-tab="tutorials">Tutorials</div>
                    <div class="nav-tab" data-tab="examples">Examples</div>
                    <div class="nav-tab" data-tab="quiz">Quiz Mode</div>
                </div>

                <!-- Tutorials Section -->
                <div class="panel-section active" id="tutorials">
                    <div class="tutorial-item">
                        <h4>Variables and Data Types</h4>
                        <p>Variables in PowerShell start with $. PowerShell automatically determines the data type.</p>
                        <code>$name = "John Doe"
$age = 30
$isActive = $true
$items = @(1, 2, 3, 4, 5)</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Pipelines</h4>
                        <p>The pipeline (|) passes objects from one cmdlet to another, enabling powerful data manipulation.</p>
                        <code>Get-Process | Where-Object {$_.CPU -gt 10} | Sort-Object CPU -Descending</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Comparison Operators</h4>
                        <p>PowerShell uses special operators for comparisons:</p>
                        <code>-eq  # Equal to
-ne  # Not equal to
-gt  # Greater than
-lt  # Less than
-ge  # Greater or equal
-le  # Less or equal
-like # Wildcard match</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Conditional Statements</h4>
                        <p>Use If/ElseIf/Else for conditional logic:</p>
                        <code>if ($age -ge 18) {
    Write-Host "Adult"
} else {
    Write-Host "Minor"
}</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Loops - ForEach</h4>
                        <p>Iterate over collections using ForEach-Object:</p>
                        <code>1..5 | ForEach-Object {
    Write-Host "Number: $_"
}</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Loops - For and While</h4>
                        <p>Traditional loop constructs:</p>
                        <code>for ($i=0; $i -lt 5; $i++) {
    Write-Host $i
}

while ($count -lt 10) {
    $count++
}</code>
                    </div>

                    <div class="tutorial-item">
                        <h4>Switch Statements</h4>
                        <p>Evaluate multiple conditions:</p>
                        <code>switch ($day) {
    "Monday" { "Start of week" }
    "Friday" { "End of week" }
    default { "Midweek" }
}</code>
                    </div>
                </div>

                <!-- Examples Section -->
                <div class="panel-section" id="examples">
                    <div class="example-script" data-script='# Get top 10 processes by CPU usage
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 Name, CPU, ID'>
                        <h4>Top CPU Processes</h4>
                        <p>Find the processes consuming the most CPU</p>
                        <code># Get top 10 processes by CPU usage
Get-Process | Sort-Object CPU -Descending | Select-Object -First 10 Name, CPU, ID</code>
                    </div>

                    <div class="example-script" data-script='# List all running services
Get-Service | Where-Object {$_.Status -eq "Running"} | Select-Object Name, DisplayName, Status'>
                        <h4>Running Services</h4>
                        <p>Display all currently running services</p>
                        <code># List all running services
Get-Service | Where-Object {$_.Status -eq "Running"} | Select-Object Name, DisplayName, Status</code>
                    </div>

                    <div class="example-script" data-script='# Find large files in a directory
Get-ChildItem -Path C:\Temp -Recurse | Where-Object {$_.Length -gt 100MB} | Sort-Object Length -Descending'>
                        <h4>Find Large Files</h4>
                        <p>Locate files larger than 100MB</p>
                        <code># Find large files in a directory
Get-ChildItem -Path C:\Temp -Recurse | Where-Object {$_.Length -gt 100MB} | Sort-Object Length -Descending</code>
                    </div>

                    <div class="example-script" data-script='# Test network connectivity
$servers = @("google.com", "microsoft.com", "github.com")
$servers | ForEach-Object {
    Test-Connection -ComputerName $_ -Count 2 -Quiet
}'>
                        <h4>Network Connectivity Test</h4>
                        <p>Ping multiple servers and check status</p>
                        <code># Test network connectivity
$servers = @("google.com", "microsoft.com", "github.com")
$servers | ForEach-Object {
    Test-Connection -ComputerName $_ -Count 2 -Quiet
}</code>
                    </div>

                    <div class="example-script" data-script='# Get system information
Get-ComputerInfo | Select-Object CsName, WindowsVersion, OsArchitecture, CsTotalPhysicalMemory'>
                        <h4>System Information</h4>
                        <p>Retrieve basic computer information</p>
                        <code># Get system information
Get-ComputerInfo | Select-Object CsName, WindowsVersion, OsArchitecture, CsTotalPhysicalMemory</code>
                    </div>

                    <div class="example-script" data-script='# Create backup of files
$source = "C:\Documents"
$destination = "C:\Backup"
Get-ChildItem -Path $source -Filter *.txt | Copy-Item -Destination $destination'>
                        <h4>Backup Files</h4>
                        <p>Copy all .txt files to backup location</p>
                        <code># Create backup of files
$source = "C:\Documents"
$destination = "C:\Backup"
Get-ChildItem -Path $source -Filter *.txt | Copy-Item -Destination $destination</code>
                    </div>

                    <div class="example-script" data-script='# Monitor disk space
Get-PSDrive -PSProvider FileSystem | Select-Object Name, @{Name="Used(GB)";Expression={[math]::Round($_.Used/1GB,2)}}, @{Name="Free(GB)";Expression={[math]::Round($_.Free/1GB,2)}}'>
                        <h4>Disk Space Monitor</h4>
                        <p>Check available space on all drives</p>
                        <code># Monitor disk space
Get-PSDrive -PSProvider FileSystem | Select-Object Name, @{Name="Used(GB)";Expression={[math]::Round($_.Used/1GB,2)}}, @{Name="Free(GB)";Expression={[math]::Round($_.Free/1GB,2)}}</code>
                    </div>

                    <div class="example-script" data-script='# Export data to CSV
Get-Process | Select-Object Name, CPU, WorkingSet | Export-Csv -Path "processes.csv" -NoTypeInformation'>
                        <h4>Export to CSV</h4>
                        <p>Save process information to a CSV file</p>
                        <code># Export data to CSV
Get-Process | Select-Object Name, CPU, WorkingSet | Export-Csv -Path "processes.csv" -NoTypeInformation</code>
                    </div>
                </div>

                <!-- Quiz Section -->
                <div class="panel-section" id="quiz">
                    <div class="quiz-score" id="quizScore">Score: 0 / 0</div>

                    <div class="quiz-question" data-answer="0">
                        <h4>Q1: What symbol is used to denote a variable in PowerShell?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">$</div>
                            <div class="quiz-option" data-option="1">@</div>
                            <div class="quiz-option" data-option="2">%</div>
                            <div class="quiz-option" data-option="3">#</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="2">
                        <h4>Q2: Which operator is used to pipe output from one cmdlet to another?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">&gt;</div>
                            <div class="quiz-option" data-option="1">&amp;</div>
                            <div class="quiz-option" data-option="2">|</div>
                            <div class="quiz-option" data-option="3">-&gt;</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="1">
                        <h4>Q3: What does the cmdlet "Get-Process" do?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">Starts a new process</div>
                            <div class="quiz-option" data-option="1">Gets running processes</div>
                            <div class="quiz-option" data-option="2">Stops a process</div>
                            <div class="quiz-option" data-option="3">Lists all services</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="0">
                        <h4>Q4: Which comparison operator means "equal to" in PowerShell?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">-eq</div>
                            <div class="quiz-option" data-option="1">==</div>
                            <div class="quiz-option" data-option="2">-equal</div>
                            <div class="quiz-option" data-option="3">=</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="3">
                        <h4>Q5: What cmdlet would you use to filter objects in a pipeline?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">Select-Object</div>
                            <div class="quiz-option" data-option="1">Sort-Object</div>
                            <div class="quiz-option" data-option="2">ForEach-Object</div>
                            <div class="quiz-option" data-option="3">Where-Object</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="1">
                        <h4>Q6: What does "$_" represent in a pipeline?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">The last error</div>
                            <div class="quiz-option" data-option="1">The current object</div>
                            <div class="quiz-option" data-option="2">A null value</div>
                            <div class="quiz-option" data-option="3">The previous cmdlet</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="2">
                        <h4>Q7: Which cmdlet is used to create a new file or folder?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">Create-Item</div>
                            <div class="quiz-option" data-option="1">Make-Item</div>
                            <div class="quiz-option" data-option="2">New-Item</div>
                            <div class="quiz-option" data-option="3">Add-Item</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="0">
                        <h4>Q8: What is the comparison operator for "greater than"?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">-gt</div>
                            <div class="quiz-option" data-option="1">&gt;</div>
                            <div class="quiz-option" data-option="2">-greater</div>
                            <div class="quiz-option" data-option="3">-ge</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="3">
                        <h4>Q9: Which cmdlet would you use to sort objects?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">Order-Object</div>
                            <div class="quiz-option" data-option="1">Arrange-Object</div>
                            <div class="quiz-option" data-option="2">Organize-Object</div>
                            <div class="quiz-option" data-option="3">Sort-Object</div>
                        </div>
                    </div>

                    <div class="quiz-question" data-answer="1">
                        <h4>Q10: How do you start a comment in PowerShell?</h4>
                        <div class="quiz-options">
                            <div class="quiz-option" data-option="0">//</div>
                            <div class="quiz-option" data-option="1">#</div>
                            <div class="quiz-option" data-option="2">/*</div>
                            <div class="quiz-option" data-option="3">--</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Editor and syntax highlighting
        const editor = document.getElementById('scriptEditor');
        const syntaxHighlight = document.getElementById('syntaxHighlight');
        const consoleOutput = document.getElementById('consoleOutput');

        // PowerShell syntax patterns
        const patterns = {
            cmdlet: /\b(Get|Set|New|Remove|Start|Stop|Restart|Test|Add|Clear|Copy|Move|Select|Where|Sort|ForEach|Measure|Import|Export|ConvertTo|ConvertFrom|Out|Write|Read)-[A-Za-z]+\b/g,
            variable: /\$[A-Za-z_]\w*/g,
            string: /(["'])(?:(?=(\\?))\2.)*?\1/g,
            comment: /#.*/g,
            operator: /\s(-eq|-ne|-gt|-lt|-ge|-le|-like|-notlike|-match|-notmatch|-contains|-notcontains|-in|-notin|-replace|-and|-or|-not|-band|-bor|-bnot|-as|-is|-isnot)\s/g,
            number: /\b\d+(\.\d+)?\b/g,
            keyword: /\b(if|else|elseif|switch|for|foreach|while|do|until|break|continue|return|function|param|begin|process|end|try|catch|finally|throw)\b/gi,
            pipeline: /\|/g
        };

        // Apply syntax highlighting
        function applySyntaxHighlighting(code) {
            let highlighted = code
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;');

            // Apply patterns in specific order to avoid conflicts
            highlighted = highlighted.replace(patterns.comment, match => `<span class="ps-comment">${match}</span>`);
            highlighted = highlighted.replace(patterns.string, match => `<span class="ps-string">${match}</span>`);
            highlighted = highlighted.replace(patterns.cmdlet, match => `<span class="ps-cmdlet">${match}</span>`);
            highlighted = highlighted.replace(patterns.variable, match => `<span class="ps-variable">${match}</span>`);
            highlighted = highlighted.replace(patterns.operator, match => ` <span class="ps-operator">${match.trim()}</span> `);
            highlighted = highlighted.replace(patterns.keyword, match => `<span class="ps-keyword">${match}</span>`);
            highlighted = highlighted.replace(patterns.number, match => `<span class="ps-number">${match}</span>`);
            highlighted = highlighted.replace(patterns.pipeline, match => `<span class="ps-pipeline">${match}</span>`);

            return highlighted;
        }

        // Update syntax highlighting
        function updateHighlighting() {
            const code = editor.value;
            syntaxHighlight.innerHTML = applySyntaxHighlighting(code);
        }

        // Sync scroll between editor and highlight
        editor.addEventListener('scroll', () => {
            syntaxHighlight.scrollTop = editor.scrollTop;
            syntaxHighlight.scrollLeft = editor.scrollLeft;
        });

        editor.addEventListener('input', updateHighlighting);
        editor.addEventListener('keydown', (e) => {
            // Tab key support
            if (e.key === 'Tab') {
                e.preventDefault();
                const start = editor.selectionStart;
                const end = editor.selectionEnd;
                editor.value = editor.value.substring(0, start) + '    ' + editor.value.substring(end);
                editor.selectionStart = editor.selectionEnd = start + 4;
                updateHighlighting();
            }
        });

        // Simulated PowerShell execution
        function simulateExecution(script) {
            const lines = script.split('\n').filter(line => line.trim() && !line.trim().startsWith('#'));
            const output = [];

            output.push('<div class="console-line console-prompt">PS C:\\&gt; Executing script...</div>');

            lines.forEach(line => {
                const trimmed = line.trim();
                output.push(`<div class="console-line console-prompt">PS C:\\&gt; ${trimmed}</div>`);

                // Simulate different cmdlet outputs
                if (trimmed.match(/Get-Process/i)) {
                    output.push('<div class="console-line console-output-text">');
                    output.push('Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  ProcessName');
                    output.push('-------  ------    -----      -----     ------     --  -----------');
                    output.push('    463      28    45812      52304      15.23   4820  chrome');
                    output.push('    281      19    28456      34120       8.47   6432  explorer');
                    output.push('    157      12    12304      18956       4.12   2156  powershell');
                    output.push('</div>');
                } else if (trimmed.match(/Get-Service/i)) {
                    output.push('<div class="console-line console-output-text">');
                    output.push('Status   Name               DisplayName');
                    output.push('------   ----               -----------');
                    output.push('Running  Dhcp               DHCP Client');
                    output.push('Running  Dnscache           DNS Client');
                    output.push('Stopped  wuauserv           Windows Update');
                    output.push('</div>');
                } else if (trimmed.match(/Get-ChildItem|dir|ls/i)) {
                    output.push('<div class="console-line console-output-text">');
                    output.push('    Directory: C:\\Users\\User\\Documents\n');
                    output.push('Mode                 LastWriteTime         Length Name');
                    output.push('----                 -------------         ------ ----');
                    output.push('d-----        12/11/2025   2:30 PM                Projects');
                    output.push('-a----        12/10/2025  10:15 AM           2048 notes.txt');
                    output.push('-a----        12/09/2025   3:45 PM          15360 report.docx');
                    output.push('</div>');
                } else if (trimmed.match(/Test-Connection/i)) {
                    output.push('<div class="console-line console-success">');
                    output.push('Source        Destination     IPV4Address      Bytes    Time(ms)');
                    output.push('------        -----------     -----------      -----    --------');
                    output.push('DESKTOP-PC    google.com      172.217.164.46      32          15');
                    output.push('DESKTOP-PC    google.com      172.217.164.46      32          14');
                    output.push('</div>');
                } else if (trimmed.match(/Where-Object/i)) {
                    output.push('<div class="console-line console-output-text">Filtered results displayed above</div>');
                } else if (trimmed.match(/Select-Object/i)) {
                    output.push('<div class="console-line console-output-text">Selected properties displayed above</div>');
                } else if (trimmed.match(/Sort-Object/i)) {
                    output.push('<div class="console-line console-output-text">Results sorted by specified property</div>');
                } else if (trimmed.match(/ForEach-Object/i)) {
                    output.push('<div class="console-line console-output-text">Processing each object in pipeline...</div>');
                } else if (trimmed.match(/Write-Host|Write-Output/i)) {
                    const match = trimmed.match(/["']([^"']+)["']/);
                    if (match) {
                        output.push(`<div class="console-line console-output-text">${match[1]}</div>`);
                    }
                } else if (trimmed.match(/\$/)) {
                    output.push('<div class="console-line console-success">Variable assigned successfully</div>');
                } else {
                    output.push('<div class="console-line console-output-text">Command executed successfully</div>');
                }
            });

            output.push('<div class="console-line console-success">Script execution completed</div>');

            return output.join('\n');
        }

        // Toolbar button handlers
        document.getElementById('runBtn').addEventListener('click', () => {
            const script = editor.value.trim();
            if (!script) {
                consoleOutput.innerHTML = '<div class="console-line console-error">Error: No script to execute</div>';
                return;
            }

            try {
                const output = simulateExecution(script);
                consoleOutput.innerHTML = output;
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
            } catch (error) {
                consoleOutput.innerHTML = `<div class="console-line console-error">Error: ${error.message}</div>`;
            }
        });

        document.getElementById('clearBtn').addEventListener('click', () => {
            editor.value = '';
            updateHighlighting();
        });

        document.getElementById('clearConsoleBtn').addEventListener('click', () => {
            consoleOutput.innerHTML = '<div class="console-line console-success">Console cleared</div>';
        });

        document.getElementById('formatBtn').addEventListener('click', () => {
            let code = editor.value;
            // Simple formatting: fix indentation
            const lines = code.split('\n');
            let indentLevel = 0;
            const formatted = lines.map(line => {
                const trimmed = line.trim();
                if (trimmed.match(/^\}/)) indentLevel--;
                const indented = '    '.repeat(Math.max(0, indentLevel)) + trimmed;
                if (trimmed.match(/\{$/)) indentLevel++;
                return indented;
            }).join('\n');
            editor.value = formatted;
            updateHighlighting();
        });

        // Cmdlet insertion
        document.querySelectorAll('.cmdlet-item').forEach(item => {
            item.addEventListener('click', () => {
                const cmdlet = item.dataset.cmdlet;
                const cursorPos = editor.selectionStart;
                const textBefore = editor.value.substring(0, cursorPos);
                const textAfter = editor.value.substring(cursorPos);
                editor.value = textBefore + cmdlet + ' ' + textAfter;
                editor.focus();
                editor.selectionStart = editor.selectionEnd = cursorPos + cmdlet.length + 1;
                updateHighlighting();
            });
        });

        // Tab navigation
        document.querySelectorAll('.nav-tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const targetTab = tab.dataset.tab;

                // Update active tab
                document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
                tab.classList.add('active');

                // Update active section
                document.querySelectorAll('.panel-section').forEach(section => section.classList.remove('active'));
                document.getElementById(targetTab).classList.add('active');
            });
        });

        // Example script loading
        document.querySelectorAll('.example-script').forEach(example => {
            example.addEventListener('click', () => {
                const script = example.dataset.script;
                editor.value = script;
                updateHighlighting();
                editor.focus();
            });
        });

        // Quiz functionality
        let quizScore = 0;
        let quizTotal = 0;

        document.querySelectorAll('.quiz-question').forEach(question => {
            const correctAnswer = parseInt(question.dataset.answer);
            const options = question.querySelectorAll('.quiz-option');

            options.forEach(option => {
                option.addEventListener('click', () => {
                    if (option.classList.contains('correct') || option.classList.contains('incorrect')) {
                        return; // Already answered
                    }

                    const selectedOption = parseInt(option.dataset.option);
                    quizTotal++;

                    if (selectedOption === correctAnswer) {
                        option.classList.add('correct');
                        quizScore++;
                    } else {
                        option.classList.add('incorrect');
                        options[correctAnswer].classList.add('correct');
                    }

                    // Disable all options in this question
                    options.forEach(opt => {
                        opt.style.pointerEvents = 'none';
                    });

                    updateQuizScore();
                });
            });
        });

        function updateQuizScore() {
            document.getElementById('quizScore').textContent = `Score: ${quizScore} / ${quizTotal}`;
        }

        // Initialize
        updateHighlighting();

        // Add default script
        editor.value = `# Welcome to PowerShell Playground!
# This is a simulated PowerShell environment for learning

# Example: Get top 5 processes by CPU usage
Get-Process | Sort-Object CPU -Descending | Select-Object -First 5 Name, CPU

# Example: List running services
Get-Service | Where-Object {$_.Status -eq "Running"}

# Try modifying these scripts or write your own!
# Click "Run Script" to see simulated output`;

        updateHighlighting();
    </script>
</body>
</html>