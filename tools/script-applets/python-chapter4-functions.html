<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python Chapter 4: Functions - House of Script Interactive Learning</title>
    <style>
        /* ===== RESET & BASE STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* House of Script Theme Colors */
            --primary-green: #166534;
            --light-green: #22c55e;
            --dark-green: #14532d;
            --accent-purple: #7c3aed;
            --light-purple: #a78bfa;
            --bg-dark: #0f172a;
            --bg-card: #1e293b;
            --bg-input: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --border-color: #475569;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;

            /* Spacing */
            --spacing-xs: 0.5rem;
            --spacing-sm: 1rem;
            --spacing-md: 1.5rem;
            --spacing-lg: 2rem;
            --spacing-xl: 3rem;

            /* Typography */
            --font-main: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --font-code: 'Courier New', Courier, monospace;
        }

        body {
            font-family: var(--font-main);
            background: linear-gradient(135deg, var(--bg-dark) 0%, #1a1a2e 100%);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            padding: var(--spacing-md);
        }

        /* ===== HEADER ===== */
        .header {
            text-align: center;
            padding: var(--spacing-lg) 0;
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--dark-green) 100%);
            border-radius: 12px;
            margin-bottom: var(--spacing-lg);
            box-shadow: 0 10px 30px rgba(22, 101, 52, 0.3);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: var(--spacing-xs);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            font-size: 1.1rem;
            color: var(--light-green);
            font-weight: 300;
        }

        /* ===== CONTAINER ===== */
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        /* ===== TAB NAVIGATION ===== */
        .tab-navigation {
            display: flex;
            gap: var(--spacing-xs);
            margin-bottom: var(--spacing-lg);
            flex-wrap: wrap;
            background: var(--bg-card);
            padding: var(--spacing-sm);
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .tab-button {
            flex: 1;
            min-width: 150px;
            padding: var(--spacing-sm) var(--spacing-md);
            background: var(--bg-input);
            color: var(--text-secondary);
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .tab-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(124, 58, 237, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .tab-button:hover::before {
            left: 100%;
        }

        .tab-button:hover {
            background: var(--primary-green);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--accent-purple) 100%);
            color: var(--text-primary);
            border-color: var(--light-green);
            box-shadow: 0 4px 12px rgba(22, 101, 52, 0.4);
        }

        /* ===== TAB CONTENT ===== */
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ===== CARDS ===== */
        .card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-md);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            border: 1px solid var(--border-color);
        }

        .card h2 {
            color: var(--light-green);
            margin-bottom: var(--spacing-md);
            font-size: 1.8rem;
            border-bottom: 2px solid var(--primary-green);
            padding-bottom: var(--spacing-sm);
        }

        .card h3 {
            color: var(--light-purple);
            margin-top: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            font-size: 1.3rem;
        }

        /* ===== CODE BLOCKS ===== */
        .code-block {
            background: var(--bg-dark);
            border: 1px solid var(--primary-green);
            border-radius: 8px;
            padding: var(--spacing-md);
            font-family: var(--font-code);
            font-size: 0.95rem;
            overflow-x: auto;
            margin: var(--spacing-sm) 0;
            position: relative;
        }

        .code-block code {
            color: var(--light-green);
        }

        .code-output {
            background: var(--bg-input);
            border-left: 4px solid var(--accent-purple);
            padding: var(--spacing-sm);
            margin-top: var(--spacing-sm);
            border-radius: 4px;
            font-family: var(--font-code);
            color: var(--text-secondary);
        }

        /* ===== INTERACTIVE ELEMENTS ===== */
        .input-group {
            margin: var(--spacing-sm) 0;
        }

        .input-group label {
            display: block;
            margin-bottom: var(--spacing-xs);
            color: var(--light-green);
            font-weight: 600;
        }

        input[type="text"],
        input[type="number"],
        textarea,
        select {
            width: 100%;
            padding: var(--spacing-sm);
            background: var(--bg-input);
            border: 1px solid var(--border-color);
            border-radius: 6px;
            color: var(--text-primary);
            font-family: var(--font-code);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        input:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: var(--light-green);
            box-shadow: 0 0 0 3px rgba(34, 197, 94, 0.2);
        }

        textarea {
            min-height: 120px;
            resize: vertical;
        }

        button {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--light-green) 100%);
            color: white;
            border: none;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(22, 101, 52, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button.secondary {
            background: linear-gradient(135deg, var(--accent-purple) 0%, var(--light-purple) 100%);
        }

        button.clear {
            background: var(--bg-input);
            color: var(--text-secondary);
        }

        /* ===== SCOPE VISUALIZER ===== */
        .scope-container {
            margin: var(--spacing-md) 0;
        }

        .scope-box {
            border: 2px solid var(--primary-green);
            border-radius: 8px;
            padding: var(--spacing-md);
            margin: var(--spacing-sm) 0;
            position: relative;
            background: rgba(22, 101, 52, 0.1);
        }

        .scope-box.global {
            border-color: var(--accent-purple);
            background: rgba(124, 58, 237, 0.1);
        }

        .scope-box.local {
            margin-left: var(--spacing-lg);
            border-color: var(--light-green);
        }

        .scope-label {
            position: absolute;
            top: -12px;
            left: var(--spacing-sm);
            background: var(--bg-card);
            padding: 0 var(--spacing-xs);
            color: var(--light-green);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .variable-item {
            padding: var(--spacing-xs) var(--spacing-sm);
            margin: var(--spacing-xs) 0;
            background: var(--bg-dark);
            border-radius: 4px;
            font-family: var(--font-code);
            display: flex;
            justify-content: space-between;
        }

        .variable-name {
            color: var(--light-purple);
        }

        .variable-value {
            color: var(--light-green);
        }

        /* ===== CALL STACK VISUALIZER ===== */
        .call-stack {
            display: flex;
            flex-direction: column-reverse;
            gap: var(--spacing-xs);
            margin: var(--spacing-md) 0;
            min-height: 200px;
        }

        .stack-frame {
            background: var(--bg-input);
            border: 2px solid var(--primary-green);
            border-radius: 8px;
            padding: var(--spacing-md);
            animation: stackPush 0.3s ease;
            position: relative;
        }

        .stack-frame.popping {
            animation: stackPop 0.3s ease;
        }

        @keyframes stackPush {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes stackPop {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }

        .stack-frame-title {
            font-weight: 600;
            color: var(--light-green);
            margin-bottom: var(--spacing-xs);
        }

        .stack-frame-details {
            font-family: var(--font-code);
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        /* ===== PARAMETER PLAYGROUND ===== */
        .param-examples {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
        }

        .param-card {
            background: var(--bg-input);
            padding: var(--spacing-md);
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }

        .param-card h4 {
            color: var(--light-purple);
            margin-bottom: var(--spacing-sm);
        }

        /* ===== QUIZ ===== */
        .quiz-question {
            background: var(--bg-input);
            padding: var(--spacing-md);
            border-radius: 8px;
            margin-bottom: var(--spacing-md);
            border-left: 4px solid var(--primary-green);
        }

        .quiz-question h4 {
            color: var(--light-green);
            margin-bottom: var(--spacing-sm);
        }

        .quiz-options {
            list-style: none;
            margin: var(--spacing-sm) 0;
        }

        .quiz-options li {
            padding: var(--spacing-sm);
            margin: var(--spacing-xs) 0;
            background: var(--bg-card);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .quiz-options li:hover {
            background: var(--bg-dark);
            border-color: var(--light-green);
        }

        .quiz-options li.selected {
            border-color: var(--accent-purple);
            background: rgba(124, 58, 237, 0.2);
        }

        .quiz-options li.correct {
            border-color: var(--success);
            background: rgba(16, 185, 129, 0.2);
        }

        .quiz-options li.incorrect {
            border-color: var(--error);
            background: rgba(239, 68, 68, 0.2);
        }

        .quiz-feedback {
            margin-top: var(--spacing-sm);
            padding: var(--spacing-sm);
            border-radius: 6px;
            font-weight: 600;
        }

        .quiz-feedback.correct {
            background: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .quiz-feedback.incorrect {
            background: rgba(239, 68, 68, 0.2);
            color: var(--error);
        }

        .quiz-score {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--accent-purple) 100%);
            padding: var(--spacing-lg);
            border-radius: 12px;
            text-align: center;
            margin-top: var(--spacing-lg);
            font-size: 1.5rem;
            font-weight: 600;
        }

        /* ===== GRID LAYOUTS ===== */
        .two-column {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: var(--spacing-md);
            margin: var(--spacing-md) 0;
        }

        /* ===== UTILITIES ===== */
        .mt-2 { margin-top: var(--spacing-md); }
        .mb-2 { margin-bottom: var(--spacing-md); }
        .text-center { text-align: center; }
        .flex { display: flex; }
        .flex-gap { gap: var(--spacing-sm); }
        .flex-wrap { flex-wrap: wrap; }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .tab-navigation {
                flex-direction: column;
            }

            .tab-button {
                min-width: 100%;
            }

            .two-column {
                grid-template-columns: 1fr;
            }

            .param-examples {
                grid-template-columns: 1fr;
            }

            .scope-box.local {
                margin-left: var(--spacing-sm);
            }
        }

        /* ===== CONCEPT HIGHLIGHT ===== */
        .concept-highlight {
            background: linear-gradient(135deg, rgba(124, 58, 237, 0.2) 0%, rgba(22, 101, 52, 0.2) 100%);
            border-left: 4px solid var(--accent-purple);
            padding: var(--spacing-md);
            border-radius: 8px;
            margin: var(--spacing-md) 0;
        }

        .concept-highlight strong {
            color: var(--light-purple);
        }

        /* ===== OUTPUT DISPLAY ===== */
        .output-display {
            background: var(--bg-dark);
            border: 2px solid var(--primary-green);
            border-radius: 8px;
            padding: var(--spacing-md);
            margin-top: var(--spacing-sm);
            min-height: 60px;
            font-family: var(--font-code);
        }

        .output-display.error {
            border-color: var(--error);
            color: var(--error);
        }

        .output-display.success {
            border-color: var(--success);
            color: var(--success);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>Python Chapter 4: Functions</h1>
            <p class="subtitle">Master the art of writing reusable, modular code with Python functions</p>
        </div>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" onclick="switchTab('basics')">Function Basics</button>
            <button class="tab-button" onclick="switchTab('builder')">Function Builder</button>
            <button class="tab-button" onclick="switchTab('scope')">Scope Visualizer</button>
            <button class="tab-button" onclick="switchTab('callstack')">Call Stack</button>
            <button class="tab-button" onclick="switchTab('parameters')">Parameters</button>
            <button class="tab-button" onclick="switchTab('advanced')">Advanced Topics</button>
            <button class="tab-button" onclick="switchTab('quiz')">Quiz</button>
        </div>

        <!-- Tab: Function Basics -->
        <div id="basics" class="tab-content active">
            <div class="card">
                <h2>Understanding Python Functions</h2>

                <div class="concept-highlight">
                    <strong>What is a Function?</strong><br>
                    A function is a reusable block of code that performs a specific task. Functions help organize code, avoid repetition, and make programs more modular and maintainable.
                </div>

                <h3>1. Defining Functions</h3>
                <p>Functions are defined using the <code>def</code> keyword:</p>
                <div class="code-block"><code>def greet():
    """This is a docstring - it describes what the function does."""
    print("Hello, World!")

# Calling the function
greet()  # Output: Hello, World!</code></div>

                <h3>2. Parameters vs Arguments</h3>
                <div class="two-column">
                    <div>
                        <h4 style="color: var(--light-purple);">Parameters</h4>
                        <p>Variables listed in the function definition</p>
                        <div class="code-block"><code>def greet(name):  # 'name' is a parameter
    print(f"Hello, {name}!")</code></div>
                    </div>
                    <div>
                        <h4 style="color: var(--light-purple);">Arguments</h4>
                        <p>Actual values passed when calling the function</p>
                        <div class="code-block"><code>greet("Alice")  # 'Alice' is an argument
# Output: Hello, Alice!</code></div>
                    </div>
                </div>

                <h3>3. Return Values</h3>
                <p>Functions can return values using the <code>return</code> statement:</p>
                <div class="code-block"><code>def add(a, b):
    """Returns the sum of two numbers."""
    return a + b

result = add(5, 3)
print(result)  # Output: 8</code></div>

                <h3>4. Default Parameters</h3>
                <p>Parameters can have default values:</p>
                <div class="code-block"><code>def greet(name, greeting="Hello"):
    return f"{greeting}, {name}!"

print(greet("Bob"))              # Output: Hello, Bob!
print(greet("Bob", "Hi"))        # Output: Hi, Bob!</code></div>

                <h3>5. Docstrings</h3>
                <p>Document your functions with triple-quoted strings:</p>
                <div class="code-block"><code>def calculate_area(radius):
    """
    Calculate the area of a circle.

    Args:
        radius (float): The radius of the circle

    Returns:
        float: The area of the circle
    """
    return 3.14159 * radius ** 2</code></div>
            </div>
        </div>

        <!-- Tab: Function Builder -->
        <div id="builder" class="tab-content">
            <div class="card">
                <h2>Interactive Function Builder</h2>
                <p>Create and test your own Python functions!</p>

                <div class="input-group">
                    <label>Function Name:</label>
                    <input type="text" id="func-name" placeholder="my_function" value="multiply">
                </div>

                <div class="input-group">
                    <label>Parameters (comma-separated):</label>
                    <input type="text" id="func-params" placeholder="x, y" value="x, y">
                </div>

                <div class="input-group">
                    <label>Function Body (Python code):</label>
                    <textarea id="func-body" placeholder="return x + y">return x * y</textarea>
                </div>

                <div class="input-group">
                    <label>Test Arguments (comma-separated):</label>
                    <input type="text" id="func-args" placeholder="5, 3" value="5, 3">
                </div>

                <div class="flex flex-gap flex-wrap">
                    <button onclick="buildAndTestFunction()">Build & Test Function</button>
                    <button class="secondary" onclick="addDocstring()">Add Docstring</button>
                    <button class="clear" onclick="clearBuilder()">Clear</button>
                </div>

                <div id="builder-output" class="output-display mt-2"></div>

                <h3 class="mt-2">Generated Function:</h3>
                <div id="generated-function" class="code-block">
                    <code>Your function will appear here...</code>
                </div>
            </div>
        </div>

        <!-- Tab: Scope Visualizer -->
        <div id="scope" class="tab-content">
            <div class="card">
                <h2>Variable Scope Visualizer</h2>

                <div class="concept-highlight">
                    <strong>Scope Rules:</strong><br>
                    • <strong>Local Scope:</strong> Variables defined inside a function<br>
                    • <strong>Global Scope:</strong> Variables defined outside all functions<br>
                    • <strong>LEGB Rule:</strong> Local → Enclosing → Global → Built-in
                </div>

                <h3>Example Code:</h3>
                <div class="code-block"><code>x = 10  # Global variable

def outer_function():
    y = 20  # Enclosing scope

    def inner_function():
        z = 30  # Local scope
        print(f"x={x}, y={y}, z={z}")

    inner_function()

outer_function()</code></div>

                <h3>Scope Visualization:</h3>
                <div class="scope-container" id="scope-visualization">
                    <!-- Will be populated by JavaScript -->
                </div>

                <h3 class="mt-2">Interactive Scope Tester</h3>
                <div class="input-group">
                    <label>Global Variable (name=value):</label>
                    <input type="text" id="global-var" placeholder="counter=0" value="counter=0">
                </div>

                <div class="input-group">
                    <label>Local Variable in Function (name=value):</label>
                    <input type="text" id="local-var" placeholder="counter=10" value="counter=10">
                </div>

                <button onclick="visualizeScope()">Visualize Scope</button>

                <div id="scope-result" class="output-display mt-2"></div>
            </div>
        </div>

        <!-- Tab: Call Stack Visualizer -->
        <div id="callstack" class="tab-content">
            <div class="card">
                <h2>Call Stack Visualizer</h2>

                <div class="concept-highlight">
                    <strong>Recursion:</strong> A function that calls itself. Each recursive call is added to the call stack until a base case is reached.
                </div>

                <h3>Factorial Example:</h3>
                <div class="code-block"><code>def factorial(n):
    """Calculate factorial recursively."""
    if n <= 1:  # Base case
        return 1
    return n * factorial(n - 1)  # Recursive case</code></div>

                <div class="input-group mt-2">
                    <label>Calculate Factorial of:</label>
                    <input type="number" id="factorial-input" value="5" min="1" max="10">
                </div>

                <div class="flex flex-gap flex-wrap">
                    <button onclick="animateFactorial()">Animate Call Stack</button>
                    <button class="secondary" onclick="animateFibonacci()">Try Fibonacci</button>
                    <button class="clear" onclick="clearCallStack()">Clear Stack</button>
                </div>

                <h3 class="mt-2">Call Stack (Bottom to Top):</h3>
                <div id="call-stack-display" class="call-stack">
                    <div style="text-align: center; color: var(--text-secondary); padding: var(--spacing-lg);">
                        Click "Animate Call Stack" to see the visualization
                    </div>
                </div>

                <div id="callstack-result" class="output-display mt-2"></div>
            </div>
        </div>

        <!-- Tab: Parameters -->
        <div id="parameters" class="tab-content">
            <div class="card">
                <h2>Parameter Playground</h2>

                <div class="param-examples">
                    <div class="param-card">
                        <h4>Positional Arguments</h4>
                        <div class="code-block"><code>def greet(first, last):
    return f"Hi {first} {last}"

print(greet("John", "Doe"))
# Output: Hi John Doe</code></div>
                        <button onclick="testPositional()">Test</button>
                        <div id="output-positional" class="code-output mt-2"></div>
                    </div>

                    <div class="param-card">
                        <h4>Keyword Arguments</h4>
                        <div class="code-block"><code>def greet(first, last):
    return f"Hi {first} {last}"

print(greet(last="Doe", first="John"))
# Output: Hi John Doe</code></div>
                        <button onclick="testKeyword()">Test</button>
                        <div id="output-keyword" class="code-output mt-2"></div>
                    </div>

                    <div class="param-card">
                        <h4>Default Parameters</h4>
                        <div class="code-block"><code>def power(base, exp=2):
    return base ** exp

print(power(3))      # 9
print(power(3, 3))   # 27</code></div>
                        <button onclick="testDefault()">Test</button>
                        <div id="output-default" class="code-output mt-2"></div>
                    </div>

                    <div class="param-card">
                        <h4>*args (Variable Positional)</h4>
                        <div class="code-block"><code>def sum_all(*args):
    return sum(args)

print(sum_all(1, 2, 3, 4, 5))
# Output: 15</code></div>
                        <button onclick="testArgs()">Test</button>
                        <div id="output-args" class="code-output mt-2"></div>
                    </div>

                    <div class="param-card">
                        <h4>**kwargs (Variable Keyword)</h4>
                        <div class="code-block"><code>def print_info(**kwargs):
    for key, val in kwargs.items():
        print(f"{key}: {val}")

print_info(name="Alice", age=30)</code></div>
                        <button onclick="testKwargs()">Test</button>
                        <div id="output-kwargs" class="code-output mt-2"></div>
                    </div>

                    <div class="param-card">
                        <h4>Mixed Parameters</h4>
                        <div class="code-block"><code>def func(pos, *args, key=0, **kwargs):
    return (pos, args, key, kwargs)

print(func(1, 2, 3, key=4, x=5))
# (1, (2, 3), 4, {'x': 5})</code></div>
                        <button onclick="testMixed()">Test</button>
                        <div id="output-mixed" class="code-output mt-2"></div>
                    </div>
                </div>

                <h3 class="mt-2">Custom Parameter Test</h3>
                <div class="input-group">
                    <label>Enter numbers separated by commas:</label>
                    <input type="text" id="custom-args" placeholder="10, 20, 30, 40" value="5, 10, 15">
                </div>
                <button onclick="testCustomArgs()">Calculate Sum & Average</button>
                <div id="custom-args-output" class="output-display mt-2"></div>
            </div>
        </div>

        <!-- Tab: Advanced Topics -->
        <div id="advanced" class="tab-content">
            <div class="card">
                <h2>Advanced Function Concepts</h2>

                <h3>1. Lambda Functions (Anonymous Functions)</h3>
                <p>Short, one-line functions without a name:</p>
                <div class="code-block"><code># Regular function
def square(x):
    return x ** 2

# Lambda equivalent
square = lambda x: x ** 2

print(square(5))  # Output: 25

# Common use with map, filter, sorted
numbers = [1, 2, 3, 4, 5]
squared = list(map(lambda x: x ** 2, numbers))
print(squared)  # [1, 4, 9, 16, 25]</code></div>

                <div class="input-group mt-2">
                    <label>Test Lambda - Enter numbers (comma-separated):</label>
                    <input type="text" id="lambda-input" value="1, 2, 3, 4, 5">
                </div>
                <div class="flex flex-gap flex-wrap">
                    <button onclick="testLambdaSquare()">Square All</button>
                    <button onclick="testLambdaFilter()">Filter Even</button>
                    <button onclick="testLambdaSort()">Sort by Absolute</button>
                </div>
                <div id="lambda-output" class="output-display mt-2"></div>

                <h3 class="mt-2">2. First-Class Functions</h3>
                <p>Functions are objects - they can be assigned, passed as arguments, and returned:</p>
                <div class="code-block"><code>def shout(text):
    return text.upper()

def whisper(text):
    return text.lower()

def apply_formatter(func, text):
    """Apply a formatting function to text."""
    return func(text)

print(apply_formatter(shout, "hello"))    # HELLO
print(apply_formatter(whisper, "HELLO"))  # hello</code></div>

                <div class="input-group mt-2">
                    <label>Enter text to format:</label>
                    <input type="text" id="formatter-input" value="Hello World">
                </div>
                <div class="flex flex-gap flex-wrap">
                    <button onclick="applyShout()">SHOUT</button>
                    <button onclick="applyWhisper()">whisper</button>
                    <button onclick="applyTitle()">Title Case</button>
                    <button onclick="applyReverse()">esreveR</button>
                </div>
                <div id="formatter-output" class="output-display mt-2"></div>

                <h3 class="mt-2">3. Closures</h3>
                <p>Functions that remember values from their enclosing scope:</p>
                <div class="code-block"><code>def make_multiplier(n):
    """Returns a function that multiplies by n."""
    def multiplier(x):
        return x * n
    return multiplier

times_3 = make_multiplier(3)
times_5 = make_multiplier(5)

print(times_3(10))  # 30
print(times_5(10))  # 50</code></div>

                <div class="input-group mt-2">
                    <label>Create multiplier function (multiply by):</label>
                    <input type="number" id="closure-multiplier" value="7">
                </div>
                <div class="input-group">
                    <label>Test with value:</label>
                    <input type="number" id="closure-value" value="6">
                </div>
                <button onclick="testClosure()">Test Closure</button>
                <div id="closure-output" class="output-display mt-2"></div>

                <h3 class="mt-2">4. Decorators (Preview)</h3>
                <p>Functions that modify other functions:</p>
                <div class="code-block"><code>def uppercase_decorator(func):
    def wrapper():
        result = func()
        return result.upper()
    return wrapper

@uppercase_decorator
def greet():
    return "hello"

print(greet())  # HELLO</code></div>
            </div>
        </div>

        <!-- Tab: Quiz -->
        <div id="quiz" class="tab-content">
            <div class="card">
                <h2>Test Your Knowledge</h2>
                <p>Answer all questions and click "Submit Quiz" to see your score!</p>

                <div id="quiz-container">
                    <!-- Questions will be generated by JavaScript -->
                </div>

                <button onclick="submitQuiz()" class="mt-2">Submit Quiz</button>
                <button onclick="resetQuiz()" class="secondary mt-2">Reset Quiz</button>

                <div id="quiz-score-display"></div>
            </div>
        </div>
    </div>

    <script>
        // ===== TAB SWITCHING =====
        function switchTab(tabName) {
            // Hide all tab contents
            const contents = document.querySelectorAll('.tab-content');
            contents.forEach(content => content.classList.remove('active'));

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.tab-button');
            buttons.forEach(button => button.classList.remove('active'));

            // Show selected tab
            document.getElementById(tabName).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Initialize tab-specific content
            if (tabName === 'scope') {
                initializeScopeVisualization();
            } else if (tabName === 'quiz') {
                if (!window.quizInitialized) {
                    generateQuiz();
                    window.quizInitialized = true;
                }
            }
        }

        // ===== FUNCTION BUILDER =====
        function buildAndTestFunction() {
            const name = document.getElementById('func-name').value.trim();
            const params = document.getElementById('func-params').value.trim();
            const body = document.getElementById('func-body').value.trim();
            const args = document.getElementById('func-args').value.trim();

            if (!name || !body) {
                displayOutput('builder-output', 'Please provide function name and body', 'error');
                return;
            }

            // Generate function code
            const funcCode = `def ${name}(${params}):\n    ${body.replace(/\n/g, '\n    ')}`;

            document.getElementById('generated-function').innerHTML = `<code>${escapeHtml(funcCode)}</code>`;

            // Simulate execution
            try {
                // Parse arguments
                const argArray = args.split(',').map(a => a.trim());
                const result = simulatePythonFunction(body, params, argArray);

                const callCode = `${name}(${args})`;
                displayOutput('builder-output',
                    `<strong>Function Call:</strong> ${callCode}<br><strong>Result:</strong> ${result}`,
                    'success');
            } catch (error) {
                displayOutput('builder-output', `Error: ${error.message}`, 'error');
            }
        }

        function simulatePythonFunction(body, params, args) {
            // Simple simulation of Python function execution
            const paramArray = params.split(',').map(p => p.trim()).filter(p => p);

            if (paramArray.length !== args.length) {
                throw new Error(`Expected ${paramArray.length} arguments, got ${args.length}`);
            }

            // Create a scope with parameter values
            let scope = {};
            paramArray.forEach((param, i) => {
                scope[param] = parseValue(args[i]);
            });

            // Simple expression evaluator
            if (body.startsWith('return ')) {
                const expr = body.substring(7).trim();
                return evaluateExpression(expr, scope);
            }

            return 'None (no return statement)';
        }

        function parseValue(val) {
            // Try to parse as number
            const num = Number(val);
            if (!isNaN(num)) return num;

            // Try to parse as boolean
            if (val === 'True') return true;
            if (val === 'False') return false;

            // Remove quotes if string
            if ((val.startsWith('"') && val.endsWith('"')) ||
                (val.startsWith("'") && val.endsWith("'"))) {
                return val.slice(1, -1);
            }

            return val;
        }

        function evaluateExpression(expr, scope) {
            // Replace variables with their values
            let result = expr;
            for (let [key, value] of Object.entries(scope)) {
                const regex = new RegExp(`\\b${key}\\b`, 'g');
                result = result.replace(regex, JSON.stringify(value));
            }

            // Evaluate mathematical expressions
            try {
                // Replace Python operators with JS equivalents
                result = result.replace(/\*\*/g, '**'); // Power is same
                result = result.replace(/\/\//g, 'Math.floor('); // Integer division
                if (result.includes('Math.floor(')) {
                    result = result.replace(/Math\.floor\((.*?)\/(.*?)\)/g, 'Math.floor($1/$2)');
                }

                // Safe evaluation
                return eval(result);
            } catch (e) {
                return `Expression evaluation: ${result}`;
            }
        }

        function addDocstring() {
            const currentBody = document.getElementById('func-body').value;
            const docstring = '"""Description of what this function does."""\n' + currentBody;
            document.getElementById('func-body').value = docstring;
        }

        function clearBuilder() {
            document.getElementById('func-name').value = 'my_function';
            document.getElementById('func-params').value = 'x, y';
            document.getElementById('func-body').value = 'return x + y';
            document.getElementById('func-args').value = '5, 3';
            document.getElementById('builder-output').innerHTML = '';
            document.getElementById('generated-function').innerHTML = '<code>Your function will appear here...</code>';
        }

        // ===== SCOPE VISUALIZER =====
        function initializeScopeVisualization() {
            const container = document.getElementById('scope-visualization');
            container.innerHTML = `
                <div class="scope-box global">
                    <span class="scope-label">Global Scope</span>
                    <div class="variable-item">
                        <span class="variable-name">x</span>
                        <span class="variable-value">10</span>
                    </div>

                    <div class="scope-box">
                        <span class="scope-label">outer_function() Scope</span>
                        <div class="variable-item">
                            <span class="variable-name">y</span>
                            <span class="variable-value">20</span>
                        </div>

                        <div class="scope-box local">
                            <span class="scope-label">inner_function() Scope</span>
                            <div class="variable-item">
                                <span class="variable-name">z</span>
                                <span class="variable-value">30</span>
                            </div>
                            <div class="variable-item">
                                <span class="variable-name">y (from enclosing)</span>
                                <span class="variable-value">20</span>
                            </div>
                            <div class="variable-item">
                                <span class="variable-name">x (from global)</span>
                                <span class="variable-value">10</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function visualizeScope() {
            const globalVar = document.getElementById('global-var').value.trim();
            const localVar = document.getElementById('local-var').value.trim();

            try {
                const [gName, gValue] = globalVar.split('=').map(s => s.trim());
                const [lName, lValue] = localVar.split('=').map(s => s.trim());

                const container = document.getElementById('scope-visualization');
                container.innerHTML = `
                    <div class="scope-box global">
                        <span class="scope-label">Global Scope</span>
                        <div class="variable-item">
                            <span class="variable-name">${gName}</span>
                            <span class="variable-value">${gValue}</span>
                        </div>

                        <div class="scope-box local">
                            <span class="scope-label">Function Scope</span>
                            <div class="variable-item">
                                <span class="variable-name">${lName}</span>
                                <span class="variable-value">${lValue}</span>
                            </div>
                        </div>
                    </div>
                `;

                const message = gName === lName
                    ? `The local variable "${lName}" shadows the global variable. Inside the function, "${lName}" = ${lValue}.`
                    : `Two different variables: global "${gName}" = ${gValue}, local "${lName}" = ${lValue}.`;

                displayOutput('scope-result', message, 'success');
            } catch (error) {
                displayOutput('scope-result', 'Please use format: name=value', 'error');
            }
        }

        // ===== CALL STACK VISUALIZER =====
        let callStackArray = [];
        let animationDelay = 800;

        function clearCallStack() {
            const display = document.getElementById('call-stack-display');
            display.innerHTML = '<div style="text-align: center; color: var(--text-secondary); padding: var(--spacing-lg);">Click "Animate Call Stack" to see the visualization</div>';
            callStackArray = [];
            document.getElementById('callstack-result').innerHTML = '';
        }

        async function animateFactorial() {
            const n = parseInt(document.getElementById('factorial-input').value);
            if (n < 1 || n > 10) {
                displayOutput('callstack-result', 'Please enter a number between 1 and 10', 'error');
                return;
            }

            clearCallStack();
            callStackArray = [];

            displayOutput('callstack-result', `Calculating factorial(${n})...`, 'success');

            const result = await visualizeFactorial(n);

            setTimeout(() => {
                displayOutput('callstack-result',
                    `<strong>Final Result:</strong> factorial(${n}) = ${result}`,
                    'success');
            }, animationDelay * 2);
        }

        async function visualizeFactorial(n) {
            // Push to stack
            await pushToStack(`factorial(${n})`, `n = ${n}, ${n <= 1 ? 'BASE CASE' : `return ${n} * factorial(${n-1})`}`);

            if (n <= 1) {
                await sleep(animationDelay);
                await popFromStack(`Returns: 1`);
                return 1;
            }

            const result = await visualizeFactorial(n - 1);
            const finalResult = n * result;

            await sleep(animationDelay);
            await popFromStack(`Returns: ${n} * ${result} = ${finalResult}`);

            return finalResult;
        }

        async function animateFibonacci() {
            clearCallStack();
            callStackArray = [];

            displayOutput('callstack-result', 'Calculating fibonacci(4)...', 'success');

            const result = await visualizeFibonacci(4);

            setTimeout(() => {
                displayOutput('callstack-result',
                    `<strong>Final Result:</strong> fibonacci(4) = ${result}`,
                    'success');
            }, animationDelay * 2);
        }

        async function visualizeFibonacci(n) {
            await pushToStack(`fibonacci(${n})`, `n = ${n}, ${n <= 1 ? 'BASE CASE' : `return fib(${n-1}) + fib(${n-2})`}`);

            if (n <= 1) {
                await sleep(animationDelay);
                await popFromStack(`Returns: ${n}`);
                return n;
            }

            const a = await visualizeFibonacci(n - 1);
            const b = await visualizeFibonacci(n - 2);
            const result = a + b;

            await sleep(animationDelay);
            await popFromStack(`Returns: ${a} + ${b} = ${result}`);

            return result;
        }

        async function pushToStack(title, details) {
            const display = document.getElementById('call-stack-display');

            if (callStackArray.length === 0) {
                display.innerHTML = '';
            }

            const frame = document.createElement('div');
            frame.className = 'stack-frame';
            frame.innerHTML = `
                <div class="stack-frame-title">${title}</div>
                <div class="stack-frame-details">${details}</div>
            `;

            display.appendChild(frame);
            callStackArray.push(frame);

            await sleep(animationDelay);
        }

        async function popFromStack(returnValue) {
            if (callStackArray.length === 0) return;

            const frame = callStackArray.pop();
            frame.classList.add('popping');

            // Update with return value
            const details = frame.querySelector('.stack-frame-details');
            details.innerHTML += `<br><strong style="color: var(--light-green);">${returnValue}</strong>`;

            await sleep(animationDelay);
            frame.remove();
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // ===== PARAMETER PLAYGROUND =====
        function testPositional() {
            const result = "Hi John Doe";
            displayOutput('output-positional', `Result: ${result}`);
        }

        function testKeyword() {
            const result = "Hi John Doe";
            displayOutput('output-keyword', `Result: ${result}`);
        }

        function testDefault() {
            const result1 = Math.pow(3, 2);
            const result2 = Math.pow(3, 3);
            displayOutput('output-default', `power(3) = ${result1}<br>power(3, 3) = ${result2}`);
        }

        function testArgs() {
            const numbers = [1, 2, 3, 4, 5];
            const result = numbers.reduce((a, b) => a + b, 0);
            displayOutput('output-args', `sum_all(1, 2, 3, 4, 5) = ${result}`);
        }

        function testKwargs() {
            const output = `name: Alice<br>age: 30`;
            displayOutput('output-kwargs', output);
        }

        function testMixed() {
            const result = `(1, (2, 3), 4, {'x': 5})`;
            displayOutput('output-mixed', `Result: ${result}`);
        }

        function testCustomArgs() {
            const input = document.getElementById('custom-args').value;
            const numbers = input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));

            if (numbers.length === 0) {
                displayOutput('custom-args-output', 'Please enter valid numbers', 'error');
                return;
            }

            const sum = numbers.reduce((a, b) => a + b, 0);
            const avg = sum / numbers.length;

            displayOutput('custom-args-output',
                `<strong>Numbers:</strong> [${numbers.join(', ')}]<br>` +
                `<strong>Sum:</strong> ${sum}<br>` +
                `<strong>Average:</strong> ${avg.toFixed(2)}`,
                'success');
        }

        // ===== ADVANCED TOPICS =====
        function testLambdaSquare() {
            const input = document.getElementById('lambda-input').value;
            const numbers = input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
            const squared = numbers.map(x => x ** 2);

            displayOutput('lambda-output',
                `<strong>Original:</strong> [${numbers.join(', ')}]<br>` +
                `<strong>Squared:</strong> [${squared.join(', ')}]<br>` +
                `<strong>Lambda:</strong> lambda x: x ** 2`,
                'success');
        }

        function testLambdaFilter() {
            const input = document.getElementById('lambda-input').value;
            const numbers = input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
            const even = numbers.filter(x => x % 2 === 0);

            displayOutput('lambda-output',
                `<strong>Original:</strong> [${numbers.join(', ')}]<br>` +
                `<strong>Even numbers:</strong> [${even.join(', ')}]<br>` +
                `<strong>Lambda:</strong> lambda x: x % 2 == 0`,
                'success');
        }

        function testLambdaSort() {
            const input = document.getElementById('lambda-input').value;
            let numbers = input.split(',').map(n => parseFloat(n.trim())).filter(n => !isNaN(n));
            const sorted = [...numbers].sort((a, b) => Math.abs(a) - Math.abs(b));

            displayOutput('lambda-output',
                `<strong>Original:</strong> [${numbers.join(', ')}]<br>` +
                `<strong>Sorted by absolute value:</strong> [${sorted.join(', ')}]<br>` +
                `<strong>Lambda:</strong> lambda x: abs(x)`,
                'success');
        }

        function applyShout() {
            const text = document.getElementById('formatter-input').value;
            displayOutput('formatter-output', `<strong>Result:</strong> ${text.toUpperCase()}`, 'success');
        }

        function applyWhisper() {
            const text = document.getElementById('formatter-input').value;
            displayOutput('formatter-output', `<strong>Result:</strong> ${text.toLowerCase()}`, 'success');
        }

        function applyTitle() {
            const text = document.getElementById('formatter-input').value;
            const result = text.split(' ').map(word =>
                word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
            ).join(' ');
            displayOutput('formatter-output', `<strong>Result:</strong> ${result}`, 'success');
        }

        function applyReverse() {
            const text = document.getElementById('formatter-input').value;
            const result = text.split('').reverse().join('');
            displayOutput('formatter-output', `<strong>Result:</strong> ${result}`, 'success');
        }

        function testClosure() {
            const multiplier = parseInt(document.getElementById('closure-multiplier').value);
            const value = parseInt(document.getElementById('closure-value').value);
            const result = multiplier * value;

            displayOutput('closure-output',
                `<strong>Created function:</strong> times_${multiplier}<br>` +
                `<strong>Called with:</strong> ${value}<br>` +
                `<strong>Result:</strong> ${result}<br>` +
                `<em>The closure "remembers" the multiplier value (${multiplier})</em>`,
                'success');
        }

        // ===== QUIZ GENERATION =====
        const quizQuestions = [
            {
                question: "What keyword is used to define a function in Python?",
                options: ["function", "def", "func", "define"],
                correct: 1,
                explanation: "The 'def' keyword is used to define functions in Python."
            },
            {
                question: "What will this code output?\n\ndef greet(name='World'):\n    return f'Hello, {name}'\n\nprint(greet())",
                options: ["Hello,", "Hello, World", "Error", "None"],
                correct: 1,
                explanation: "When no argument is provided, the default parameter value 'World' is used."
            },
            {
                question: "What is the difference between *args and **kwargs?",
                options: [
                    "*args is for keyword arguments, **kwargs is for positional",
                    "*args is for positional arguments, **kwargs is for keyword",
                    "They are the same",
                    "*args is for strings, **kwargs is for numbers"
                ],
                correct: 1,
                explanation: "*args collects variable positional arguments as a tuple, **kwargs collects variable keyword arguments as a dictionary."
            },
            {
                question: "What will this function return?\n\ndef mystery(x):\n    result = x * 2\n\nmystery(5)",
                options: ["10", "5", "None", "Error"],
                correct: 2,
                explanation: "The function doesn't have a return statement, so it returns None by default."
            },
            {
                question: "Which scope does Python check FIRST when looking for a variable?",
                options: ["Global", "Built-in", "Local", "Enclosing"],
                correct: 2,
                explanation: "Python follows the LEGB rule: Local → Enclosing → Global → Built-in"
            },
            {
                question: "What is a lambda function?",
                options: [
                    "A function that is very fast",
                    "A function defined in a loop",
                    "An anonymous, single-expression function",
                    "A function from the lambda module"
                ],
                correct: 2,
                explanation: "Lambda functions are anonymous (unnamed) functions that can contain only a single expression."
            },
            {
                question: "What will this recursive function return?\n\ndef countdown(n):\n    if n <= 0:\n        return 'Done'\n    return countdown(n - 1)\n\ncountdown(3)",
                options: ["3", "0", "Done", "Error"],
                correct: 2,
                explanation: "The function recursively calls itself until n <= 0, then returns 'Done'."
            },
            {
                question: "What is the purpose of a docstring?",
                options: [
                    "To execute code documentation",
                    "To document what a function does",
                    "To create string variables",
                    "To define default parameters"
                ],
                correct: 1,
                explanation: "Docstrings (triple-quoted strings) are used to document what a function, class, or module does."
            },
            {
                question: "Can you assign a function to a variable in Python?",
                options: [
                    "No, functions cannot be assigned to variables",
                    "Yes, functions are first-class objects",
                    "Only lambda functions can be assigned",
                    "Only with the 'assign' keyword"
                ],
                correct: 1,
                explanation: "In Python, functions are first-class objects, meaning they can be assigned to variables, passed as arguments, and returned from other functions."
            },
            {
                question: "What will this code output?\n\nx = 10\n\ndef func():\n    x = 5\n    print(x)\n\nfunc()\nprint(x)",
                options: ["5, 5", "10, 10", "5, 10", "10, 5"],
                correct: 2,
                explanation: "The function creates a local variable x (=5), while the global x (=10) remains unchanged outside the function."
            }
        ];

        function generateQuiz() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = '';

            quizQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'quiz-question';
                questionDiv.innerHTML = `
                    <h4>Question ${index + 1}</h4>
                    <p style="white-space: pre-wrap;">${escapeHtml(q.question)}</p>
                    <ul class="quiz-options" data-question="${index}">
                        ${q.options.map((opt, i) => `
                            <li onclick="selectAnswer(${index}, ${i})" data-option="${i}">
                                ${String.fromCharCode(65 + i)}. ${escapeHtml(opt)}
                            </li>
                        `).join('')}
                    </ul>
                    <div class="quiz-feedback" id="feedback-${index}" style="display: none;"></div>
                `;
                container.appendChild(questionDiv);
            });
        }

        const userAnswers = {};

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;

            // Update UI
            const options = document.querySelectorAll(`[data-question="${questionIndex}"] li`);
            options.forEach(opt => opt.classList.remove('selected'));
            options[optionIndex].classList.add('selected');
        }

        function submitQuiz() {
            let correct = 0;
            let total = quizQuestions.length;

            quizQuestions.forEach((q, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === q.correct;

                if (isCorrect) correct++;

                // Show feedback
                const feedback = document.getElementById(`feedback-${index}`);
                feedback.style.display = 'block';
                feedback.className = 'quiz-feedback ' + (isCorrect ? 'correct' : 'incorrect');
                feedback.innerHTML = isCorrect
                    ? `<strong>Correct!</strong> ${q.explanation}`
                    : `<strong>Incorrect.</strong> ${q.explanation}`;

                // Highlight options
                const options = document.querySelectorAll(`[data-question="${index}"] li`);
                options.forEach((opt, i) => {
                    opt.style.pointerEvents = 'none';
                    if (i === q.correct) {
                        opt.classList.add('correct');
                    } else if (i === userAnswer && i !== q.correct) {
                        opt.classList.add('incorrect');
                    }
                });
            });

            // Show score
            const percentage = (correct / total * 100).toFixed(0);
            const scoreDiv = document.getElementById('quiz-score-display');
            scoreDiv.innerHTML = `
                <div class="quiz-score">
                    Your Score: ${correct} / ${total} (${percentage}%)
                    <br>
                    ${percentage >= 80 ? 'Excellent work! 🎉' : percentage >= 60 ? 'Good job! Keep practicing!' : 'Keep studying and try again!'}
                </div>
            `;

            // Scroll to score
            scoreDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function resetQuiz() {
            Object.keys(userAnswers).forEach(key => delete userAnswers[key]);

            // Reset all options
            document.querySelectorAll('.quiz-options li').forEach(opt => {
                opt.classList.remove('selected', 'correct', 'incorrect');
                opt.style.pointerEvents = 'auto';
            });

            // Hide all feedback
            document.querySelectorAll('.quiz-feedback').forEach(fb => {
                fb.style.display = 'none';
            });

            // Clear score
            document.getElementById('quiz-score-display').innerHTML = '';
        }

        // ===== UTILITY FUNCTIONS =====
        function displayOutput(elementId, message, type = '') {
            const element = document.getElementById(elementId);
            element.innerHTML = message;
            element.className = 'output-display';
            if (type) element.classList.add(type);
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            initializeScopeVisualization();
        });
    </script>
</body>
</html>