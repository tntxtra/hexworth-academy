<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bash Scripting Playground - House of Script</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --green-darkest: #052e16;
            --green-dark: #166534;
            --green-medium: #22c55e;
            --green-light: #86efac;
            --bg-primary: #0a0f0a;
            --bg-secondary: #0d1810;
            --text-primary: #86efac;
            --text-secondary: #22c55e;
            --border-color: #166534;
        }

        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
            color: var(--text-primary);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--green-darkest);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            box-shadow: 0 0 30px rgba(34, 197, 94, 0.3);
        }

        h1 {
            color: var(--green-medium);
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
        }

        .tagline {
            color: var(--text-primary);
            font-size: 1.1em;
            font-style: italic;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .panel {
            background: var(--green-darkest);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--border-color);
        }

        .panel-title {
            color: var(--green-medium);
            font-size: 1.3em;
            font-weight: bold;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            padding: 10px 20px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .tab-btn:hover {
            background: var(--green-dark);
            color: var(--green-light);
            box-shadow: 0 0 15px rgba(34, 197, 94, 0.4);
        }

        .tab-btn.active {
            background: var(--green-medium);
            color: var(--green-darkest);
            font-weight: bold;
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.6);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .editor-container {
            position: relative;
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            overflow: hidden;
        }

        .editor-wrapper {
            display: flex;
        }

        .line-numbers {
            padding: 15px 10px;
            background: var(--bg-secondary);
            color: var(--border-color);
            text-align: right;
            user-select: none;
            font-size: 0.9em;
            line-height: 1.5;
            border-right: 2px solid var(--border-color);
            min-width: 50px;
        }

        #scriptEditor {
            flex: 1;
            padding: 15px;
            background: transparent;
            color: var(--text-primary);
            border: none;
            font-family: inherit;
            font-size: 1em;
            line-height: 1.5;
            resize: none;
            outline: none;
            min-height: 400px;
        }

        .examples-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .example-btn {
            padding: 12px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.95em;
            transition: all 0.3s ease;
            text-align: left;
        }

        .example-btn:hover {
            background: var(--green-dark);
            color: var(--green-light);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(34, 197, 94, 0.3);
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn {
            padding: 12px 24px;
            background: var(--green-dark);
            color: var(--green-light);
            border: 2px solid var(--green-medium);
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 1em;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: var(--green-medium);
            color: var(--green-darkest);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.5);
            transform: translateY(-2px);
        }

        .btn-clear {
            background: var(--bg-secondary);
            border-color: var(--border-color);
            color: var(--text-primary);
        }

        .btn-clear:hover {
            background: #7f1d1d;
            border-color: #dc2626;
            color: #fca5a5;
        }

        #output {
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            border-radius: 6px;
            padding: 15px;
            min-height: 400px;
            max-height: 500px;
            overflow-y: auto;
            font-family: inherit;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-line {
            margin: 2px 0;
        }

        .output-prompt {
            color: var(--green-medium);
            font-weight: bold;
        }

        .output-command {
            color: var(--text-secondary);
        }

        .output-result {
            color: var(--text-primary);
        }

        .output-error {
            color: #ef4444;
            font-weight: bold;
        }

        .output-success {
            color: var(--green-medium);
        }

        .reference-section {
            margin-bottom: 25px;
        }

        .reference-section h3 {
            color: var(--green-medium);
            margin-bottom: 10px;
            font-size: 1.2em;
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 5px;
        }

        .reference-grid {
            display: grid;
            grid-template-columns: 1fr 2fr;
            gap: 10px;
            margin-top: 10px;
        }

        .ref-item {
            display: contents;
        }

        .ref-code {
            background: var(--bg-primary);
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            color: var(--green-medium);
            font-weight: bold;
        }

        .ref-desc {
            background: var(--bg-primary);
            padding: 8px 12px;
            border-radius: 4px;
            border: 1px solid var(--border-color);
            color: var(--text-primary);
        }

        .challenge-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .challenge-card:hover {
            border-color: var(--green-medium);
            box-shadow: 0 0 20px rgba(34, 197, 94, 0.3);
        }

        .challenge-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .challenge-title {
            color: var(--green-medium);
            font-size: 1.2em;
            font-weight: bold;
        }

        .challenge-difficulty {
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
        }

        .difficulty-easy {
            background: #166534;
            color: #86efac;
        }

        .difficulty-medium {
            background: #854d0e;
            color: #fde047;
        }

        .difficulty-hard {
            background: #7f1d1d;
            color: #fca5a5;
        }

        .challenge-desc {
            color: var(--text-primary);
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .challenge-hints {
            background: var(--bg-primary);
            padding: 10px;
            border-radius: 4px;
            border-left: 4px solid var(--green-medium);
            margin-top: 10px;
        }

        .challenge-hints summary {
            color: var(--green-medium);
            cursor: pointer;
            font-weight: bold;
            user-select: none;
        }

        .challenge-hints p {
            margin-top: 8px;
            color: var(--text-primary);
            font-size: 0.95em;
        }

        .load-challenge-btn {
            padding: 8px 16px;
            background: var(--green-dark);
            color: var(--green-light);
            border: 2px solid var(--green-medium);
            border-radius: 6px;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .load-challenge-btn:hover {
            background: var(--green-medium);
            color: var(--green-darkest);
        }

        .scrollbar-custom::-webkit-scrollbar {
            width: 10px;
        }

        .scrollbar-custom::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 5px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb {
            background: var(--green-dark);
            border-radius: 5px;
        }

        .scrollbar-custom::-webkit-scrollbar-thumb:hover {
            background: var(--green-medium);
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        footer {
            text-align: center;
            margin-top: 30px;
            padding: 20px;
            color: var(--border-color);
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>$ Bash Scripting Playground</h1>
            <p class="tagline">Learn, Practice, and Master Shell Scripting | House of Script</p>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('editor')">Editor</button>
            <button class="tab-btn" onclick="switchTab('reference')">Syntax Reference</button>
            <button class="tab-btn" onclick="switchTab('challenges')">Challenges</button>
        </div>

        <div id="editorTab" class="tab-content active">
            <div class="main-content">
                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title">Script Editor</span>
                    </div>

                    <div class="editor-container">
                        <div class="editor-wrapper">
                            <div class="line-numbers" id="lineNumbers">1</div>
                            <textarea id="scriptEditor" spellcheck="false">#!/bin/bash
# Welcome to Bash Scripting Playground!
# Write your bash script here or load an example

echo "Hello, Bash!"</textarea>
                        </div>
                    </div>

                    <div class="controls">
                        <button class="btn" onclick="executeScript()">Run Script</button>
                        <button class="btn btn-clear" onclick="clearEditor()">Clear</button>
                    </div>

                    <div style="margin-top: 20px;">
                        <div class="panel-header">
                            <span class="panel-title">Pre-built Examples</span>
                        </div>
                        <div class="examples-grid">
                            <button class="example-btn" onclick="loadExample('hello')">Hello World</button>
                            <button class="example-btn" onclick="loadExample('variables')">Variables & Math</button>
                            <button class="example-btn" onclick="loadExample('conditional')">If/Else</button>
                            <button class="example-btn" onclick="loadExample('forloop')">For Loop</button>
                            <button class="example-btn" onclick="loadExample('whileloop')">While Loop</button>
                            <button class="example-btn" onclick="loadExample('case')">Case Statement</button>
                            <button class="example-btn" onclick="loadExample('functions')">Functions</button>
                            <button class="example-btn" onclick="loadExample('substitution')">Command Sub</button>
                            <button class="example-btn" onclick="loadExample('input')">User Input</button>
                        </div>
                    </div>
                </div>

                <div class="panel">
                    <div class="panel-header">
                        <span class="panel-title">Output</span>
                    </div>
                    <div id="output" class="scrollbar-custom"></div>
                </div>
            </div>
        </div>

        <div id="referenceTab" class="tab-content">
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Bash Syntax Quick Reference</span>
                </div>

                <div class="reference-section">
                    <h3>Numeric Comparison Operators</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">-eq</div>
                            <div class="ref-desc">Equal to (e.g., [ $a -eq $b ])</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-ne</div>
                            <div class="ref-desc">Not equal to</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-lt</div>
                            <div class="ref-desc">Less than</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-gt</div>
                            <div class="ref-desc">Greater than</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-le</div>
                            <div class="ref-desc">Less than or equal to</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-ge</div>
                            <div class="ref-desc">Greater than or equal to</div>
                        </div>
                    </div>
                </div>

                <div class="reference-section">
                    <h3>String Comparison Operators</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">=</div>
                            <div class="ref-desc">String equality (e.g., [ "$a" = "$b" ])</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">!=</div>
                            <div class="ref-desc">String inequality</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-z</div>
                            <div class="ref-desc">String is empty (zero length)</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-n</div>
                            <div class="ref-desc">String is not empty (non-zero length)</div>
                        </div>
                    </div>
                </div>

                <div class="reference-section">
                    <h3>File Test Operators</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">-f</div>
                            <div class="ref-desc">File exists and is a regular file</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-d</div>
                            <div class="ref-desc">Directory exists</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-e</div>
                            <div class="ref-desc">File or directory exists</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-r</div>
                            <div class="ref-desc">File is readable</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-w</div>
                            <div class="ref-desc">File is writable</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-x</div>
                            <div class="ref-desc">File is executable</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-s</div>
                            <div class="ref-desc">File exists and is not empty</div>
                        </div>
                    </div>
                </div>

                <div class="reference-section">
                    <h3>Logical Operators</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">&&</div>
                            <div class="ref-desc">Logical AND (command1 && command2)</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">||</div>
                            <div class="ref-desc">Logical OR (command1 || command2)</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">!</div>
                            <div class="ref-desc">Logical NOT (! command)</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-a</div>
                            <div class="ref-desc">AND within test [ cond1 -a cond2 ]</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">-o</div>
                            <div class="ref-desc">OR within test [ cond1 -o cond2 ]</div>
                        </div>
                    </div>
                </div>

                <div class="reference-section">
                    <h3>Arithmetic Operations</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">$((expr))</div>
                            <div class="ref-desc">Arithmetic expansion: result=$((5 + 3))</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">let</div>
                            <div class="ref-desc">Arithmetic evaluation: let "a = 5 + 3"</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">expr</div>
                            <div class="ref-desc">External calculator: result=$(expr 5 + 3)</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">+, -, *, /, %</div>
                            <div class="ref-desc">Basic arithmetic operators</div>
                        </div>
                    </div>
                </div>

                <div class="reference-section">
                    <h3>Common Bash Constructs</h3>
                    <div class="reference-grid">
                        <div class="ref-item">
                            <div class="ref-code">$variable</div>
                            <div class="ref-desc">Variable expansion</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">$(command)</div>
                            <div class="ref-desc">Command substitution</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">${var}</div>
                            <div class="ref-desc">Variable expansion with braces</div>
                        </div>
                        <div class="ref-item">
                            <div class="ref-code">"$var"</div>
                            <div class="ref-desc">Quoted variable (preserves spaces)</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="challengesTab" class="tab-content">
            <div class="panel">
                <div class="panel-header">
                    <span class="panel-title">Progressive Challenges</span>
                </div>

                <div class="challenge-card">
                    <div class="challenge-header">
                        <div class="challenge-title">Challenge 1: Number Printer</div>
                        <span class="challenge-difficulty difficulty-easy">Easy</span>
                    </div>
                    <div class="challenge-desc">
                        Write a bash script that prints numbers from 1 to 10, each on a new line.
                        <br><br>
                        <strong>Requirements:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Use a for loop or while loop</li>
                            <li>Print each number on a separate line</li>
                            <li>Output should be: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10</li>
                        </ul>
                    </div>
                    <details class="challenge-hints">
                        <summary>Hints</summary>
                        <p>- Use a for loop: for i in {1..10}<br>
                           - Or a while loop with a counter variable<br>
                           - Use echo to print each number</p>
                    </details>
                    <button class="load-challenge-btn" onclick="loadChallenge(1)">Load Challenge Template</button>
                </div>

                <div class="challenge-card">
                    <div class="challenge-header">
                        <div class="challenge-title">Challenge 2: File Existence Checker</div>
                        <span class="challenge-difficulty difficulty-medium">Medium</span>
                    </div>
                    <div class="challenge-desc">
                        Write a script that checks if a file exists and displays appropriate messages.
                        <br><br>
                        <strong>Requirements:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Define a variable with a filename (e.g., "config.txt")</li>
                            <li>Use an if statement with the -f test operator</li>
                            <li>Print "File exists!" if it exists</li>
                            <li>Print "File does not exist!" if it doesn't</li>
                        </ul>
                    </div>
                    <details class="challenge-hints">
                        <summary>Hints</summary>
                        <p>- Use: if [ -f "$filename" ]<br>
                           - Remember to use quotes around variables<br>
                           - The -f operator tests for regular files<br>
                           - For simulation, assume the file doesn't exist</p>
                    </details>
                    <button class="load-challenge-btn" onclick="loadChallenge(2)">Load Challenge Template</button>
                </div>

                <div class="challenge-card">
                    <div class="challenge-header">
                        <div class="challenge-title">Challenge 3: Factorial Calculator</div>
                        <span class="challenge-difficulty difficulty-hard">Hard</span>
                    </div>
                    <div class="challenge-desc">
                        Write a script that calculates the factorial of a given number using a function.
                        <br><br>
                        <strong>Requirements:</strong>
                        <ul style="margin-left: 20px; margin-top: 5px;">
                            <li>Create a function called "factorial" that takes one parameter</li>
                            <li>Use a loop to calculate the factorial</li>
                            <li>Return/echo the result</li>
                            <li>Test with factorial of 5 (should be 120)</li>
                        </ul>
                    </div>
                    <details class="challenge-hints">
                        <summary>Hints</summary>
                        <p>- Define function: factorial() { ... }<br>
                           - Access parameter with $1<br>
                           - Initialize result=1<br>
                           - Use a while loop: while [ $i -le $n ]<br>
                           - Calculate: result=$((result * i))<br>
                           - Echo the result at the end</p>
                    </details>
                    <button class="load-challenge-btn" onclick="loadChallenge(3)">Load Challenge Template</button>
                </div>

            </div>
        </div>

        <footer>
            <p>House of Script - Bash Scripting Playground | Interactive Learning Environment</p>
            <p style="margin-top: 5px;">Master the command line, one script at a time.</p>
        </footer>
    </div>

    <script>
        // Editor line numbers
        const editor = document.getElementById('scriptEditor');
        const lineNumbers = document.getElementById('lineNumbers');

        function updateLineNumbers() {
            const lines = editor.value.split('\n').length;
            const numbers = [];
            for (let i = 1; i <= lines; i++) {
                numbers.push(i);
            }
            lineNumbers.textContent = numbers.join('\n');
        }

        editor.addEventListener('input', updateLineNumbers);
        editor.addEventListener('scroll', () => {
            lineNumbers.scrollTop = editor.scrollTop;
        });

        updateLineNumbers();

        // Tab switching
        function switchTab(tabName) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');

            tabs.forEach(tab => tab.classList.remove('active'));
            buttons.forEach(btn => btn.classList.remove('active'));

            document.getElementById(tabName + 'Tab').classList.add('active');
            event.target.classList.add('active');
        }

        // Example scripts
        const examples = {
            hello: `#!/bin/bash
# Hello World - The classic first program

echo "Hello, World!"
echo "Welcome to Bash Scripting!"
echo "Today is $(date +%A)"`,

            variables: `#!/bin/bash
# Variables and Arithmetic Operations

# String variables
name="Alice"
greeting="Hello"

echo "$greeting, $name!"

# Numeric variables and arithmetic
x=10
y=5

# Addition
sum=$((x + y))
echo "$x + $y = $sum"

# Subtraction
diff=$((x - y))
echo "$x - $y = $diff"

# Multiplication
product=$((x * y))
echo "$x * $y = $product"

# Division
quotient=$((x / y))
echo "$x / $y = $quotient"

# Modulo
remainder=$((x % 3))
echo "$x % 3 = $remainder"`,

            conditional: `#!/bin/bash
# If/Else Conditional Statements

age=25

echo "Checking age: $age"

if [ $age -lt 18 ]; then
    echo "You are a minor."
elif [ $age -ge 18 ] && [ $age -lt 65 ]; then
    echo "You are an adult."
else
    echo "You are a senior."
fi

# String comparison
username="admin"

if [ "$username" = "admin" ]; then
    echo "Welcome, administrator!"
else
    echo "Welcome, user!"
fi`,

            forloop: `#!/bin/bash
# For Loop - Iterating through sequences

echo "Counting from 1 to 5:"
for i in 1 2 3 4 5
do
    echo "Number: $i"
done

echo ""
echo "Files in directory (simulated):"
for file in config.txt data.log script.sh
do
    echo "Processing: $file"
done

echo ""
echo "Using range notation:"
for num in {1..5}
do
    square=$((num * num))
    echo "$num squared is $square"
done`,

            whileloop: `#!/bin/bash
# While Loop - Counter example

counter=1
max=5

echo "While loop counting to $max:"

while [ $counter -le $max ]
do
    echo "Iteration $counter"
    counter=$((counter + 1))
done

echo "Loop finished!"

# Another example - countdown
echo ""
echo "Countdown:"
countdown=5
while [ $countdown -gt 0 ]
do
    echo "$countdown..."
    countdown=$((countdown - 1))
done
echo "Blastoff!"`,

            case: `#!/bin/bash
# Case Statement - Menu selection

choice="2"

echo "Menu Selection: $choice"
echo ""

case $choice in
    1)
        echo "You selected Option 1: View Files"
        echo "Listing files..."
        ;;
    2)
        echo "You selected Option 2: Process Data"
        echo "Processing data..."
        ;;
    3)
        echo "You selected Option 3: Generate Report"
        echo "Generating report..."
        ;;
    *)
        echo "Invalid selection"
        ;;
esac

# Another example - day of week
day="Monday"
echo ""
echo "Day: $day"

case $day in
    Monday|Tuesday|Wednesday|Thursday|Friday)
        echo "It's a weekday. Time to work!"
        ;;
    Saturday|Sunday)
        echo "It's the weekend. Time to relax!"
        ;;
    *)
        echo "Invalid day"
        ;;
esac`,

            functions: `#!/bin/bash
# Functions - Reusable code blocks

# Simple function
greet() {
    echo "Hello from the greet function!"
}

# Function with parameters
greet_person() {
    name=$1
    echo "Hello, $name! Nice to meet you."
}

# Function with return value (via echo)
add_numbers() {
    local a=$1
    local b=$2
    local sum=$((a + b))
    echo $sum
}

# Function with multiple operations
calculate_area() {
    width=$1
    height=$2
    area=$((width * height))
    echo "Rectangle dimensions: ${width}x${height}"
    echo "Area: $area square units"
}

# Calling functions
echo "=== Function Examples ==="
echo ""

greet
echo ""

greet_person "Alice"
greet_person "Bob"
echo ""

result=$(add_numbers 15 27)
echo "15 + 27 = $result"
echo ""

calculate_area 5 8`,

            substitution: `#!/bin/bash
# Command Substitution - Using command output

echo "=== Command Substitution Examples ==="
echo ""

# Simulated date command
current_date="2025-12-11"
echo "Current date: $current_date"

# Simulated uptime
uptime_result="up 5 days, 3 hours"
echo "System uptime: $uptime_result"

# Using in variables
files_count=42
echo "Number of files: $files_count"

# Mathematical expression
value=10
doubled=$((value * 2))
echo "Original value: $value"
echo "Doubled value: $doubled"

# Simulated user info
current_user="bash_user"
echo "Current user: $current_user"

# Using in strings
backup_file="backup_$current_date.tar.gz"
echo "Backup filename: $backup_file"`,

            input: `#!/bin/bash
# Reading User Input (simulated)

echo "=== User Input Example ==="
echo ""

# Simulated input - in real bash, this would wait for user input
# read -p "Enter your name: " name
name="Alice"
echo "Enter your name: $name"
echo "Hello, $name!"

echo ""

# Multiple inputs
# read -p "Enter your age: " age
age="25"
echo "Enter your age: $age"

# read -p "Enter your city: " city
city="Boston"
echo "Enter your city: $city"

echo ""
echo "Profile Summary:"
echo "----------------"
echo "Name: $name"
echo "Age: $age"
echo "City: $city"

# Conditional based on input
if [ $age -ge 18 ]; then
    echo "Status: Adult"
else
    echo "Status: Minor"
fi`
        };

        function loadExample(exampleName) {
            editor.value = examples[exampleName];
            updateLineNumbers();
            clearOutput();
            addOutput('Example loaded: ' + exampleName, 'output-success');
        }

        function clearEditor() {
            editor.value = '#!/bin/bash\n# Write your script here\n\n';
            updateLineNumbers();
            clearOutput();
        }

        // Output functions
        function clearOutput() {
            document.getElementById('output').innerHTML = '';
        }

        function addOutput(text, className = 'output-result') {
            const output = document.getElementById('output');
            const line = document.createElement('div');
            line.className = 'output-line ' + className;
            line.textContent = text;
            output.appendChild(line);
            output.scrollTop = output.scrollHeight;
        }

        // Bash script execution engine
        class BashInterpreter {
            constructor() {
                this.variables = {};
                this.functions = {};
                this.output = [];
            }

            execute(script) {
                this.output = [];
                this.variables = {};
                this.functions = {};

                try {
                    const lines = script.split('\n');
                    let i = 0;

                    while (i < lines.length) {
                        const result = this.executeLine(lines, i);
                        i = result.nextLine;
                    }

                    return this.output;
                } catch (error) {
                    this.output.push({ type: 'error', text: 'Error: ' + error.message });
                    return this.output;
                }
            }

            executeLine(lines, startIndex) {
                let line = lines[startIndex].trim();

                // Skip empty lines and comments
                if (!line || line.startsWith('#')) {
                    return { nextLine: startIndex + 1 };
                }

                // Variable assignment
                if (/^[a-zA-Z_][a-zA-Z0-9_]*=/.test(line)) {
                    this.handleVariableAssignment(line);
                    return { nextLine: startIndex + 1 };
                }

                // Echo command
                if (line.startsWith('echo ')) {
                    this.handleEcho(line);
                    return { nextLine: startIndex + 1 };
                }

                // Printf command
                if (line.startsWith('printf ')) {
                    this.handlePrintf(line);
                    return { nextLine: startIndex + 1 };
                }

                // If statement
                if (line.startsWith('if ')) {
                    return this.handleIf(lines, startIndex);
                }

                // For loop
                if (line.startsWith('for ')) {
                    return this.handleFor(lines, startIndex);
                }

                // While loop
                if (line.startsWith('while ')) {
                    return this.handleWhile(lines, startIndex);
                }

                // Case statement
                if (line.startsWith('case ')) {
                    return this.handleCase(lines, startIndex);
                }

                // Function definition
                if (line.match(/^[a-zA-Z_][a-zA-Z0-9_]*\s*\(\s*\)\s*\{?$/)) {
                    return this.handleFunctionDefinition(lines, startIndex);
                }

                // Function call
                if (this.functions[line.split(/\s+/)[0]]) {
                    this.handleFunctionCall(line);
                    return { nextLine: startIndex + 1 };
                }

                // Let command
                if (line.startsWith('let ')) {
                    this.handleLet(line);
                    return { nextLine: startIndex + 1 };
                }

                // Expr command
                if (line.startsWith('expr ')) {
                    this.handleExpr(line);
                    return { nextLine: startIndex + 1 };
                }

                // Read command (simulated)
                if (line.startsWith('read ')) {
                    this.handleRead(line);
                    return { nextLine: startIndex + 1 };
                }

                return { nextLine: startIndex + 1 };
            }

            handleVariableAssignment(line) {
                const match = line.match(/^([a-zA-Z_][a-zA-Z0-9_]*)=(.*)$/);
                if (match) {
                    const varName = match[1];
                    let value = match[2];

                    // Handle quoted strings
                    if (value.startsWith('"') && value.endsWith('"')) {
                        value = value.slice(1, -1);
                    } else if (value.startsWith("'") && value.endsWith("'")) {
                        value = value.slice(1, -1);
                    }

                    // Handle arithmetic expansion
                    value = this.expandArithmetic(value);

                    // Handle variable expansion
                    value = this.expandVariables(value);

                    // Handle command substitution
                    value = this.expandCommandSubstitution(value);

                    this.variables[varName] = value;
                }
            }

            handleEcho(line) {
                let text = line.substring(5).trim();

                // Remove quotes if present
                if ((text.startsWith('"') && text.endsWith('"')) ||
                    (text.startsWith("'") && text.endsWith("'"))) {
                    text = text.slice(1, -1);
                }

                // Expand variables
                text = this.expandVariables(text);

                // Expand arithmetic
                text = this.expandArithmetic(text);

                // Expand command substitution
                text = this.expandCommandSubstitution(text);

                this.output.push({ type: 'result', text: text });
            }

            handlePrintf(line) {
                // Simplified printf handling
                let text = line.substring(7).trim();
                if (text.startsWith('"') && text.includes('"')) {
                    const endQuote = text.indexOf('"', 1);
                    text = text.substring(1, endQuote);
                }
                text = this.expandVariables(text);
                this.output.push({ type: 'result', text: text });
            }

            handleIf(lines, startIndex) {
                const condition = lines[startIndex].trim().match(/if\s+(.+?)(?:;?\s*then)?$/)[1];
                const conditionResult = this.evaluateCondition(condition);

                let i = startIndex + 1;
                let foundThen = false;

                // Skip to 'then' if not on same line
                while (i < lines.length && !foundThen) {
                    if (lines[i].trim() === 'then' || lines[i].trim().startsWith('then')) {
                        foundThen = true;
                        i++;
                        break;
                    }
                    i++;
                }

                let thenBlock = [];
                let elseBlock = [];
                let currentBlock = thenBlock;
                let depth = 0;

                while (i < lines.length) {
                    const line = lines[i].trim();

                    if (line.startsWith('if ')) depth++;
                    if (line === 'fi') {
                        if (depth === 0) break;
                        depth--;
                    }
                    if (depth === 0 && (line === 'else' || line.startsWith('elif '))) {
                        currentBlock = elseBlock;
                        if (line.startsWith('elif ')) {
                            // Simplified elif handling - treat as else with nested if
                            elseBlock.push(lines[i]);
                        }
                        i++;
                        continue;
                    }

                    currentBlock.push(lines[i]);
                    i++;
                }

                // Execute appropriate block
                const blockToExecute = conditionResult ? thenBlock : elseBlock;
                let blockIndex = 0;
                while (blockIndex < blockToExecute.length) {
                    const result = this.executeLine(blockToExecute, blockIndex);
                    blockIndex = result.nextLine;
                }

                return { nextLine: i + 1 };
            }

            handleFor(lines, startIndex) {
                const forMatch = lines[startIndex].trim().match(/for\s+(\w+)\s+in\s+(.+?)(?:;?\s*do)?$/);
                if (!forMatch) return { nextLine: startIndex + 1 };

                const varName = forMatch[1];
                let items = forMatch[2].trim();

                // Handle range notation {1..10}
                const rangeMatch = items.match(/\{(\d+)\.\.(\d+)\}/);
                if (rangeMatch) {
                    const start = parseInt(rangeMatch[1]);
                    const end = parseInt(rangeMatch[2]);
                    items = [];
                    for (let i = start; i <= end; i++) {
                        items.push(i.toString());
                    }
                } else {
                    // Split by spaces
                    items = items.split(/\s+/);
                }

                // Find loop body
                let i = startIndex + 1;
                while (i < lines.length && lines[i].trim() !== 'do' && !lines[i].trim().startsWith('do')) {
                    i++;
                }
                i++; // Skip 'do'

                let loopBody = [];
                let depth = 0;
                while (i < lines.length) {
                    const line = lines[i].trim();
                    if (line.startsWith('for ') || line.startsWith('while ')) depth++;
                    if (line === 'done') {
                        if (depth === 0) break;
                        depth--;
                    }
                    loopBody.push(lines[i]);
                    i++;
                }

                // Execute loop
                for (const item of items) {
                    this.variables[varName] = item;
                    let bodyIndex = 0;
                    while (bodyIndex < loopBody.length) {
                        const result = this.executeLine(loopBody, bodyIndex);
                        bodyIndex = result.nextLine;
                    }
                }

                return { nextLine: i + 1 };
            }

            handleWhile(lines, startIndex) {
                const condition = lines[startIndex].trim().match(/while\s+(.+?)(?:;?\s*do)?$/)[1];

                // Find loop body
                let i = startIndex + 1;
                while (i < lines.length && lines[i].trim() !== 'do') {
                    i++;
                }
                i++; // Skip 'do'

                let loopBody = [];
                let depth = 0;
                while (i < lines.length) {
                    const line = lines[i].trim();
                    if (line.startsWith('while ') || line.startsWith('for ')) depth++;
                    if (line === 'done') {
                        if (depth === 0) break;
                        depth--;
                    }
                    loopBody.push(lines[i]);
                    i++;
                }

                // Execute loop (with safety limit)
                let iterations = 0;
                const maxIterations = 1000;

                while (this.evaluateCondition(condition) && iterations < maxIterations) {
                    let bodyIndex = 0;
                    while (bodyIndex < loopBody.length) {
                        const result = this.executeLine(loopBody, bodyIndex);
                        bodyIndex = result.nextLine;
                    }
                    iterations++;
                }

                if (iterations >= maxIterations) {
                    throw new Error('Loop exceeded maximum iterations (1000)');
                }

                return { nextLine: i + 1 };
            }

            handleCase(lines, startIndex) {
                const caseMatch = lines[startIndex].trim().match(/case\s+(.+?)\s+in/);
                if (!caseMatch) return { nextLine: startIndex + 1 };

                let caseValue = caseMatch[1];
                caseValue = this.expandVariables(caseValue);
                // Remove quotes
                caseValue = caseValue.replace(/^["']|["']$/g, '');

                let i = startIndex + 1;
                let matched = false;

                while (i < lines.length) {
                    const line = lines[i].trim();

                    if (line === 'esac') break;

                    // Check for pattern
                    if (line.includes(')')) {
                        const pattern = line.split(')')[0].trim();
                        const patterns = pattern.split('|');

                        let isMatch = false;
                        for (const p of patterns) {
                            if (p.trim() === caseValue || p.trim() === '*') {
                                isMatch = true;
                                break;
                            }
                        }

                        if (isMatch && !matched) {
                            matched = true;
                            i++;
                            // Execute until ;;
                            while (i < lines.length) {
                                const bodyLine = lines[i].trim();
                                if (bodyLine === ';;') break;
                                this.executeLine(lines, i);
                                i++;
                            }
                        }
                    }

                    i++;
                }

                return { nextLine: i + 1 };
            }

            handleFunctionDefinition(lines, startIndex) {
                const funcName = lines[startIndex].trim().match(/^([a-zA-Z_][a-zA-Z0-9_]*)/)[1];

                let i = startIndex + 1;
                // Check if { is on same line or next line
                if (!lines[startIndex].includes('{')) {
                    while (i < lines.length && lines[i].trim() !== '{') {
                        i++;
                    }
                    i++;
                }

                let funcBody = [];
                let depth = 1;

                while (i < lines.length && depth > 0) {
                    const line = lines[i].trim();
                    if (line.includes('{')) depth++;
                    if (line === '}') {
                        depth--;
                        if (depth === 0) break;
                    }
                    funcBody.push(lines[i]);
                    i++;
                }

                this.functions[funcName] = funcBody;
                return { nextLine: i + 1 };
            }

            handleFunctionCall(line) {
                const parts = line.trim().split(/\s+/);
                const funcName = parts[0];
                const args = parts.slice(1);

                if (!this.functions[funcName]) return;

                // Set positional parameters
                const oldVars = { ...this.variables };
                for (let i = 0; i < args.length; i++) {
                    this.variables[(i + 1).toString()] = this.expandVariables(args[i]);
                }

                // Execute function body
                const funcBody = this.functions[funcName];
                let i = 0;
                while (i < funcBody.length) {
                    const result = this.executeLine(funcBody, i);
                    i = result.nextLine;
                }

                // Restore variables (simplified - doesn't handle local)
                // In real bash, local variables would be scoped
            }

            handleLet(line) {
                const expr = line.substring(4).trim().replace(/^["']|["']$/g, '');
                const match = expr.match(/([a-zA-Z_][a-zA-Z0-9_]*)\s*=\s*(.+)/);
                if (match) {
                    const varName = match[1];
                    const value = this.evaluateArithmetic(match[2]);
                    this.variables[varName] = value.toString();
                }
            }

            handleExpr(line) {
                const expr = line.substring(5).trim();
                const result = this.evaluateArithmetic(expr);
                this.output.push({ type: 'result', text: result.toString() });
            }

            handleRead(line) {
                // Simulated read - would normally wait for user input
                const match = line.match(/read\s+(?:-p\s+["']([^"']+)["']\s+)?(\w+)/);
                if (match) {
                    const prompt = match[1];
                    const varName = match[2];

                    if (prompt) {
                        this.output.push({ type: 'result', text: prompt + ' (simulated input)' });
                    }

                    // Simulate input
                    this.variables[varName] = 'simulated_input';
                }
            }

            evaluateCondition(condition) {
                condition = condition.trim();

                // Handle [ ] test brackets
                if (condition.startsWith('[') && condition.endsWith(']')) {
                    condition = condition.slice(1, -1).trim();
                }

                // Expand variables first
                condition = this.expandVariables(condition);

                // Numeric comparisons
                const numericOps = ['-eq', '-ne', '-lt', '-gt', '-le', '-ge'];
                for (const op of numericOps) {
                    if (condition.includes(op)) {
                        const parts = condition.split(op).map(s => s.trim());
                        const left = this.evaluateArithmetic(parts[0]);
                        const right = this.evaluateArithmetic(parts[1]);

                        switch (op) {
                            case '-eq': return left === right;
                            case '-ne': return left !== right;
                            case '-lt': return left < right;
                            case '-gt': return left > right;
                            case '-le': return left <= right;
                            case '-ge': return left >= right;
                        }
                    }
                }

                // String comparisons
                if (condition.includes(' = ')) {
                    const parts = condition.split(' = ').map(s => s.trim().replace(/^["']|["']$/g, ''));
                    return parts[0] === parts[1];
                }

                if (condition.includes(' != ')) {
                    const parts = condition.split(' != ').map(s => s.trim().replace(/^["']|["']$/g, ''));
                    return parts[0] !== parts[1];
                }

                // String tests
                if (condition.startsWith('-z ')) {
                    const str = condition.substring(3).trim().replace(/^["']|["']$/g, '');
                    return str.length === 0;
                }

                if (condition.startsWith('-n ')) {
                    const str = condition.substring(3).trim().replace(/^["']|["']$/g, '');
                    return str.length > 0;
                }

                // File tests (all return false in simulation)
                if (condition.match(/^-[fderswx]\s+/)) {
                    return false;
                }

                // Logical operators
                if (condition.includes(' && ')) {
                    const parts = condition.split(' && ');
                    return this.evaluateCondition(parts[0]) && this.evaluateCondition(parts[1]);
                }

                if (condition.includes(' || ')) {
                    const parts = condition.split(' || ');
                    return this.evaluateCondition(parts[0]) || this.evaluateCondition(parts[1]);
                }

                if (condition.includes(' -a ')) {
                    const parts = condition.split(' -a ');
                    return this.evaluateCondition(parts[0]) && this.evaluateCondition(parts[1]);
                }

                if (condition.includes(' -o ')) {
                    const parts = condition.split(' -o ');
                    return this.evaluateCondition(parts[0]) || this.evaluateCondition(parts[1]);
                }

                return false;
            }

            expandVariables(text) {
                // Expand ${var} and $var
                text = text.replace(/\$\{([a-zA-Z_][a-zA-Z0-9_]*)\}/g, (match, varName) => {
                    return this.variables[varName] || '';
                });

                text = text.replace(/\$([a-zA-Z_][a-zA-Z0-9_]*)/g, (match, varName) => {
                    return this.variables[varName] || '';
                });

                return text;
            }

            expandArithmetic(text) {
                // Handle $((expression))
                const regex = /\$\(\(([^)]+)\)\)/g;
                return text.replace(regex, (match, expr) => {
                    return this.evaluateArithmetic(expr).toString();
                });
            }

            expandCommandSubstitution(text) {
                // Handle $(command)
                const regex = /\$\(([^)]+)\)/g;
                return text.replace(regex, (match, command) => {
                    // Simulate common commands
                    command = command.trim();

                    if (command.startsWith('date')) {
                        if (command.includes('+%A')) return 'Thursday';
                        return '2025-12-11';
                    }

                    if (command === 'whoami') return 'bash_user';
                    if (command === 'pwd') return '/home/user';
                    if (command.startsWith('expr ')) {
                        const expr = command.substring(5);
                        return this.evaluateArithmetic(expr).toString();
                    }

                    return 'simulated_output';
                });
            }

            evaluateArithmetic(expr) {
                // Expand variables in expression
                expr = this.expandVariables(expr);

                // Remove spaces
                expr = expr.replace(/\s+/g, '');

                try {
                    // Simple arithmetic evaluation
                    // Security note: In production, use a proper expression parser
                    // This is simplified for educational purposes
                    const result = Function('"use strict"; return (' + expr + ')')();
                    return parseInt(result) || 0;
                } catch (e) {
                    return 0;
                }
            }
        }

        function executeScript() {
            const script = editor.value;
            clearOutput();

            addOutput('$ bash script.sh', 'output-command');
            addOutput('', 'output-result');

            const interpreter = new BashInterpreter();
            const results = interpreter.execute(script);

            if (results.length === 0) {
                addOutput('(Script executed with no output)', 'output-result');
            } else {
                for (const result of results) {
                    addOutput(result.text, result.type === 'error' ? 'output-error' : 'output-result');
                }
            }

            addOutput('', 'output-result');
            addOutput('Script execution completed.', 'output-success');
        }

        // Challenge templates
        const challengeTemplates = {
            1: `#!/bin/bash
# Challenge 1: Number Printer
# Write a script that prints numbers 1 to 10

# Your code here:

`,
            2: `#!/bin/bash
# Challenge 2: File Existence Checker
# Check if a file exists and display appropriate message

# Your code here:

`,
            3: `#!/bin/bash
# Challenge 3: Factorial Calculator
# Create a function that calculates factorial

# Your code here:

# Test with factorial of 5 (should be 120)
`
        };

        function loadChallenge(num) {
            editor.value = challengeTemplates[num];
            updateLineNumbers();
            switchTab('editor');
            clearOutput();
            addOutput('Challenge ' + num + ' template loaded. Good luck!', 'output-success');
        }

        // Initialize
        clearOutput();
        addOutput('Bash Scripting Playground initialized.', 'output-success');
        addOutput('Load an example or write your own script to get started!', 'output-result');
    </script>
</body>
</html>